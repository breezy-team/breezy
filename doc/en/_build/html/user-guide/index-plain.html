
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Breezy User Guide &#8212; Breezy 3.0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">Table of Contents (3.0.0.1)</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="breezy-user-guide">
<h1><a class="toc-backref" href="#id44">Breezy User Guide</a><a class="headerlink" href="#breezy-user-guide" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#breezy-user-guide" id="id44">Breezy User Guide</a><ul>
<li><a class="reference internal" href="#introduction" id="id45">Introduction</a><ul>
<li><a class="reference internal" href="#introducing-breezy" id="id46">Introducing Breezy</a></li>
<li><a class="reference internal" href="#core-concepts" id="id47">Core concepts</a></li>
<li><a class="reference internal" href="#workflows" id="id48">Workflows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#getting-started" id="id49">Getting started</a><ul>
<li><a class="reference internal" href="#installing-breezy" id="id50">Installing Breezy</a></li>
<li><a class="reference internal" href="#entering-commands" id="id51">Entering commands</a></li>
<li><a class="reference internal" href="#getting-help" id="id52">Getting help</a></li>
<li><a class="reference internal" href="#configuring-breezy" id="id53">Configuring Breezy</a></li>
<li><a class="reference internal" href="#using-aliases" id="id54">Using aliases</a></li>
<li><a class="reference internal" href="#using-plugins" id="id55">Using plugins</a></li>
<li><a class="reference internal" href="#breezy-zen" id="id56">Breezy Zen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#personal-version-control" id="id57">Personal version control</a><ul>
<li><a class="reference internal" href="#going-solo" id="id58">Going solo</a></li>
<li><a class="reference internal" href="#starting-a-project" id="id59">Starting a project</a></li>
<li><a class="reference internal" href="#controlling-file-registration" id="id60">Controlling file registration</a></li>
<li><a class="reference internal" href="#reviewing-changes" id="id61">Reviewing changes</a></li>
<li><a class="reference internal" href="#recording-changes" id="id62">Recording changes</a></li>
<li><a class="reference internal" href="#browsing-history" id="id63">Browsing history</a></li>
<li><a class="reference internal" href="#releasing-a-project" id="id64">Releasing a project</a></li>
<li><a class="reference internal" href="#undoing-mistakes" id="id65">Undoing mistakes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sharing-with-peers" id="id66">Sharing with peers</a><ul>
<li><a class="reference internal" href="#working-with-another" id="id67">Working with another</a></li>
<li><a class="reference internal" href="#branching-a-project" id="id68">Branching a project</a></li>
<li><a class="reference internal" href="#id9" id="id69">Merging changes</a></li>
<li><a class="reference internal" href="#id10" id="id70">Resolving conflicts</a></li>
<li><a class="reference internal" href="#annotating-changes" id="id71">Annotating changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#team-collaboration-central-style" id="id72">Team collaboration, central style</a><ul>
<li><a class="reference internal" href="#centralized-development" id="id73">Centralized development</a></li>
<li><a class="reference internal" href="#publishing-a-branch" id="id74">Publishing a branch</a></li>
<li><a class="reference internal" href="#using-checkouts" id="id75">Using checkouts</a></li>
<li><a class="reference internal" href="#working-offline-on-a-central-branch" id="id76">Working offline on a central branch</a></li>
<li><a class="reference internal" href="#id14" id="id77">Reusing a checkout</a></li>
</ul>
</li>
<li><a class="reference internal" href="#team-collaboration-distributed-style" id="id78">Team collaboration, distributed style</a><ul>
<li><a class="reference internal" href="#distributed-development" id="id79">Distributed development</a></li>
<li><a class="reference internal" href="#organizing-branches" id="id80">Organizing branches</a></li>
<li><a class="reference internal" href="#using-gatekeepers" id="id81">Using gatekeepers</a></li>
<li><a class="reference internal" href="#sending-changes" id="id82">Sending changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#miscellaneous-topics" id="id83">Miscellaneous topics</a><ul>
<li><a class="reference internal" href="#the-journey-ahead" id="id84">The journey ahead</a></li>
<li><a class="reference internal" href="#pseudo-merging" id="id85">Pseudo merging</a></li>
<li><a class="reference internal" href="#shelving-changes" id="id86">Shelving Changes</a></li>
<li><a class="reference internal" href="#switch-store" id="id87">Switch –store</a></li>
<li><a class="reference internal" href="#filtered-views" id="id88">Filtered views</a></li>
<li><a class="reference internal" href="#using-stacked-branches" id="id89">Using stacked branches</a></li>
<li><a class="reference internal" href="#running-a-smart-server" id="id90">Running a smart server</a></li>
<li><a class="reference internal" href="#using-hooks" id="id91">Using hooks</a></li>
<li><a class="reference internal" href="#exporting-version-information" id="id92">Exporting version information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-brief-tour-of-some-popular-plugins" id="id93">A brief tour of some popular plugins</a><ul>
<li><a class="reference internal" href="#brz-svn" id="id94">brz-svn</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integrating-breezy-into-your-environment" id="id95">Integrating Breezy into your environment</a><ul>
<li><a class="reference internal" href="#web-browsing" id="id96">Web browsing</a></li>
<li><a class="reference internal" href="#bug-trackers" id="id97">Bug trackers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendices" id="id98">Appendices</a><ul>
<li><a class="reference internal" href="#id23" id="id99">Specifying revisions</a></li>
<li><a class="reference internal" href="#id25" id="id100">Organizing your workspace</a></li>
<li><a class="reference internal" href="#id28" id="id101">Advanced shared repository layouts</a></li>
<li><a class="reference internal" href="#configuring-email" id="id102">Configuring email</a></li>
<li><a class="reference internal" href="#serving-breezy-with-apache" id="id103">Serving Breezy with Apache</a></li>
<li><a class="reference internal" href="#id40" id="id104">Writing a plugin</a></li>
<li><a class="reference internal" href="#git-limitations" id="id105">Git Limitations</a></li>
<li><a class="reference internal" href="#licence" id="id106">Licence</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id45">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introducing-breezy">
<h3><a class="toc-backref" href="#id46">Introducing Breezy</a><a class="headerlink" href="#introducing-breezy" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-is-breezy">
<h4>What is Breezy?<a class="headerlink" href="#what-is-breezy" title="Permalink to this headline">¶</a></h4>
<p>Breezy is a tool for helping people collaborate. It tracks the changes
that you and other people make to a group of files - such as software
source code - to give you snapshots of each stage of their evolution.
Using that information, Breezy can effortlessly merge your work with
other people’s.</p>
<p>Tools like Breezy are called version control systems (VCS) and have
long been popular with software developers. Breezy’s ease of use,
flexibility and simple setup make it ideal not only for software
developers but also for other groups who work together on files and
documents, such as technical writers, web designers and translators.</p>
<p>This guide takes you through installing Breezy and how to use it,
whether on your own or with a team of other people. If you’re already
familiar with distributed version control and want to dive straight in,
you may wish to skim this section and jump straight to
<a class="reference internal" href="#learning-more">Learning more</a>.</p>
</div>
<div class="section" id="a-brief-history-of-version-control-systems">
<h4>A brief history of version control systems<a class="headerlink" href="#a-brief-history-of-version-control-systems" title="Permalink to this headline">¶</a></h4>
<p>Version control tools have been evolving for several decades now. In
simple terms, there have been 4 generations of tools:</p>
<blockquote>
<div><ol class="arabic simple">
<li>file versioning tools, e.g. SCCS, RCS</li>
<li>tree versioning tools - central style, e.g. CVS</li>
<li>tree versioning tools - central style, take two, e.g. Subversion</li>
<li>tree versioning tools - distributed style, e.g. Breezy.</li>
</ol>
</div></blockquote>
<p>The design and implementation of Breezy builds on the lessons learned
from all the previous generations of tools. In particular, Breezy
cleanly supports both the central and the distributed version
control models so you can change models as it makes sense, without
needing to change tools.</p>
</div>
<div class="section" id="central-vs-distributed-vcs">
<h4>Central vs distributed VCS<a class="headerlink" href="#central-vs-distributed-vcs" title="Permalink to this headline">¶</a></h4>
<p>Many traditional VCS tools require a central server which provides the
change history or <em>repository</em> for a tree of files. To work on the files,
users need to connect to the server and <em>checkout</em> the files. This gives
them a directory or <em>working tree</em> in which a person can make changes.
To record or <em>commit</em> these changes, the user needs access to the central
server and they need to ensure they have merged their work with the latest
version stored before trying to commit. This approach is known as the
centralized model.</p>
<p>The centralized model has proven useful over time but it can have some notable
drawbacks. Firstly, a centralized VCS requires that one is able to connect
to the server whenever one wants to do version control work. Secondly, the
centralized model tightly links the act of <strong>snapshotting</strong> changes with the act
of <strong>publishing</strong> those changes. This can be good in some circumstances but
it has a negative influence on quality in others.</p>
<p>Distributed VCS tools let users and teams have multiple repositories
rather than just a single central one. In Breezy’s case, the history is
normally kept in the same place as the code that is being version controlled.
This allows the user to commit their changes whenever it makes sense, even
when offline. Network access is only required when publishing changes or
when accessing changes in another location.</p>
<p>In fact, using distributed VCS tools wisely can have advantages well
beyond the obvious one of disconnected operations for developers.
Other advantages include:</p>
<blockquote>
<div><ul class="simple">
<li>easier for developers to create experimental branches</li>
<li>easier ad-hoc collaboration with peers</li>
<li>less time required on mechanical tasks - more time for creativity</li>
<li>increased release management flexibility through the use of
“feature-wide” commits</li>
<li>trunk quality and stability can be kept higher, making everyone’s
job less stressful</li>
<li>in open communities:<ul>
<li>easier for non-core developers to create and maintain changes</li>
<li>easier for core developers to work with non-core developers and
move them into the core</li>
</ul>
</li>
<li>in companies, easier to work with distributed and outsourced teams.</li>
</ul>
</div></blockquote>
<p>For a detailed look at the advantages of distributed VCS tools over
centralized VCS tools, see <a class="reference external" href="http://wiki.bazaar.canonical.com/BzrWhy">http://wiki.bazaar.canonical.com/BzrWhy</a>.</p>
</div>
<div class="section" id="key-features-of-breezy">
<h4>Key features of Breezy<a class="headerlink" href="#key-features-of-breezy" title="Permalink to this headline">¶</a></h4>
<p>While Breezy is not the only distributed VCS tool around, it does have some
notable features that make it an excellent choice for many teams and
communities. A summary of these and comparisons with other VCS tools
can be found on the Bazaar Wiki, <a class="reference external" href="http://wiki.bazaar.canonical.com">http://wiki.bazaar.canonical.com</a>.</p>
<p>Of the many features, one in particular is worth highlighting:
Breezy is completely free software written in Python. As a result,
it is easy to contribute improvements. If you wish to get involved,
please see <a class="reference external" href="https://www.breezy-vcs.org/pages/support.html">https://www.breezy-vcs.org/pages/support.html</a>.</p>
</div>
<div class="section" id="learning-more">
<h4>Learning more<a class="headerlink" href="#learning-more" title="Permalink to this headline">¶</a></h4>
<p>This manual provides an easy to read introduction to Breezy and how to use
it effectively.  It is recommended that all users read at least the rest of
this chapter as it:</p>
<blockquote>
<div><ul class="simple">
<li>explains the core concepts users need to know</li>
<li>introduces some popular ways of using Breezy to collaborate.</li>
</ul>
</div></blockquote>
<p>Chapters 2-6 provide a closer look at how to use Breezy to complete
various tasks. It is recommended that most users read these in first-to-last
order shortly after starting to use Breezy. Chapter 7 and beyond provide
additional information that helps you make the most of Breezy once the core
functionality is understood. This material can be read when required and in
any order.</p>
<p>If you are already familiar with other version control tools,
you may wish to get started quickly by reading the following documents:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="../mini-tutorial/index.html">Breezy in five minutes</a> - a mini-tutorial</li>
<li><a class="reference external" href="../quick-reference/index.html">Breezy Quick Start Card</a> - a one page summary of commonly used commands.</li>
</ul>
</div></blockquote>
<p>In addition, the online help and <a class="reference external" href="../user-reference/index.html">Breezy User Reference</a> provide all the
details on the commands and options available.</p>
<p>We hope you find this manual useful. If you have suggestions on how it
or the rest of Breezy’s documentation can be improved, please contact
us on the mailing list, <a class="reference external" href="mailto:bazaar&#37;&#52;&#48;lists&#46;canonical&#46;com">bazaar<span>&#64;</span>lists<span>&#46;</span>canonical<span>&#46;</span>com</a>.</p>
</div>
</div>
<div class="section" id="core-concepts">
<h3><a class="toc-backref" href="#id47">Core concepts</a><a class="headerlink" href="#core-concepts" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-simple-user-model">
<h4>A simple user model<a class="headerlink" href="#a-simple-user-model" title="Permalink to this headline">¶</a></h4>
<p>To use Breezy you need to understand four core concepts:</p>
<ul class="simple">
<li><strong>Revision</strong> - a snapshot of the files you’re working with.</li>
<li><strong>Working tree</strong> - the directory containing your version-controlled
files and sub-directories.</li>
<li><strong>Branch</strong> - an ordered set of revisions that describe the history of a
set of files.</li>
<li><strong>Repository</strong> - a store of revisions.</li>
</ul>
<p>Let’s look at each in more detail.</p>
</div>
<div class="section" id="revision">
<h4>Revision<a class="headerlink" href="#revision" title="Permalink to this headline">¶</a></h4>
<p>A revision is a <em>snapshot</em> of the state of a tree of files and directories,
including their content and shape. A revision also has some metadata
associated with it, including:</p>
<ul class="simple">
<li>Who committed it</li>
<li>When it was committed</li>
<li>A commit message</li>
<li>Parent revisions from which it was derived</li>
</ul>
<p>Revisions are immutable and can be globally, uniquely identified
by a <em>revision-id</em>. An example revision-id is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pqm</span><span class="nd">@pqm</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="o">-</span><span class="mi">20071129184101</span><span class="o">-</span><span class="n">u9506rihe4zbzyyz</span>
</pre></div>
</div>
<p>Revision-ids are generated at commit time or, for imports from other
systems, at the time of import. While revision-ids are necessary
for internal use and external tool integration, branch-specific
<em>revision numbers</em> are the preferred interface for humans.</p>
<p>Revision numbers are dotted decimal identifiers like 1, 42 and 2977.1.59
that trace a path through the revision number graph for a branch.
Revision numbers are generally shorter than revision-ids and,
within a single branch, can be compared with each other to get a sense
of their relationship. For example, revision 10 is the mainline (see below)
revision immediately after revision 9. Revision numbers
are generated on the fly when commands are executing, because they
depend on which revision is the tip (i.e. most recent revision)
in the branch.</p>
<p>See <a class="reference external" href="specifying_revisions.html">Specifying revisions</a> in the appendices
for a closer look at the numerous ways that revisions and ranges of
revisions can be specified in Breezy, and <a class="reference external" href="zen.html#understanding-revision-numbers">Understanding Revision Numbers</a> for a more detailed
description of revision numbering.</p>
</div>
<div class="section" id="working-tree">
<h4>Working Tree<a class="headerlink" href="#working-tree" title="Permalink to this headline">¶</a></h4>
<p>A working tree is a <em>version-controlled directory</em> holding files the user
can edit. A working tree is associated with a <em>branch</em>.</p>
<p>Many commands use the working tree as their context, e.g. <code class="docutils literal notranslate"><span class="pre">commit</span></code> makes
a new revision using the current content of files in the working tree.</p>
</div>
<div class="section" id="branch">
<h4>Branch<a class="headerlink" href="#branch" title="Permalink to this headline">¶</a></h4>
<p>In the simplest case, a branch is an <em>ordered series of revisions</em>.
The last revision is known as the <em>tip</em>.</p>
<p>Branches may split apart and be <em>merged</em> back together, forming a
<em>graph</em> of revisions. Technically, the graph shows directed relationships
(between parent and child revisions) and there are no loops, so
you may hear some people refer to it as a <em>directed acyclic graph</em> or DAG.</p>
<p>If this name sounds scary, don’t worry. The important things
to remember are:</p>
<ul class="simple">
<li>The primary line of development within the DAG is called
the <em>mainline</em>, <em>trunk</em>, or simply the <em>left hand side</em> (LHS).</li>
<li>A branch might have other lines of development and if it does,
these other lines of development begin at some point and end at
another point.</li>
</ul>
</div>
<div class="section" id="repository">
<h4>Repository<a class="headerlink" href="#repository" title="Permalink to this headline">¶</a></h4>
<p>A repository is simply a <em>store of revisions</em>. In the simplest case,
each branch has its own repository. In other cases, it makes sense for
branches to share a repository in order to optimize disk usage.</p>
</div>
<div class="section" id="putting-the-concepts-together">
<h4>Putting the concepts together<a class="headerlink" href="#putting-the-concepts-together" title="Permalink to this headline">¶</a></h4>
<p>Once you have grasped the concepts above, the various ways of using Breezy
should become easier to understand. The simplest way of using Breezy is
to use a <em>standalone tree</em>, which has a working tree, branch, and repository
all in a single location. Other common scenarios include:</p>
<ul class="simple">
<li><a class="reference external" href="branching_a_project.html#a-reminder-about-shared-repositories">Shared repositories</a>
- working tree and branch are colocated, but the repository is in a higher level
directory.</li>
<li><a class="reference external" href="stacked.html">Stacked branches</a> - branch stores just its
unique revisions, using its parent’s repository for common revisions.</li>
<li><a class="reference external" href="using_checkouts.html#getting-a-lightweight-checkout">Lightweight checkouts</a>
- branch is stored in a different location to the working tree.</li>
</ul>
<p>The best way to use Breezy, however, depends on your needs. Let’s take a
look at some common workflows next.</p>
</div>
</div>
<div class="section" id="workflows">
<h3><a class="toc-backref" href="#id48">Workflows</a><a class="headerlink" href="#workflows" title="Permalink to this headline">¶</a></h3>
<div class="section" id="breezy-is-just-a-tool">
<h4>Breezy is just a tool<a class="headerlink" href="#breezy-is-just-a-tool" title="Permalink to this headline">¶</a></h4>
<p>Breezy supports many different ways of working together.
This means that you can
start with one workflow and adapt it over time as circumstances
change. There is no “one true way” that always makes sense and
there never will be. This section provides a brief overview of
some popular workflows supported by Breezy.</p>
<p>Keep in mind that these workflow are just <em>some</em> examples of how
Breezy can be used. You may want to use a workflow not listed here,
perhaps building on the ideas below.</p>
</div>
<div class="section" id="solo">
<h4>Solo<a class="headerlink" href="#solo" title="Permalink to this headline">¶</a></h4>
<p>Whether developing software, editing documents or changing configuration files,
having an easy-to-use VCS tool can help. A single user can use this workflow
effectively for managing projects where they are the only contributor.</p>
<img alt="../_images/workflows_single.png" src="../_images/workflows_single.png" />
<p>Advantages of this workflow over not using version control at all include:</p>
<blockquote>
<div><ul class="simple">
<li>backup of old versions</li>
<li>rollback to an earlier state</li>
<li>tracking of history.</li>
</ul>
</div></blockquote>
<p>The key features of Breezy appropriate for this workflow are low administration
(no server setup) and ease of use.</p>
</div>
<div class="section" id="partner">
<h4>Partner<a class="headerlink" href="#partner" title="Permalink to this headline">¶</a></h4>
<p>Sometimes two people need to work together sharing changes as they go. This
commonly starts off as a <em>Solo</em> workflow (see above) or a team-oriented
workflow (see below). At some point, the second person takes a branch (copy
including history) of what the first person has done. They can then work in
parallel exchanging changes by merging when appropriate.</p>
<img alt="../_images/workflows_peer.png" src="../_images/workflows_peer.png" />
<p>Advantages over <em>Solo</em> are:</p>
<blockquote>
<div><ul class="simple">
<li>easier sharing of changes</li>
<li>each line of each text file can be attributed to a particular change
including who changed it, when and why.</li>
</ul>
</div></blockquote>
<p>When implementing this workflow, Breezy’s advantages over CVS and Subversion include:</p>
<blockquote>
<div><ul class="simple">
<li>no server to setup</li>
<li>intelligent merging means merging multiple times isn’t painful.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="centralized">
<h4>Centralized<a class="headerlink" href="#centralized" title="Permalink to this headline">¶</a></h4>
<p>Also known as <em>lock-step</em>, this is essentially the same as the workflow
encouraged/enforced by CVS and Subversion. All developers work on the same
branch (or branches). They run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">update</span></code> to get their checkout up-to-date,
then <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">commit</span></code> to publish their changes to the central location.</p>
<img alt="../_images/workflows_centralized.png" src="../_images/workflows_centralized.png" />
<p>Subversion and CVS are good choices for implementing this workflow because they
make it easy. Breezy directly supports it as well while providing some
important advantages over CVS and Subversion:</p>
<blockquote>
<div><ul class="simple">
<li>better branching and merging</li>
<li>better renaming support.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="centralized-with-local-commits">
<h4>Centralized with local commits<a class="headerlink" href="#centralized-with-local-commits" title="Permalink to this headline">¶</a></h4>
<p>This is essentially the same as the <em>Centralized</em> model, except that when
developers are making a series of changes, they do <code class="docutils literal notranslate"><span class="pre">commit</span> <span class="pre">--local</span></code> or unbind
their checkout. When it is complete, they commit their work to the shared
mainline.</p>
<img alt="../_images/workflows_localcommit.png" src="../_images/workflows_localcommit.png" />
<p>Advantages over <em>Centralized</em>:</p>
<blockquote>
<div><ul class="simple">
<li>Can work offline, e.g. when disconnected during travel</li>
<li>Less chance for a bad commit to interfere with everyone else’s work</li>
</ul>
</div></blockquote>
<p>Subversion and CVS do not support this model. Other distributed VCS tools can
support it but do so less directly than Breezy does.</p>
</div>
<div class="section" id="decentralized-with-shared-mainline">
<h4>Decentralized with shared mainline<a class="headerlink" href="#decentralized-with-shared-mainline" title="Permalink to this headline">¶</a></h4>
<p>In this workflow, each developer has their own branch or branches, plus commit
rights to the main branch. They do their work in their personal branch, then
merge it into the mainline when it is ready.</p>
<img alt="../_images/workflows_shared.png" src="../_images/workflows_shared.png" />
<p>Advantage over <em>Centralized with local commits</em>:</p>
<blockquote>
<div><ul class="simple">
<li>Easier organization of work - separate changes can be developed in their own branches</li>
<li>Developers can merge one another’s personal branches when working on something together.</li>
</ul>
</div></blockquote>
<p>Subversion and CVS do not support this model. Other distributed VCS
tools support it. Many features of Breezy are good for this workflow
including ease of use, shared repositories, integrated merging and
rich metadata (including directory rename tracking).</p>
</div>
<div class="section" id="decentralized-with-human-gatekeeper">
<h4>Decentralized with human gatekeeper<a class="headerlink" href="#decentralized-with-human-gatekeeper" title="Permalink to this headline">¶</a></h4>
<p>In this workflow, each developer has their own branch or branches, plus
read-only access to the main branch. One developer (the gatekeeper) has commit
rights to the main branch. When a developer wants their work merged, they ask
the gatekeeper to merge it. The gatekeeper does code review, and merges the
work into the main branch if it meets the necessary standards.</p>
<img alt="../_images/workflows_gatekeeper.png" src="../_images/workflows_gatekeeper.png" />
<p>Advantage over <em>Decentralized with shared mainline</em>:</p>
<blockquote>
<div><ul class="simple">
<li>Code is always reviewed before it enters the mainline</li>
<li>Tighter control over when changes get incorporated into the mainline.</li>
</ul>
</div></blockquote>
<p>A companion tool of Breezy’s called Bundle Buggy can be very useful for
tracking what changes are up for review, their status and reviewer comments.</p>
</div>
<div class="section" id="decentralized-with-automatic-gatekeeper">
<h4>Decentralized with automatic gatekeeper<a class="headerlink" href="#decentralized-with-automatic-gatekeeper" title="Permalink to this headline">¶</a></h4>
<p>In this workflow, each developer has their own branch or branches, plus
read-only access to the mainline. A software gatekeeper has commit rights to
the main branch. When a developer wants their work merged, they request another
person to review it. Once it has passed review, either the original author or
the reviewer asks the gatekeeper software to merge it, depending on team
policies. The gatekeeper software does a merge, a compile, and runs the test
suite. If and only if the code passes, it is merged into the mainline.</p>
<p>Note: As an alternative, the review step can be skipped and the author can
submit the change to the automatic gatekeeper without it. (This is particularly
appropriate when using practices such as Pair Programming that effectively
promote just-in-time reviews instead of reviewing code as a separate step.)</p>
<img alt="../_images/workflows_pqm.png" src="../_images/workflows_pqm.png" />
<p>Advantages over <em>Decentralized with human gatekeeper</em>:</p>
<blockquote>
<div><ul class="simple">
<li>Code is always tested before it enters the mainline (so the integrity of the
mainline is higher)</li>
<li>Scales better as teams grow.</li>
</ul>
</div></blockquote>
<p>A companion tool of Breezy’s called Patch Queue Manager (PQM) can provide the
automated gatekeeper capability.</p>
</div>
<div class="section" id="implementing-a-workflow">
<h4>Implementing a workflow<a class="headerlink" href="#implementing-a-workflow" title="Permalink to this headline">¶</a></h4>
<p>For an in-depth look at how to implement each of the workflows above,
see chapters 3 to 6 in this manual. First though, chapter 2
explains some important pre-requisites including installation, general
usage instructions and configuration tips.</p>
</div>
</div>
</div>
<div class="section" id="getting-started">
<h2><a class="toc-backref" href="#id49">Getting started</a><a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installing-breezy">
<h3><a class="toc-backref" href="#id50">Installing Breezy</a><a class="headerlink" href="#installing-breezy" title="Permalink to this headline">¶</a></h3>
<div class="section" id="gnu-linux">
<h4>GNU/Linux<a class="headerlink" href="#gnu-linux" title="Permalink to this headline">¶</a></h4>
<p>Breezy packages are available for most popular GNU/Linux distributions
including Ubuntu, Debian, Red Hat and Gentoo.
See <a class="reference external" href="https://www.breezy-vcs.org/pages/download.html">https://www.breezy-vcs.org/pages/download.html</a> for the latest instructions.</p>
</div>
<div class="section" id="windows">
<h4>Windows<a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h4>
<p>For Windows users, an installer is available that includes
the core Breezy package together with necessary pre-requisites
and some useful plug-ins.
See <a class="reference external" href="https://www.breezy-vcs.org/pages/download.html">https://www.breezy-vcs.org/pages/download.html</a> for the latest instructions.</p>
<p>Note: If you are running Cygwin on Windows, a Breezy for Cygwin package
is available and ought to be used instead of the Windows version.</p>
</div>
<div class="section" id="other-operating-systems">
<h4>Other operating systems<a class="headerlink" href="#other-operating-systems" title="Permalink to this headline">¶</a></h4>
<p>Beyond Linux and Windows, Breezy packages are available for a large
range of other operating systems include Mac OS X, FreeBSD and Solaris.
See <a class="reference external" href="https://www.breezy-vcs.org/pages/download.html">https://www.breezy-vcs.org/pages/download.html</a> for the latest instructions.</p>
</div>
<div class="section" id="installing-from-scratch">
<h4>Installing from scratch<a class="headerlink" href="#installing-from-scratch" title="Permalink to this headline">¶</a></h4>
<p>If you wish to install Breezy from scratch rather than using a
pre-built package, the steps are:</p>
<blockquote>
<div><ol class="arabic simple">
<li>If it is not installed already, install Python 2.7 or later.</li>
<li>Download the <code class="docutils literal notranslate"><span class="pre">breezy-xxx.tar.gz</span></code> file (where xxx is the version
number) from <a class="reference external" href="https://www.breezy-vcs.org/pages/download.html">https://www.breezy-vcs.org/pages/download.html</a> or from Launchpad
(<a class="reference external" href="https://launchpad.net/~brz/">https://launchpad.net/~brz/</a>).</li>
<li>Unpack the archive using tar, WinZip or equivalent.</li>
<li>Put the created directory on your PATH.</li>
</ol>
</div></blockquote>
<p>To test the installation, try running the <strong>brz</strong> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">version</span>
</pre></div>
</div>
<p>This will display the version of Breezy you have installed. If this
doesn’t work, please contact us via email or IRC so we can help you
get things working.</p>
<div class="section" id="installing-into-site-wide-locations">
<h5>Installing into site-wide locations<a class="headerlink" href="#installing-into-site-wide-locations" title="Permalink to this headline">¶</a></h5>
<p>Instead of adding the directory to your PATH, you can install brz into the
system locations using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>If you do not have a compiler, or do not have the python development tools
installed, brz supplies a (slower) pure-python implementation of all
extensions. You can install without compiling extensions with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span> <span class="n">build_ext</span> <span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">fallback</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-development-version">
<h4>Running the development version<a class="headerlink" href="#running-the-development-version" title="Permalink to this headline">¶</a></h4>
<p>You may wish to always be using the very latest development version of
Breezy. Note that this is not recommended for
the majority of users as there is an increased risk of bugs. On the other
hand, the development version is remarkably solid (thanks to the processes
we follow) and running it makes it easier for you to send us changes for
bugs and improvements. It also helps us by having more people testing
the latest software.</p>
<p>Here are the steps to follow:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Install Breezy using one of the methods given above.</p>
</li>
<li><p class="first">Get a copy of the development version like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">lp</span><span class="p">:</span><span class="n">brz</span>
</pre></div>
</div>
</li>
<li><p class="first">Put the created directory on your PATH.</p>
</li>
</ol>
</div></blockquote>
<p>Advanced users may also wish to build the optional C extensions for greater
speed. This can be done using <code class="docutils literal notranslate"><span class="pre">make</span></code> and requires <code class="docutils literal notranslate"><span class="pre">cython</span></code> and a C compiler.
Please contact us on email or IRC if you need assistance with this.</p>
</div>
<div class="section" id="running-multiple-versions">
<h4>Running multiple versions<a class="headerlink" href="#running-multiple-versions" title="Permalink to this headline">¶</a></h4>
<p>It’s easy to have multiple versions of Breezy installed and to switch
between them. To do this,
simply provide the full pathname to the <strong>brz</strong> command you wish to run.
The relevant libraries will be automatically detected and used. Of course,
if you do not provide a pathname, then the <strong>brz</strong> used will be the one
found on your system path as normal.</p>
<p>Note that this capability is particularly useful if you wish to run
(or test) both the latest released version and the development version say.</p>
</div>
</div>
<div class="section" id="entering-commands">
<h3><a class="toc-backref" href="#id51">Entering commands</a><a class="headerlink" href="#entering-commands" title="Permalink to this headline">¶</a></h3>
<div class="section" id="user-interfaces">
<h4>User interfaces<a class="headerlink" href="#user-interfaces" title="Permalink to this headline">¶</a></h4>
<p>There are numerous user interfaces available for Breezy.
The core package provides a command line tool called <strong>brz</strong> and
graphical user interfaces (GUIs) are available as plug-ins.</p>
</div>
<div class="section" id="using-brz">
<h4>Using brz<a class="headerlink" href="#using-brz" title="Permalink to this headline">¶</a></h4>
<p>The syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="p">[</span><span class="k">global</span><span class="o">-</span><span class="n">options</span><span class="p">]</span> <span class="n">command</span> <span class="p">[</span><span class="n">options</span> <span class="ow">and</span> <span class="n">arguments</span><span class="p">]</span>
</pre></div>
</div>
<p>Global options affect how Breezy operates and can appear either
before or after <code class="docutils literal notranslate"><span class="pre">command</span></code>. Command specific options must appear
after the command but may be given either before, during or after any
command-specific arguments.</p>
</div>
<div class="section" id="common-options">
<h4>Common options<a class="headerlink" href="#common-options" title="Permalink to this headline">¶</a></h4>
<p>Some options are legal for all commands as shown below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="25%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Short form</th>
<th class="head">Long form</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>-h</td>
<td>–help</td>
<td>get help</td>
</tr>
<tr class="row-odd"><td>-v</td>
<td>–verbose</td>
<td>be more verbose</td>
</tr>
<tr class="row-even"><td>-q</td>
<td>–quiet</td>
<td>be more quiet</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Quiet mode implies that only errors and warnings are displayed.
This can be useful in scripts.</p>
<p>Note: Most commands typically only support one level of verbosity though
that may change in the future. To ask for a higher level of verbosity,
simply specify the -v option multiple times.</p>
</div>
</div>
<div class="section" id="getting-help">
<h3><a class="toc-backref" href="#id52">Getting help</a><a class="headerlink" href="#getting-help" title="Permalink to this headline">¶</a></h3>
<p>Breezy comes with a built-in on-line help system, accessed through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">help</span>
</pre></div>
</div>
<p>You can ask for help on a command, or on non-command topics.  To see a
list of available help of each kind, use either:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">help</span> <span class="n">commands</span>
<span class="n">brz</span> <span class="n">help</span> <span class="n">topics</span>
</pre></div>
</div>
<p>For help on a particular command, use either of these forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">help</span> <span class="n">status</span>
<span class="n">brz</span> <span class="n">status</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>If you wish to search the help or read it as a larger document, the
information is also available in the Breezy User Reference.</p>
</div>
<div class="section" id="configuring-breezy">
<h3><a class="toc-backref" href="#id53">Configuring Breezy</a><a class="headerlink" href="#configuring-breezy" title="Permalink to this headline">¶</a></h3>
<div class="section" id="telling-breezy-about-yourself">
<h4>Telling Breezy about yourself<a class="headerlink" href="#telling-breezy-about-yourself" title="Permalink to this headline">¶</a></h4>
<p>One function of a version control system is to keep track of who changed
what.  In a decentralized system, that requires an identifier for each
author that is globally unique.  Most people already have one of these: an
email address. Breezy is smart enough to automatically generate an email
address by looking up your username and hostname. If you don’t like the
guess that Breezy makes, then use the <code class="docutils literal notranslate"><span class="pre">whoami</span></code> command to set the
identifier you want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">whoami</span> <span class="s2">&quot;Your Name &lt;email@example.com&gt;&quot;</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">whoami</span></code> is used without an argument, the current value is displayed.</p>
</div>
<div class="section" id="using-a-network-proxy">
<h4>Using a network proxy<a class="headerlink" href="#using-a-network-proxy" title="Permalink to this headline">¶</a></h4>
<p>If your network requires that you use an HTTP proxy for outbound
connections, you must set the <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> variable.  If the proxy is
also required for https connections, you need to set <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code> too.
If you need these and don’t have them set, you may find that connections
to Launchpad or other external servers fail or time out.</p>
<p>On Unix you typically want to set these in <code class="docutils literal notranslate"><span class="pre">/etc/environment</span></code> or
<code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> and on Windows in the user profile.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http_proxy</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">proxy</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">3128</span><span class="o">/</span>
<span class="n">https_proxy</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">proxy</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">3128</span><span class="o">/</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">no_proxy</span></code> variable can be set to a comma-separated list of hosts
which shouldn’t be reached by the proxy.  (See
&lt;<a class="reference external" href="http://docs.python.org/library/urllib.html">http://docs.python.org/library/urllib.html</a>&gt; for more details.)</p>
</div>
<div class="section" id="various-ways-to-configure">
<h4>Various ways to configure<a class="headerlink" href="#various-ways-to-configure" title="Permalink to this headline">¶</a></h4>
<p>As shown in the example above, there are various ways to
configure Breezy, they all share some common properties though.
An option has:</p>
<ul class="simple">
<li>a name which is generally a valid python identifier,</li>
<li>a value which is a string. In some cases, Breezy will be able
to recognize special values like ‘True’, ‘False’ to infer a
boolean type, but basically, as a user, you will always specify
a value as a string.</li>
</ul>
<p>Options are grouped in various contexts so the option name
uniquely identifies it in this context. When needed, options can
be made persistent by recording them in a configuration file.</p>
</div>
<div class="section" id="configuration-files">
<h4>Configuration files<a class="headerlink" href="#configuration-files" title="Permalink to this headline">¶</a></h4>
<p>Configuration files are located in <code class="docutils literal notranslate"><span class="pre">$HOME/.config/breezy</span></code> on Unix and
<code class="docutils literal notranslate"><span class="pre">C:\Documents</span> <span class="pre">and</span> <span class="pre">Settings\&lt;username&gt;\Application</span> <span class="pre">Data\Breezy\2.0</span></code> on
Windows. There are three primary configuration files in this location:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> describes default configuration options,</li>
<li><code class="docutils literal notranslate"><span class="pre">locations.conf</span></code> describes configuration information for
specific branch locations,</li>
<li><code class="docutils literal notranslate"><span class="pre">authentication.conf</span></code> describes credential information for
remote servers.</li>
</ul>
<p>Each branch can also contain a configuration file that sets values specific
to that branch. This file is found at <code class="docutils literal notranslate"><span class="pre">.brz/branch/branch.conf</span></code> within the
branch. This file is visible to <strong>all users of a branch</strong>. If you wish to
override one of the values for a branch with a setting that is specific to you,
then you can do so in <code class="docutils literal notranslate"><span class="pre">locations.conf</span></code>.</p>
<p>Here is sample content of <code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> after setting an email address using
the <code class="docutils literal notranslate"><span class="pre">whoami</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="n">email</span> <span class="o">=</span> <span class="n">Your</span> <span class="n">Name</span> <span class="o">&lt;</span><span class="n">email</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For further details on the syntax and configuration settings supported, see
<a class="reference external" href="../user-reference/index.html#configuration-settings">Configuration Settings</a>
in the Breezy User Reference.</p>
</div>
<div class="section" id="looking-at-the-active-configuration">
<h4>Looking at the active configuration<a class="headerlink" href="#looking-at-the-active-configuration" title="Permalink to this headline">¶</a></h4>
<p>To look at all the currently defined options, you can use the following
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">config</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">brz</span></code> implements some rules to decide where to get the value of a
configuration option.</p>
<p>The current policy is to examine the existing configurations files in a
given order for matching definitions.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">locations.conf</span></code> is searched first for a section whose name matches the
location considered (working tree, branch or remote branch),</li>
<li>the current <code class="docutils literal notranslate"><span class="pre">branch.conf</span></code> is searched next,</li>
<li><code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> is searched next,</li>
<li>finally, some options can have default values generally defined in the
code itself and not displayed by <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">config</span></code> (see <a class="reference external" href="../user-reference/index.html#configuration-settings">Configuration
Settings</a>).</li>
</ul>
</div></blockquote>
<p>This is better understood by using <code class="docutils literal notranslate"><span class="pre">`brz</span> <span class="pre">config</span></code> with no arguments, which
will display some output of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">locations</span><span class="p">:</span>
  <span class="n">post_commit_to</span> <span class="o">=</span> <span class="n">commits</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span>
  <span class="n">news_merge_files</span> <span class="o">=</span> <span class="n">NEWS</span>
<span class="n">branch</span><span class="p">:</span>
  <span class="n">parent_location</span> <span class="o">=</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">bazaar</span><span class="o">.</span><span class="n">launchpad</span><span class="o">.</span><span class="n">net</span><span class="o">/+</span><span class="n">branch</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span>
  <span class="n">nickname</span> <span class="o">=</span> <span class="n">config</span><span class="o">-</span><span class="n">modify</span>
  <span class="n">push_location</span> <span class="o">=</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">bazaar</span><span class="o">.</span><span class="n">launchpad</span><span class="o">.</span><span class="n">net</span><span class="o">/~</span><span class="n">vila</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="n">modify</span><span class="o">/</span>
<span class="n">breezy</span><span class="p">:</span>
  <span class="n">debug_flags</span> <span class="o">=</span> <span class="n">hpss</span><span class="p">,</span>
</pre></div>
</div>
<p>Each configuration file is associated with a given scope whose name is
displayed before each set of defined options.</p>
<p>If you need to look at a specific option, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">config</span> <span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This will display only the option value and is intended to be used in
scripts.</p>
</div>
<div class="section" id="modifying-the-active-configuration">
<h4>Modifying the active configuration<a class="headerlink" href="#modifying-the-active-configuration" title="Permalink to this headline">¶</a></h4>
<p>To set an option to a given value use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">config</span> <span class="n">opt</span><span class="o">=</span><span class="n">value</span>
</pre></div>
</div>
<p>An option value can reference another option by enclosing it in curly
braces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">config</span> <span class="n">opt</span><span class="o">=</span><span class="p">{</span><span class="n">other_opt</span><span class="p">}</span><span class="o">/</span><span class="n">subdir</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">other_opt</span></code> is set to <code class="docutils literal notranslate"><span class="pre">'root</span></code>, <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">config</span> <span class="pre">opt</span></code> will display:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="o">/</span><span class="n">subdir</span>
</pre></div>
</div>
<p>Note that when <code class="docutils literal notranslate"><span class="pre">--all</span></code> is used, the references are left as-is to better
reflect the content of the config files and make it easier to organize them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">config</span> <span class="o">--</span><span class="nb">all</span> <span class="o">.*</span><span class="n">opt</span>

<span class="n">breezy</span><span class="p">:</span>
  <span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
  <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span><span class="n">other_opt</span><span class="p">}</span><span class="o">/</span><span class="n">subdir</span>
  <span class="n">other_opt</span> <span class="o">=</span> <span class="n">root</span>
</pre></div>
</div>
<p>To remove an option use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">config</span> <span class="o">--</span><span class="n">remove</span> <span class="n">opt</span>
</pre></div>
</div>
</div>
<div class="section" id="rule-based-preferences">
<h4>Rule-based preferences<a class="headerlink" href="#rule-based-preferences" title="Permalink to this headline">¶</a></h4>
<p>Some commands and plugins provide custom processing on files matching
certain patterns. Per-user rule-based preferences are defined in
<code class="docutils literal notranslate"><span class="pre">BZR_HOME/rules</span></code>.</p>
<p>For further information on how rules are searched and the detailed syntax of
the relevant files, see <a class="reference external" href="../user-reference/index.html#rules">Rules</a>
in the Breezy User Reference.</p>
</div>
<div class="section" id="escaping-command-lines">
<h4>Escaping command lines<a class="headerlink" href="#escaping-command-lines" title="Permalink to this headline">¶</a></h4>
<p>When you give a program name or command line in configuration, you can quote
to include special characters or whitespace.  The same rules are used across
all platforms.</p>
<p>The rules are: strings surrounded by double-quotes are interpreted as single
“words” even if they contain whitespace, and backslash may be used to quote
quotation marks.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BZR_EDITOR</span><span class="o">=</span><span class="s2">&quot;C:\Program Files\My Editor\myeditor.exe&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-aliases">
<h3><a class="toc-backref" href="#id54">Using aliases</a><a class="headerlink" href="#using-aliases" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-are-aliases">
<h4>What are aliases?<a class="headerlink" href="#what-are-aliases" title="Permalink to this headline">¶</a></h4>
<p>Aliases are an easy way to create shortcuts for commonly-typed commands, or to set
defaults for commands.</p>
</div>
<div class="section" id="defining-aliases">
<h4>Defining aliases<a class="headerlink" href="#defining-aliases" title="Permalink to this headline">¶</a></h4>
<p>Command aliases can be defined in the <code class="docutils literal notranslate"><span class="pre">[ALIASES]</span></code> section of your
<code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> file. Aliases start with the alias name, then an
equal sign, then a command fragment.  Here’s an example ALIASES section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ALIASES</span><span class="p">]</span>
<span class="n">recentlog</span><span class="o">=</span><span class="n">log</span> <span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="mf">3.</span><span class="o">.-</span><span class="mi">1</span>
<span class="n">ll</span><span class="o">=</span><span class="n">log</span> <span class="o">--</span><span class="n">line</span> <span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="mf">10.</span><span class="o">.-</span><span class="mi">1</span>
<span class="n">commit</span><span class="o">=</span><span class="n">commit</span> <span class="o">--</span><span class="n">strict</span>
<span class="n">diff</span><span class="o">=</span><span class="n">diff</span> <span class="o">--</span><span class="n">diff</span><span class="o">-</span><span class="n">options</span> <span class="o">-</span><span class="n">p</span>
</pre></div>
</div>
<p>Here are the explanations of the examples above:</p>
<blockquote>
<div><ul class="simple">
<li>The first alias makes a new <code class="docutils literal notranslate"><span class="pre">recentlog</span></code> command that shows the logs for the
last three revisions</li>
<li>The <code class="docutils literal notranslate"><span class="pre">ll</span></code> alias shows the last 10 log entries in line format.</li>
<li>the <code class="docutils literal notranslate"><span class="pre">commit</span></code> alias sets the default for commit to refuse to commit if new
files in the tree are not recognized.</li>
<li>the <code class="docutils literal notranslate"><span class="pre">diff</span></code> alias adds the coveted -p option to diff</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="using-the-aliases">
<h4>Using the aliases<a class="headerlink" href="#using-the-aliases" title="Permalink to this headline">¶</a></h4>
<p>The aliases defined above would be used like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">recentlog</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">ll</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">diff</span>
</pre></div>
</div>
</div>
<div class="section" id="rules-for-aliases">
<h4>Rules for aliases<a class="headerlink" href="#rules-for-aliases" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>You can override a portion of the options given in an alias by
specifying the new part on the command-line.  For example, if
you run <code class="docutils literal notranslate"><span class="pre">lastlog</span> <span class="pre">-r-5..</span></code>, you will only get five line-based log
entries instead of 10.  Note that all boolean options have an
implicit inverse, so you can override the commit alias with
<code class="docutils literal notranslate"><span class="pre">commit</span> <span class="pre">--no-strict</span></code>.</li>
<li>Aliases can override the standard behaviour of existing commands by giving
an alias name that is the same as the original command. For example, default
commit is changed with <code class="docutils literal notranslate"><span class="pre">commit=commit</span> <span class="pre">--strict</span></code>.</li>
<li>Aliases cannot refer to other aliases. In other words making a
<code class="docutils literal notranslate"><span class="pre">lastlog</span></code> alias and referring to it with a <code class="docutils literal notranslate"><span class="pre">ll</span></code> alias will not work.
This includes aliases that override standard commands.</li>
<li>Giving the <code class="docutils literal notranslate"><span class="pre">--no-aliases</span></code> option to the brz command will tell it to ignore aliases
for that run. For example, running <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">--no-aliases</span> <span class="pre">commit</span></code> will perform a
standard commit instead, not do a <code class="docutils literal notranslate"><span class="pre">commit</span> <span class="pre">--strict</span></code>.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="using-plugins">
<h3><a class="toc-backref" href="#id55">Using plugins</a><a class="headerlink" href="#using-plugins" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-is-a-plugin">
<h4>What is a plugin?<a class="headerlink" href="#what-is-a-plugin" title="Permalink to this headline">¶</a></h4>
<p>A plugin is an external component for Breezy that is typically made by
third parties. A plugin is capable of augmenting Breezy by adding new
functionality.  A plugin can also change current Breezy behavior by
replacing current functionality. Sample applications of plugins are:</p>
<ul class="simple">
<li>overriding commands</li>
<li>adding new commands</li>
<li>providing additional network transports</li>
<li>customizing log output.</li>
</ul>
<p>The sky is the limit for the customization that can be done through plugins.
In fact, plugins often work as a way for developers to test new features for
Breezy prior to inclusion in the official codebase. Plugins are helpful
at feature retirement time as well, e.g. deprecated file formats may one
day be removed from the Breezy core and be made available as a plugin instead.</p>
<p>Plugins are good for users, good for external developers and good for
Breezy itself.</p>
</div>
<div class="section" id="where-to-find-plugins">
<h4>Where to find plugins<a class="headerlink" href="#where-to-find-plugins" title="Permalink to this headline">¶</a></h4>
<p>We keep our list of plugins on the <a class="reference external" href="http://wiki.bazaar.canonical.com/BzrPlugins">http://wiki.bazaar.canonical.com/BzrPlugins</a> page.</p>
</div>
<div class="section" id="how-to-install-a-plugin">
<h4>How to install a plugin<a class="headerlink" href="#how-to-install-a-plugin" title="Permalink to this headline">¶</a></h4>
<p>Installing a plugin is very easy! If not already created, create a
<code class="docutils literal notranslate"><span class="pre">plugins</span></code> directory under your Breezy configuration directory,
<code class="docutils literal notranslate"><span class="pre">~/.config/breezy/</span></code> on Unix and
<code class="docutils literal notranslate"><span class="pre">C:\Documents</span> <span class="pre">and</span> <span class="pre">Settings\&lt;username&gt;\Application</span> <span class="pre">Data\Breezy\2.0\</span></code>
on Windows. Within this directory (referred to as $BZR_HOME below),
each plugin is placed in its own subdirectory.</p>
<p>Plugins work particularly well with Breezy branches. For example, to
install the brztools plugins for your main user account on GNU/Linux,
one can perform the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">panoramicfeedback</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">opensource</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">brztools</span>
<span class="o">~/.</span><span class="n">config</span><span class="o">/</span><span class="n">breezy</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">brztools</span>
</pre></div>
</div>
<p>When installing plugins, the directories that you install them in must
be valid python identifiers. This means that they can only contain
certain characters, notably they cannot contain hyphens (<code class="docutils literal notranslate"><span class="pre">-</span></code>). Rather
than installing <code class="docutils literal notranslate"><span class="pre">brz-gtk</span></code> to <code class="docutils literal notranslate"><span class="pre">$BZR_HOME/plugins/brz-gtk</span></code>, install it
to <code class="docutils literal notranslate"><span class="pre">$BZR_HOME/plugins/gtk</span></code>.</p>
</div>
<div class="section" id="alternative-plugin-locations">
<h4>Alternative plugin locations<a class="headerlink" href="#alternative-plugin-locations" title="Permalink to this headline">¶</a></h4>
<p>If you have the necessary permissions, plugins can also be installed on a
system-wide basis.  One can additionally override the personal plugins
location by setting the environment variable <code class="docutils literal notranslate"><span class="pre">BZR_PLUGIN_PATH</span></code> (see <a class="reference external" href="../user-reference/configuration-help.html#brz-plugin-path">User
Reference</a>
for a detailed explanation).</p>
</div>
<div class="section" id="listing-the-installed-plugins">
<h4>Listing the installed plugins<a class="headerlink" href="#listing-the-installed-plugins" title="Permalink to this headline">¶</a></h4>
<p>To do this, use the plugins command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">plugins</span>
</pre></div>
</div>
<p>The name, location and version of each plugin installed will be displayed.</p>
<p>New commands added by plugins can be seen by running <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">help</span> <span class="pre">commands</span></code>.
The commands provided by a plugin are shown followed by the name of the
plugin in brackets.</p>
</div>
<div class="section" id="popular-plugins">
<h4>Popular plugins<a class="headerlink" href="#popular-plugins" title="Permalink to this headline">¶</a></h4>
<p>Here is a sample of some of the more popular plugins.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="25%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Category</th>
<th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GUI</td>
<td>QBzr</td>
<td>Qt-based GUI tools</td>
</tr>
<tr class="row-odd"><td>GUI</td>
<td>brz-gtk</td>
<td>GTK-based GUI tools</td>
</tr>
<tr class="row-even"><td>GUI</td>
<td>brz-eclipse</td>
<td>Eclipse integration</td>
</tr>
<tr class="row-odd"><td>General</td>
<td>brztools</td>
<td>misc. enhancements including shelf</td>
</tr>
<tr class="row-even"><td>General</td>
<td>difftools</td>
<td>external diff tool helper</td>
</tr>
<tr class="row-odd"><td>General</td>
<td>extmerge</td>
<td>external merge tool helper</td>
</tr>
<tr class="row-even"><td>Integration</td>
<td>brz-svn</td>
<td>use Subversion as a repository</td>
</tr>
<tr class="row-odd"><td>Migration</td>
<td>cvsps</td>
<td>migrate CVS patch-sets</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>If you wish to write your own plugins, it is not difficult to do.
See <a class="reference external" href="writingaplugin.html">Writing a plugin</a> in the appendices to get
started.</p>
</div>
</div>
<div class="section" id="breezy-zen">
<h3><a class="toc-backref" href="#id56">Breezy Zen</a><a class="headerlink" href="#breezy-zen" title="Permalink to this headline">¶</a></h3>
<div class="section" id="grokking-breezy">
<h4>Grokking Breezy<a class="headerlink" href="#grokking-breezy" title="Permalink to this headline">¶</a></h4>
<p>While Breezy is similar to other VCS tools in many ways, there are
some important differences that are not necessarily obvious at first
glance.  This section attempts
to explain some of the things users need to know in order to “grok” Breezy,
i.e. to deeply understand it.</p>
<p>Note: It isn’t necessary to fully understand this section to use Breezy.
You may wish to skim this section now and come back to it at a later time.</p>
</div>
<div class="section" id="id2">
<h4>Understanding revision numbers<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>All revisions in the mainline of a branch have a simple increasing
integer. (First commit gets 1, 10th commit gets 10, etc.) This makes them
fairly natural to use when you want to say “grab the 10th revision from my
branch”, or “fixed in revision 3050”.</p>
<p>For revisions which have been merged into a branch, a dotted notation is used
(e.g., 3112.1.5). Dotted revision numbers have three numbers <a class="footnote-reference" href="#id4" id="id3">[2]</a>. The first
number indicates what mainline revision change is derived from. The second
number is the branch counter. There can be many branches derived from the
same revision, so they all get a unique number. The third number is the
number of revisions since the branch started. For example, 3112.1.5 is the
first branch from revision 3112, the fifth revision on that branch.</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>Versions prior to brz 1.2 used a slightly different algorithm.
Some nested branches would get extra numbers (such as 1.1.1.1.1)
rather than the simpler 3-number system.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="hierarchical-history-is-good">
<h4>Hierarchical history is good<a class="headerlink" href="#hierarchical-history-is-good" title="Permalink to this headline">¶</a></h4>
<p>Imagine a project with multiple developers contributing changes where
many changes consist of a series of commits. To give a concrete example,
consider the case where:</p>
<blockquote>
<div><ul class="simple">
<li>The tip of the project’s trunk is revision 100.</li>
<li>Mary makes 3 changes to deliver feature X.</li>
<li>Bill makes 4 changes to deliver feature Y.</li>
</ul>
</div></blockquote>
<p>If the developers are working in parallel and using a traditional
centralized VCS approach, the project history will most likely be linear
with Mary’s changes and Bill’s changes interleaved. It might look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">107</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">106</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">Y</span>
<span class="mi">105</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">X</span>
<span class="mi">104</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">103</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">102</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">101</span><span class="p">:</span> <span class="n">Add</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">100</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Many teams use this approach because their tools make branching and merging
difficult. As a consequence, developers update from and commit to the trunk
frequently, minimizing integration pain by spreading it over every commit.
If you wish, you can use Breezy exactly like this. Breezy does offer other
ways though that you ought to consider.</p>
<p>An alternative approach encouraged by distributed VCS tools is to create
feature branches and to integrate those when they are ready. In this case,
Mary’s feature branch would look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">103</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">X</span>
<span class="mi">102</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">101</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">100</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>And Bill’s would look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">104</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">103</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">Y</span>
<span class="mi">102</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">101</span><span class="p">:</span> <span class="n">Add</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">100</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>If the features were independent and you wanted to keep linear history,
the changes could be pushed back into the trunk in batches. (Technically,
there are several ways of doing that but that’s beyond the scope of
this discussion.) The resulting history might look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">107</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">X</span>
<span class="mi">106</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">105</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">104</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">103</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">Y</span>
<span class="mi">102</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">101</span><span class="p">:</span> <span class="n">Add</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">100</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>While this takes a bit more effort to achieve, it has some advantages over
having revisions randomly intermixed. Better still though, branches can
be merged together forming a non-linear history. The result might look
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">102</span><span class="p">:</span> <span class="n">Merge</span> <span class="n">feature</span> <span class="n">X</span>
     <span class="mf">100.2</span><span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">X</span>
     <span class="mf">100.2</span><span class="o">.</span><span class="mi">2</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">X</span>
     <span class="mf">100.2</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">101</span><span class="p">:</span> <span class="n">Merge</span> <span class="n">feature</span> <span class="n">Y</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">4</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">Y</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">Y</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">2</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="k">for</span> <span class="n">Y</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Add</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">Y</span>
<span class="mi">100</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Or more likely this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">102</span><span class="p">:</span> <span class="n">Merge</span> <span class="n">feature</span> <span class="n">X</span>
     <span class="mf">100.2</span><span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span>
     <span class="mf">100.2</span><span class="o">.</span><span class="mi">2</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span>
     <span class="mf">100.2</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">tests</span>
<span class="mi">101</span><span class="p">:</span> <span class="n">Merge</span> <span class="n">feature</span> <span class="n">Y</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">4</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">2</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Add</span> <span class="n">tests</span>
<span class="mi">100</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>This is considered good for many reasons:</p>
<blockquote>
<div><ul class="simple">
<li>It makes it easier to understand the history of a project.
Related changes are clustered together and clearly partitioned.</li>
<li>You can easily collapse history to see just the commits on the mainline
of a branch. When viewing the trunk history like this, you only see
high level commits (instead of a large number of commits uninteresting
at this level).</li>
<li>If required, it makes backing out a feature much easier.</li>
<li>Continuous integration tools can be used to ensure that
all tests still pass before committing a merge to the mainline.
(In many cases, it isn’t appropriate to trigger CI tools after
every single commit as some tests will fail during development.
In fact, adding the tests first - TDD style - will guarantee it!)</li>
</ul>
</div></blockquote>
<p>In summary, the important points are:</p>
<blockquote>
<div><p><em>Organize your work using branches.</em></p>
<p><em>Integrate changes using merge.</em></p>
<p><em>Ordered revision numbers and hierarchy make history easier to follow.</em></p>
</div></blockquote>
</div>
<div class="section" id="each-branch-has-its-own-view-of-history">
<h4>Each branch has its own view of history<a class="headerlink" href="#each-branch-has-its-own-view-of-history" title="Permalink to this headline">¶</a></h4>
<p>As explained above, Breezy makes the distinction between:</p>
<blockquote>
<div><ul class="simple">
<li>mainline revisions, i.e. ones you committed in your branch, and</li>
<li>merged revisions, i.e. ones added as ancestors by committing a merge.</li>
</ul>
</div></blockquote>
<p>Each branch effectively has its own view of history, i.e. different
branches can give the same revision a different “local” revision number.
Mainline revisions always get allocated single number revision numbers
while merged revisions always get allocated dotted revision numbers.</p>
<p>To extend the example above, here’s what the revision history of
Mary’s branch would look like had she decided to merge the project
trunk into her branch after completing her changes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">104</span><span class="p">:</span> <span class="n">Merge</span> <span class="n">mainline</span>
     <span class="mf">100.2</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Merge</span> <span class="n">feature</span> <span class="n">Y</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">4</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">3</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">2</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span>
     <span class="mf">100.1</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Add</span> <span class="n">tests</span>
<span class="mi">103</span><span class="p">:</span> <span class="n">Fix</span> <span class="n">bug</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">X</span>
<span class="mi">102</span><span class="p">:</span> <span class="n">Add</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">101</span><span class="p">:</span> <span class="n">Add</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">tests</span> <span class="k">for</span> <span class="n">X</span>
<span class="mi">100</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Once again, it’s easy for Mary to look at just <em>her</em> top level of history
to see the steps she has taken to develop this change. In this context,
merging the trunk (and resolving any conflicts caused by doing that) is
just one step as far as the history of this branch is concerned.</p>
<p>It’s important to remember that Breezy is not changing history here, nor
is it changing the global revision identifiers. You can always use the
latter if you really want to. In fact, you can use the branch specific
revision numbers when communicating <em>as long as</em> you provide the branch
URL as context. (In many Breezy projects, developers imply the central
trunk branch if they exchange a revision number without a branch URL.)</p>
<p>Merges do not change revision numbers in a branch, though they do
allocate local revision numbers to newly merged revisions. The only time
Breezy will change revision numbers in a branch is when you explicitly
ask it to mirror another branch.</p>
<p>Note: Revisions are numbered in a stable way: if two branches have
the same revision in their mainline, all revisions in the ancestry of that
revision will have the same revision numbers. For example, if Alice and Bob’s
branches agree on revision 10, they will agree on all revisions before
that.</p>
</div>
<div class="section" id="summary">
<h4>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h4>
<p>In general, if you follow the advice given earlier - organise
your work in branches and use merge to collaborate - you’ll find Breezy
generally does what you expect.</p>
<p>In coming chapters, we examine various ways of using Breezy beginning with
the simplest: using Breezy for personal projects.</p>
</div>
</div>
</div>
<div class="section" id="personal-version-control">
<h2><a class="toc-backref" href="#id57">Personal version control</a><a class="headerlink" href="#personal-version-control" title="Permalink to this headline">¶</a></h2>
<div class="section" id="going-solo">
<h3><a class="toc-backref" href="#id58">Going solo</a><a class="headerlink" href="#going-solo" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-personal-productivity-tool">
<h4>A personal productivity tool<a class="headerlink" href="#a-personal-productivity-tool" title="Permalink to this headline">¶</a></h4>
<p>Some tools are designed to make individuals productive (e.g. editors)
while other tools (e.g. back-end services) are focused on making teams
or whole companies more productive. Version control tools have
traditionally been in the latter camp.</p>
<p>One of the cool things about Breezy is that it is so easy to setup
that version control can now be treated as a personal productivity tool.
If you wish to record changes to files for the purposes of checkpointing
good known states or tracking history, it is now easy to do so. This
chapter explains how.</p>
</div>
<div class="section" id="the-solo-workflow">
<h4>The solo workflow<a class="headerlink" href="#the-solo-workflow" title="Permalink to this headline">¶</a></h4>
<p>If you are creating your own masterpiece, whether that be a software
project or a set of related documents, the typical workflow looks like this:</p>
<img alt="../_images/workflows_single.png" src="../_images/workflows_single.png" />
<p>Even if you will always be working as part of a team, the tasks covered
in this chapter will be the basis of what you’ll be doing so it’s a good
place to start.</p>
</div>
</div>
<div class="section" id="starting-a-project">
<h3><a class="toc-backref" href="#id59">Starting a project</a><a class="headerlink" href="#starting-a-project" title="Permalink to this headline">¶</a></h3>
<div class="section" id="putting-an-existing-project-under-version-control">
<h4>Putting an existing project under version control<a class="headerlink" href="#putting-an-existing-project-under-version-control" title="Permalink to this headline">¶</a></h4>
<p>If you already have a tree of source code (or directory of documents) you
wish to put under version control, here are the commands to use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">stuff</span>
<span class="n">brz</span> <span class="n">init</span>
<span class="n">brz</span> <span class="n">add</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Initial import&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">init</span></code> creates a <code class="docutils literal notranslate"><span class="pre">.brz</span></code> directory in the top level directory
(<code class="docutils literal notranslate"><span class="pre">my-stuff</span></code> in the example above). Note that:</p>
<blockquote>
<div><ul class="simple">
<li>Breezy has everything it needs in that directory - you do
<strong>not</strong> need to setup a database, web server or special service
to use it</li>
<li>Breezy is polite enough to only create one <code class="docutils literal notranslate"><span class="pre">.brz</span></code> in the
directory given, not one in every subdirectory thereof.</li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">add</span></code> then finds all the files and directories it thinks
ought to be version controlled and registers them internally.
<code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">commit</span></code> then records a snapshot of the content of these
and records that information, together with a commit message.</p>
<p>More information on <code class="docutils literal notranslate"><span class="pre">init</span></code>, <code class="docutils literal notranslate"><span class="pre">add</span></code> and <code class="docutils literal notranslate"><span class="pre">commit</span></code> will be provided
later. For now, the important thing to remember is the recipe above.</p>
</div>
<div class="section" id="starting-a-new-project">
<h4>Starting a new project<a class="headerlink" href="#starting-a-new-project" title="Permalink to this headline">¶</a></h4>
<p>If you are starting a project from scratch, you can also use the recipe
above, after creating an empty directory first of course. For efficiency
reasons that will be explored more in later chapters though, it is a good
idea to create a repository for the project at the top level and to nest
a <em>main</em> branch within it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">my</span><span class="o">.</span><span class="n">repo</span>
<span class="n">cd</span> <span class="n">my</span><span class="o">.</span><span class="n">repo</span>
<span class="n">brz</span> <span class="n">init</span> <span class="n">my</span><span class="o">.</span><span class="n">main</span>
<span class="n">cd</span> <span class="n">my</span><span class="o">.</span><span class="n">main</span>
<span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span>
<span class="n">brz</span> <span class="n">add</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Initial import&quot;</span>
</pre></div>
</div>
<p>Some users prefer a name like <em>trunk</em> or <em>dev</em> to <em>main</em>. Choose
whichever name makes the most sense to you.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">init-repo</span></code> and <code class="docutils literal notranslate"><span class="pre">init</span></code> commands both take a path as an
argument and will create that path if it doesn’t already exist.</p>
</div>
</div>
<div class="section" id="controlling-file-registration">
<h3><a class="toc-backref" href="#id60">Controlling file registration</a><a class="headerlink" href="#controlling-file-registration" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-does-breezy-track">
<h4>What does Breezy track?<a class="headerlink" href="#what-does-breezy-track" title="Permalink to this headline">¶</a></h4>
<p>As explained earlier, <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">add</span></code> finds and registers all the things in
and under the current directory that Breezy thinks ought to be
version controlled. These things may be:</p>
<blockquote>
<div><ul class="simple">
<li>files</li>
<li>directories</li>
<li>symbolic links.</li>
</ul>
</div></blockquote>
<p>Breezy has default rules for deciding which files are
interesting and which ones are not. You can tune those rules as
explained in <a class="reference internal" href="#ignoring-files">Ignoring files</a> below.</p>
<p>Unlike many other VCS tools, Breezy tracks directories as first class
items. As a consequence, empty directories are correctly supported -
you don’t need to create a dummy file inside a directory just to
ensure it gets tracked and included in project exports.</p>
<p>For symbolic links, the value of the symbolic link is tracked,
not the content of the thing the symbolic link is pointing to.</p>
<p>Note: Support for tracking projects-within-projects (“nested trees”)
is currently under development. Please contact the Breezy developers
if you are interested in helping develop or test this functionality.</p>
</div>
<div class="section" id="selective-registration">
<h4>Selective registration<a class="headerlink" href="#selective-registration" title="Permalink to this headline">¶</a></h4>
<p>In some cases, you may want or need to explicitly nominate the things
to register rather than leave it up to Breezy to find things. To do this,
simply provide paths as arguments to the <code class="docutils literal notranslate"><span class="pre">add</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">add</span> <span class="n">fileX</span> <span class="n">dirY</span><span class="o">/</span>
</pre></div>
</div>
<p>Adding a directory implicitly adds all interesting things
underneath it.</p>
</div>
<div class="section" id="ignoring-files">
<h4>Ignoring files<a class="headerlink" href="#ignoring-files" title="Permalink to this headline">¶</a></h4>
<p>Many source trees contain some files that do not need to be versioned,
such as editor backups, object or bytecode files, and built programs.  You
can simply not add them, but then they’ll always crop up as unknown files.
You can also tell Breezy to ignore these files by adding them to a file
called <code class="docutils literal notranslate"><span class="pre">.bzrignore</span></code> at the top of the tree.</p>
<p>This file contains a list of file wildcards (or “globs”), one per line.
Typical contents are like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*.</span><span class="n">o</span>
<span class="o">*~</span>
<span class="o">*.</span><span class="n">tmp</span>
<span class="o">*.</span><span class="n">py</span><span class="p">[</span><span class="n">co</span><span class="p">]</span>
</pre></div>
</div>
<p>If a glob contains a slash, it is matched against the whole path from the
top of the tree; otherwise it is matched against only the filename.  So
the previous example ignores files with extension <code class="docutils literal notranslate"><span class="pre">.o</span></code> in all
subdirectories, but this example ignores only <code class="docutils literal notranslate"><span class="pre">config.h</span></code> at the top level
and HTML files in <code class="docutils literal notranslate"><span class="pre">doc/</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">config</span><span class="o">.</span><span class="n">h</span>
<span class="n">doc</span><span class="o">/*.</span><span class="n">html</span>
</pre></div>
</div>
<p>To get a list of which files are ignored and what pattern they matched,
use <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">ignored</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">ignored</span>
<span class="n">config</span><span class="o">.</span><span class="n">h</span>                 <span class="o">./</span><span class="n">config</span><span class="o">.</span><span class="n">h</span>
<span class="n">configure</span><span class="o">.</span><span class="ow">in</span><span class="o">~</span>            <span class="o">*~</span>
</pre></div>
</div>
<p>Note that ignore patterns are only matched against non-versioned files,
and control whether they are treated as “unknown” or “ignored”.  If a file
is explicitly added, it remains versioned regardless of whether it matches
an ignore pattern.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.bzrignore</span></code> file should normally be versioned, so that new copies
of the branch see the same patterns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">add</span> <span class="o">.</span><span class="n">bzrignore</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Add ignore patterns&quot;</span>
</pre></div>
</div>
<p>The command <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">ignore</span> <span class="pre">PATTERN</span></code> can be used to easily add PATTERN to
the <code class="docutils literal notranslate"><span class="pre">.bzrignore</span> <span class="pre">file</span></code> (creating it if necessary and registering it to
be tracked by Breezy).  Removing and modifying patterns are done by
directly editing the <code class="docutils literal notranslate"><span class="pre">.bzrignore</span></code> file.</p>
</div>
<div class="section" id="global-ignores">
<h4>Global ignores<a class="headerlink" href="#global-ignores" title="Permalink to this headline">¶</a></h4>
<p>There are some ignored files which are not project specific, but more user
specific. Things like editor temporary files, or personal temporary files.
Rather than add these ignores to every project, brz supports a global
ignore file in <code class="docutils literal notranslate"><span class="pre">~/.config/breezy/ignore</span></code> <a class="footnote-reference" href="#id6" id="id5">[3]</a>. It has the same syntax as the
per-project ignore file.</p>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>On Windows, the users configuration files can be found in the
application data directory. So instead of <code class="docutils literal notranslate"><span class="pre">~/.config/breezy/branch.conf</span></code>
the configuration file can be found as:
<code class="docutils literal notranslate"><span class="pre">C:\Documents</span> <span class="pre">and</span> <span class="pre">Settings\&lt;username&gt;\Application</span> <span class="pre">Data\Breezy\3.0\branch.conf</span></code>.
The same is true for <code class="docutils literal notranslate"><span class="pre">locations.conf</span></code>, <code class="docutils literal notranslate"><span class="pre">ignore</span></code>, and the
<code class="docutils literal notranslate"><span class="pre">plugins</span></code> directory.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="reviewing-changes">
<h3><a class="toc-backref" href="#id61">Reviewing changes</a><a class="headerlink" href="#reviewing-changes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="looking-before-you-leap">
<h4>Looking before you leap<a class="headerlink" href="#looking-before-you-leap" title="Permalink to this headline">¶</a></h4>
<p>Once you have completed some work, it’s a good idea to review your changes
prior to permanently recording it. This way, you can make sure you’ll be
committing what you intend to.</p>
<p>Two brz commands are particularly useful here: <strong>status</strong> and <strong>diff</strong>.</p>
</div>
<div class="section" id="brz-status">
<h4>brz status<a class="headerlink" href="#brz-status" title="Permalink to this headline">¶</a></h4>
<p>The <strong>status</strong> command tells you what changes have been made to the
working directory since the last revision:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">status</span>
<span class="n">modified</span><span class="p">:</span>
   <span class="n">foo</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">status</span></code> hides “boring” files that are either unchanged or ignored.
The status command can optionally be given the name of some files or
directories to check.</p>
</div>
<div class="section" id="brz-diff">
<h4>brz diff<a class="headerlink" href="#brz-diff" title="Permalink to this headline">¶</a></h4>
<p>The <strong>diff</strong> command shows the full text of changes to all files as a
standard unified diff.  This can be piped through many programs such as
‘’patch’‘, ‘’diffstat’‘, ‘’filterdiff’’ and ‘’colordiff’‘:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">diff</span>
<span class="o">===</span> <span class="n">added</span> <span class="n">file</span> <span class="s1">&#39;hello.txt&#39;</span>
<span class="o">---</span> <span class="n">hello</span><span class="o">.</span><span class="n">txt</span>   <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="o">+</span><span class="mi">0000</span>
<span class="o">+++</span> <span class="n">hello</span><span class="o">.</span><span class="n">txt</span>   <span class="mi">2005</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span> <span class="mi">14</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">29</span> <span class="o">+</span><span class="mi">0000</span>
<span class="o">@@</span> <span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span> <span class="o">@@</span>
<span class="o">+</span><span class="n">hello</span> <span class="n">world</span>
</pre></div>
</div>
<p>With the <code class="docutils literal notranslate"><span class="pre">-r</span></code> option, the tree is compared to an earlier revision, or
the differences between two versions are shown:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">diff</span> <span class="o">-</span><span class="n">r</span> <span class="mf">1000.</span><span class="o">.</span>          <span class="c1"># everything since r1000</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">diff</span> <span class="o">-</span><span class="n">r</span> <span class="mf">1000.</span><span class="o">.</span><span class="mi">1100</span>      <span class="c1"># changes from 1000 to 1100</span>
</pre></div>
</div>
<p>To see the changes introduced by a single revision, you can use the <code class="docutils literal notranslate"><span class="pre">-c</span></code>
option to diff.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">diff</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1000</span>            <span class="c1"># changes from r1000</span>
                              <span class="c1"># identical to -r999..1000</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--diff-options</span></code> option causes brz to run the external diff program,
passing options.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">diff</span> <span class="o">--</span><span class="n">diff</span><span class="o">-</span><span class="n">options</span> <span class="o">--</span><span class="n">side</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">side</span> <span class="n">foo</span>
</pre></div>
</div>
<p>Some projects prefer patches to show a prefix at the start of the path
for old and new files.  The <code class="docutils literal notranslate"><span class="pre">--prefix</span></code> option can be used to provide
such a prefix.
As a shortcut, <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">diff</span> <span class="pre">-p1</span></code> produces a form that works with the
command <code class="docutils literal notranslate"><span class="pre">patch</span> <span class="pre">-p1</span></code>.</p>
</div>
</div>
<div class="section" id="recording-changes">
<h3><a class="toc-backref" href="#id62">Recording changes</a><a class="headerlink" href="#recording-changes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="brz-commit">
<h4>brz commit<a class="headerlink" href="#brz-commit" title="Permalink to this headline">¶</a></h4>
<p>When the working tree state is satisfactory, it can be <strong>committed</strong> to
the branch, creating a new revision holding a snapshot of that state.</p>
<p>The <strong>commit</strong> command takes a message describing the changes in the
revision.  It also records your userid, the current time and timezone, and
the inventory and contents of the tree.  The commit message is specified
by the <code class="docutils literal notranslate"><span class="pre">-m</span></code> or <code class="docutils literal notranslate"><span class="pre">--message</span></code> option. You can enter a multi-line commit
message; in most shells you can enter this just by leaving the quotes open
at the end of the line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;added my first file&quot;</span>
</pre></div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">-F</span></code> option to take the message from a file.  Some
people like to make notes for a commit message while they work, then
review the diff to make sure they did what they said they did.  (This file
can also be useful when you pick up your work after a break.)</p>
</div>
<div class="section" id="message-from-an-editor">
<h4>Message from an editor<a class="headerlink" href="#message-from-an-editor" title="Permalink to this headline">¶</a></h4>
<p>If you use neither the <code class="docutils literal notranslate"><span class="pre">-m</span></code> nor the <code class="docutils literal notranslate"><span class="pre">-F</span></code> option then brz will open an
editor for you to enter a message.  The editor to run is controlled by
your <code class="docutils literal notranslate"><span class="pre">$VISUAL</span></code> or <code class="docutils literal notranslate"><span class="pre">$EDITOR</span></code> environment variable, which can be overridden
by the <code class="docutils literal notranslate"><span class="pre">editor</span></code> setting in <code class="docutils literal notranslate"><span class="pre">~/.config/breezy/breezy.conf</span></code>; <code class="docutils literal notranslate"><span class="pre">$BZR_EDITOR</span></code>
will override either of the above mentioned editor options.  If you quit the
editor without making any changes, the commit will be cancelled.</p>
<p>The file that is opened in the editor contains a horizontal line. The part
of the file below this line is included for information only, and will not
form part of the commit message. Below the separator is shown the list of
files that are changed in the commit. You should write your message above
the line, and then save the file and exit.</p>
<p>If you would like to see the diff that will be committed as you edit the
message you can use the <code class="docutils literal notranslate"><span class="pre">--show-diff</span></code> option to <code class="docutils literal notranslate"><span class="pre">commit</span></code>. This will include
the diff in the editor when it is opened, below the separator and the
information about the files that will be committed. This means that you can
read it as you write the message, but the diff itself wont be seen in the
commit message when you have finished. If you would like parts to be
included in the message you can copy and paste them above the separator.</p>
</div>
<div class="section" id="selective-commit">
<h4>Selective commit<a class="headerlink" href="#selective-commit" title="Permalink to this headline">¶</a></h4>
<p>If you give file or directory names on the commit command line then only
the changes to those files will be committed.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;documentation fix&quot;</span> <span class="n">commit</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>By default brz always commits all changes to the tree, even if run from a
subdirectory.  To commit from only the current directory down, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span> <span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="giving-credit-for-a-change">
<h4>Giving credit for a change<a class="headerlink" href="#giving-credit-for-a-change" title="Permalink to this headline">¶</a></h4>
<p>If you didn’t actually write the changes that you are about to commit, for instance
if you are applying a patch from someone else, you can use the <code class="docutils literal notranslate"><span class="pre">--author</span></code> commit
option to give them credit for the change:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span> <span class="o">--</span><span class="n">author</span> <span class="s2">&quot;Jane Rey &lt;jrey@example.com&gt;&quot;</span>
</pre></div>
</div>
<p>The person that you specify there will be recorded as the “author” of the revision,
and you will be recorded as the “committer” of the revision.</p>
<p>If more than one person works on the changes for a revision, for instance if you
are pair-programming, then you can record this by specifying <code class="docutils literal notranslate"><span class="pre">--author</span></code> multiple
times:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span> <span class="o">--</span><span class="n">author</span> <span class="s2">&quot;Jane Rey &lt;jrey@example.com&gt;&quot;</span> \
    <span class="o">--</span><span class="n">author</span> <span class="s2">&quot;John Doe &lt;jdoe@example.com&gt;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="browsing-history">
<h3><a class="toc-backref" href="#id63">Browsing history</a><a class="headerlink" href="#browsing-history" title="Permalink to this headline">¶</a></h3>
<div class="section" id="brz-log">
<h4>brz log<a class="headerlink" href="#brz-log" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">log</span></code> command shows a list of previous revisions.</p>
<p>As with <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">diff</span></code>, <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">log</span></code> supports the <code class="docutils literal notranslate"><span class="pre">-r</span></code> argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">log</span> <span class="o">-</span><span class="n">r</span> <span class="mf">1000.</span><span class="o">.</span>          <span class="c1"># Revision 1000 and everything after it</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">log</span> <span class="o">-</span><span class="n">r</span> <span class="o">..</span><span class="mi">1000</span>          <span class="c1"># Everything up to and including r1000</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">log</span> <span class="o">-</span><span class="n">r</span> <span class="mf">1000.</span><span class="o">.</span><span class="mi">1100</span>      <span class="c1"># changes from 1000 to 1100</span>
<span class="o">%</span> <span class="n">brz</span> <span class="n">log</span> <span class="o">-</span><span class="n">r</span> <span class="mi">1000</span>            <span class="c1"># The changes in only revision 1000</span>
</pre></div>
</div>
</div>
<div class="section" id="viewing-merged-revisions">
<h4>Viewing merged revisions<a class="headerlink" href="#viewing-merged-revisions" title="Permalink to this headline">¶</a></h4>
<p>As distributed VCS tools like Breezy make merging much easier than
it is in central VCS tools, the history of a branch may often contain
lines of development splitting off the mainline and merging back
in at a later time. Technically, the relationship between the
numerous revision nodes is known as a Directed Acyclic Graph or
DAG for short.</p>
<p>In many cases, you typically want to see the mainline first and drill
down from there. The default behaviour of log is therefore to show
the mainline and indicate which revisions have nested merged revisions.
To explore the merged revisions for revision X, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="o">-</span><span class="n">n0</span> <span class="o">-</span><span class="n">rX</span>
</pre></div>
</div>
<p>To see all revisions and all their merged revisions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="o">-</span><span class="n">n0</span>
</pre></div>
</div>
<p>Note that the -n option is used to indicate the number of levels to display
where 0 means all. If that is too noisy, you can easily adjust the number
to only view down so far. For example, if your project is structured with
a top level gatekeeper merging changes from team gatekeepers, <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">log</span></code>
shows what the top level gatekeeper did while <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">log</span> <span class="pre">-n2</span></code> shows what
the team gatekeepers did. In the vast majority of cases though, <code class="docutils literal notranslate"><span class="pre">-n0</span></code>
is fine.</p>
</div>
<div class="section" id="tuning-the-output">
<h4>Tuning the output<a class="headerlink" href="#tuning-the-output" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">log</span></code> command has several options that are useful for tuning
the output. These include:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">--forward</span></code> presents the log in chronological order, i.e. the
most recent revisions are displayed last.</li>
<li>the <code class="docutils literal notranslate"><span class="pre">--limit</span></code> option controls the maximum number of revisions displayed.</li>
</ul>
</div></blockquote>
<p>See the online help for the log command or the User Reference for more
information on tuning the output.</p>
</div>
<div class="section" id="viewing-the-history-for-a-file">
<h4>Viewing the history for a file<a class="headerlink" href="#viewing-the-history-for-a-file" title="Permalink to this headline">¶</a></h4>
<p>It is often useful to filter the history so that it only
applies to a given file. To do this, provide the filename
to the <code class="docutils literal notranslate"><span class="pre">log</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">foo</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="viewing-an-old-version-of-a-file">
<h4>Viewing an old version of a file<a class="headerlink" href="#viewing-an-old-version-of-a-file" title="Permalink to this headline">¶</a></h4>
<p>To get the contents of a file at a given version, use the
<code class="docutils literal notranslate"><span class="pre">cat</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">cat</span> <span class="o">-</span><span class="n">r</span> <span class="n">X</span> <span class="n">file</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the revision identifier and <code class="docutils literal notranslate"><span class="pre">file</span></code> is
the filename. This will send output to the standard output
stream so you’ll typically want to pipe the output through
a viewing tool (like <code class="docutils literal notranslate"><span class="pre">less</span></code> or <code class="docutils literal notranslate"><span class="pre">more</span></code>) or redirect it
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">cat</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="mi">2</span> <span class="n">foo</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">less</span>
<span class="n">brz</span> <span class="n">cat</span> <span class="o">-</span><span class="n">r</span> <span class="mi">1</span> <span class="n">foo</span><span class="o">.</span><span class="n">py</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">foo</span><span class="o">-</span><span class="mi">1</span><span class="n">st</span><span class="o">-</span><span class="n">version</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="graphical-history-viewers">
<h4>Graphical history viewers<a class="headerlink" href="#graphical-history-viewers" title="Permalink to this headline">¶</a></h4>
<p>History browsing is one area where GUI tools really make life easier.
Breezy has numerous plug-ins that provide this capability including
QBzr and brz-gtk. See <a class="reference external" href="plugins.html">Using plugins</a> for details on how to install
these if they are not already installed.</p>
<p>To use the graphical viewer from QBzr:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">qlog</span>
</pre></div>
</div>
<p>To use the graphical viewer from brz-gtk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">viz</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">viz</span></code> is actually a built-in alias for <code class="docutils literal notranslate"><span class="pre">visualize</span></code> so use the longer
command name if you prefer.</p>
</div>
</div>
<div class="section" id="releasing-a-project">
<h3><a class="toc-backref" href="#id64">Releasing a project</a><a class="headerlink" href="#releasing-a-project" title="Permalink to this headline">¶</a></h3>
<div class="section" id="packaging-a-release">
<h4>Packaging a release<a class="headerlink" href="#packaging-a-release" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">export</span></code> command is used to package a release, i.e. to
take a copy of the files and directories in a branch and
package them into a fresh directory or archive. For example,
this command will package the last committed version into
a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> archive file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">export</span> <span class="o">../</span><span class="n">releases</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">stuff</span><span class="o">-</span><span class="mf">1.5</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">export</span></code> command uses the suffix of the archive file
to work out the type of archive to create as shown below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Supported formats</th>
<th class="head">Autodetected by extension</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>dir</td>
<td>(none)</td>
</tr>
<tr class="row-odd"><td>tar</td>
<td>.tar</td>
</tr>
<tr class="row-even"><td>tbz2</td>
<td>.tar.bz2, .tbz2</td>
</tr>
<tr class="row-odd"><td>tgz</td>
<td>.tar.gz, .tgz</td>
</tr>
<tr class="row-even"><td>zip</td>
<td>.zip</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>If you wish to package a revision other than the last one, use
the <code class="docutils literal notranslate"><span class="pre">-r</span></code> option. If you wish to tune the root directory inside
the archive, use the <code class="docutils literal notranslate"><span class="pre">--root</span></code> option. See the online help or
User Reference for further details on the options supported by
<code class="docutils literal notranslate"><span class="pre">export</span></code>.</p>
</div>
<div class="section" id="tagging-a-release">
<h4>Tagging a release<a class="headerlink" href="#tagging-a-release" title="Permalink to this headline">¶</a></h4>
<p>Rather than remembering which version was used to package a release,
it’s useful to define a symbolic name for a version using the <code class="docutils literal notranslate"><span class="pre">tag</span></code>
command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">tag</span> <span class="n">version</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span>
</pre></div>
</div>
<p>That tag can be used later whenever a revision identifier is
required, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">diff</span> <span class="o">-</span><span class="n">r</span> <span class="n">tag</span><span class="p">:</span><span class="n">version</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span>
</pre></div>
</div>
<p>To see the list of tags defined in a branch, use the <code class="docutils literal notranslate"><span class="pre">tags</span></code> command.</p>
</div>
</div>
<div class="section" id="undoing-mistakes">
<h3><a class="toc-backref" href="#id65">Undoing mistakes</a><a class="headerlink" href="#undoing-mistakes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="mistakes-happen">
<h4>Mistakes happen<a class="headerlink" href="#mistakes-happen" title="Permalink to this headline">¶</a></h4>
<p>Breezy has been designed to make it easy to
recover from mistakes as explained below.</p>
</div>
<div class="section" id="dropping-the-revision-history-for-a-project">
<h4>Dropping the revision history for a project<a class="headerlink" href="#dropping-the-revision-history-for-a-project" title="Permalink to this headline">¶</a></h4>
<p>If you accidentally put the wrong tree under version control, simply
delete the <code class="docutils literal notranslate"><span class="pre">.brz</span></code> directory.</p>
</div>
<div class="section" id="deregistering-a-file-or-directory">
<h4>Deregistering a file or directory<a class="headerlink" href="#deregistering-a-file-or-directory" title="Permalink to this headline">¶</a></h4>
<p>If you accidentally register a file using <code class="docutils literal notranslate"><span class="pre">add</span></code> that you
don’t want version controlled, you can use the <code class="docutils literal notranslate"><span class="pre">remove</span></code>
command to tell Breezy to forget about it.</p>
<p><code class="docutils literal notranslate"><span class="pre">remove</span></code> has been designed to <em>Do the Safe Thing</em> in
that it will not delete a modified file. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">add</span> <span class="n">foo</span><span class="o">.</span><span class="n">html</span>
<span class="p">(</span><span class="n">oops</span> <span class="o">-</span> <span class="n">didn</span><span class="s1">&#39;t mean that)</span>
<span class="n">brz</span> <span class="n">remove</span> <span class="n">foo</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>This will complain about the file being modified or unknown.
If you want to keep the file, use the <code class="docutils literal notranslate"><span class="pre">--keep</span></code> option.
Alternatively, if you want to delete the file, use the <code class="docutils literal notranslate"><span class="pre">--force</span></code> option.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">add</span> <span class="n">foo</span><span class="o">.</span><span class="n">html</span>
<span class="p">(</span><span class="n">oops</span> <span class="o">-</span> <span class="n">didn</span><span class="s1">&#39;t mean that)</span>
<span class="n">brz</span> <span class="n">remove</span> <span class="o">--</span><span class="n">keep</span> <span class="n">foo</span><span class="o">.</span><span class="n">html</span>
<span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">html</span> <span class="n">left</span> <span class="n">on</span> <span class="n">disk</span><span class="p">,</span> <span class="n">but</span> <span class="n">deregistered</span><span class="p">)</span>
</pre></div>
</div>
<p>On the other hand, the unchanged <code class="docutils literal notranslate"><span class="pre">TODO</span></code> file is deregistered and
removed from disk without complaint in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">add</span> <span class="n">TODO</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;added TODO&quot;</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span> <span class="o">-</span> <span class="n">but</span> <span class="n">don</span><span class="s1">&#39;t change TODO)</span>
<span class="n">brz</span> <span class="n">remove</span> <span class="n">TODO</span>
<span class="p">(</span><span class="n">TODO</span> <span class="n">file</span> <span class="n">deleted</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: If you delete a file using your file manager, IDE or via an operating
system command, the <code class="docutils literal notranslate"><span class="pre">commit</span></code> command will implicitly treat it as removed.</p>
</div>
<div class="section" id="undoing-changes-since-the-last-commit">
<h4>Undoing changes since the last commit<a class="headerlink" href="#undoing-changes-since-the-last-commit" title="Permalink to this headline">¶</a></h4>
<p>One of the reasons for using a version control tool is that it
lets you easily checkpoint good tree states while working. If you
decide that the changes you have made since the last <code class="docutils literal notranslate"><span class="pre">commit</span></code> ought
to be thrown away, the command to use is <code class="docutils literal notranslate"><span class="pre">revert</span></code> like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">revert</span>
</pre></div>
</div>
<p>As a precaution, it is good practice to use <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">status</span></code> and
<code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">diff</span></code> first to check that everything being thrown away
really ought to be.</p>
</div>
<div class="section" id="undoing-changes-to-a-file-since-the-last-commit">
<h4>Undoing changes to a file since the last commit<a class="headerlink" href="#undoing-changes-to-a-file-since-the-last-commit" title="Permalink to this headline">¶</a></h4>
<p>If you want to undo changes to a particular file since the last commit but
keep all the other changes in the tree, pass the filename as an argument
to <code class="docutils literal notranslate"><span class="pre">revert</span></code> like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">revert</span> <span class="n">foo</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="undoing-the-last-commit">
<h4>Undoing the last commit<a class="headerlink" href="#undoing-the-last-commit" title="Permalink to this headline">¶</a></h4>
<p>If you make a commit and really didn’t mean to, use the <code class="docutils literal notranslate"><span class="pre">uncommit</span></code> command
to undo it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">uncommit</span>
</pre></div>
</div>
<p>Unlike <code class="docutils literal notranslate"><span class="pre">revert</span></code>, <code class="docutils literal notranslate"><span class="pre">uncommit</span></code> leaves the content of your working tree
exactly as it is. That’s really handy if you make a commit and accidently
provide the wrong error message. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Fix bug #11&quot;</span>
<span class="p">(</span><span class="n">damn</span> <span class="o">-</span> <span class="n">wrong</span> <span class="n">bug</span> <span class="n">number</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">uncommit</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Fix bug #1&quot;</span>
</pre></div>
</div>
<p>Another common reason for undoing a commit is because you forgot to add
one or more files. Some users like to alias <code class="docutils literal notranslate"><span class="pre">commit</span></code> to <code class="docutils literal notranslate"><span class="pre">commit</span> <span class="pre">--strict</span></code>
so that commits fail if unknown files are found in the tree.</p>
<p>Tags for uncommitted revisions are removed from the branch unless
<code class="docutils literal notranslate"><span class="pre">--keep-tags</span></code> was specified.</p>
<p>Note: While the <code class="docutils literal notranslate"><span class="pre">merge</span></code> command is not introduced until the next
chapter, it is worth noting now that <code class="docutils literal notranslate"><span class="pre">uncommit</span></code> restores any pending
merges. (Running <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">status</span></code> after <code class="docutils literal notranslate"><span class="pre">uncommit</span></code> will show these.)
<code class="docutils literal notranslate"><span class="pre">merge</span></code> can also be used to effectively undo just a selected commit
earlier in history. For more information on <code class="docutils literal notranslate"><span class="pre">merge</span></code>, see
<a class="reference external" href="merging_changes.html">Merging changes</a> in the next chapter and the
Breezy User Reference.</p>
</div>
<div class="section" id="undoing-multiple-commits">
<h4>Undoing multiple commits<a class="headerlink" href="#undoing-multiple-commits" title="Permalink to this headline">¶</a></h4>
<p>You can use the -r option to undo several commits like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">uncommit</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="mi">3</span>
</pre></div>
</div>
<p>If your reason for doing this is that you really want to
back out several changes, then be sure to remember that <code class="docutils literal notranslate"><span class="pre">uncommit</span></code>
does not change your working tree: you’ll probably need to run the
<code class="docutils literal notranslate"><span class="pre">revert</span></code> command as well to complete the task. In many cases though,
it’s arguably better to leave your history alone and add a new
revision reflecting the content of the last good state.</p>
</div>
<div class="section" id="reverting-to-the-state-of-an-earlier-version">
<h4>Reverting to the state of an earlier version<a class="headerlink" href="#reverting-to-the-state-of-an-earlier-version" title="Permalink to this headline">¶</a></h4>
<p>If you make an unwanted change but it doesn’t make sense to uncommit
it (because that code has been released to users say), you can use
<code class="docutils literal notranslate"><span class="pre">revert</span></code> to take your working tree back to the desired state.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">commit</span> <span class="s2">&quot;Fix bug #5&quot;</span>
<span class="n">Committed</span> <span class="n">revision</span> <span class="mf">20.</span>
<span class="p">(</span><span class="n">release</span> <span class="n">the</span> <span class="n">code</span><span class="p">)</span>
<span class="p">(</span><span class="n">hmm</span> <span class="o">-</span> <span class="n">bad</span> <span class="n">fix</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">revert</span> <span class="o">-</span><span class="n">r</span> <span class="mi">19</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Backout fix for bug #5&quot;</span>
</pre></div>
</div>
<p>This will change your entire tree back to the state as of revision 19,
which is probably only what you want if you haven’t made any new commits
since then. If you have, the <code class="docutils literal notranslate"><span class="pre">revert</span></code> would wipe them out as well. In that
case, you probably want to use <a class="reference external" href="adv_merging.html#reverse-cherrypicking">Reverse cherrypicking</a> instead to
back out the bad fix.</p>
<p>Note: As an alternative to using an absolute revision number (like 19), you can
specify one relative to the tip (-1) using a negative number like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">revert</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="correcting-a-tag">
<h4>Correcting a tag<a class="headerlink" href="#correcting-a-tag" title="Permalink to this headline">¶</a></h4>
<p>If you have defined a tag prematurely, use the <code class="docutils literal notranslate"><span class="pre">--force</span></code> option of
the <code class="docutils literal notranslate"><span class="pre">tag</span></code> command to redefine it. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">tag</span> <span class="mf">2.0</span><span class="o">-</span><span class="n">beta</span><span class="o">-</span><span class="mi">1</span>
<span class="p">(</span><span class="n">oops</span><span class="p">,</span> <span class="n">we</span><span class="s1">&#39;re not yet ready for that)</span>
<span class="p">(</span><span class="n">make</span> <span class="n">more</span> <span class="n">commits</span> <span class="n">to</span> <span class="n">include</span> <span class="n">more</span> <span class="n">fixes</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">tag</span> <span class="mf">2.0</span><span class="o">-</span><span class="n">beta</span><span class="o">-</span><span class="mi">1</span> <span class="o">--</span><span class="n">force</span>
</pre></div>
</div>
</div>
<div class="section" id="clearing-a-tag">
<h4>Clearing a tag<a class="headerlink" href="#clearing-a-tag" title="Permalink to this headline">¶</a></h4>
<p>If you have defined a tag and no longer want it defined, use the
<code class="docutils literal notranslate"><span class="pre">--delete</span></code> option of the <code class="docutils literal notranslate"><span class="pre">tag</span></code> command to remove it. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">tag</span> <span class="mf">2.0</span><span class="o">-</span><span class="n">beta</span><span class="o">-</span><span class="mi">4</span>
<span class="p">(</span><span class="n">oops</span><span class="p">,</span> <span class="n">we</span><span class="s1">&#39;re not releasing a 4th beta)</span>
<span class="n">brz</span> <span class="n">tag</span> <span class="mf">2.0</span><span class="o">-</span><span class="n">beta</span><span class="o">-</span><span class="mi">4</span> <span class="o">--</span><span class="n">delete</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sharing-with-peers">
<h2><a class="toc-backref" href="#id66">Sharing with peers</a><a class="headerlink" href="#sharing-with-peers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="working-with-another">
<h3><a class="toc-backref" href="#id67">Working with another</a><a class="headerlink" href="#working-with-another" title="Permalink to this headline">¶</a></h3>
<div class="section" id="peer-to-peer-rocks">
<h4>Peer-to-peer rocks<a class="headerlink" href="#peer-to-peer-rocks" title="Permalink to this headline">¶</a></h4>
<p>In many cases, two minds can be better than one. You may be the one
who started a project and someone wishes to help, or perhaps it’s you
who wants to help another. Perhaps you are both members of a larger
team that have been assigned a task together as pair programmers.
Either way, two people need to agree on a process, a set of
guidelines and a toolset in order to work together effectively.</p>
<p>Imagine if you were not allowed to call someone on the phone directly
and the only way to talk to them was by registering a conference call first?
Companies and communities that only share code via a central VCS
repository are living with a similar straitjacket to that every day.
There are times when central control makes a lot of sense and times
when peer-to-peer rocks. Either way, Breezy is designed to help.</p>
</div>
<div class="section" id="the-partner-workflow">
<h4>The partner workflow<a class="headerlink" href="#the-partner-workflow" title="Permalink to this headline">¶</a></h4>
<p>While it’s certainly not the only way to do it, the <em>partner workflow</em>
below is a good starting point for a pair of people who wish to
collaborate using Breezy.</p>
<img alt="../_images/workflows_peer.png" src="../_images/workflows_peer.png" />
<p>Over and above the tasks covered in the previous chapter, this
chapter introduces two essential collaboration activities:</p>
<blockquote>
<div><ul class="simple">
<li>getting a copy of a branch</li>
<li>merging changes between branches.</li>
</ul>
</div></blockquote>
<p>Even when it’s just you working on a code base, it can be very useful
to keep multiple branches around (for different releases say) and
to merge changes between them as appropriate. Your “partner” may indeed
be yourself.</p>
</div>
</div>
<div class="section" id="branching-a-project">
<h3><a class="toc-backref" href="#id68">Branching a project</a><a class="headerlink" href="#branching-a-project" title="Permalink to this headline">¶</a></h3>
<div class="section" id="branch-urls">
<h4>Branch URLs<a class="headerlink" href="#branch-urls" title="Permalink to this headline">¶</a></h4>
<p>Before someone else can get a copy of your work, you need to
agree on a transfer technology.
You may decide to make the top level directory of your branch
a network share, an approach familiar to Windows users.
Unix users might prefer access to be
via SSH, a secure protocol built-in to most SSH servers.
Breezy is <em>very</em> flexible in this regard with support for
lots of protocols some of which are given below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Prefix</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>file://</td>
<td>Access using the standard filesystem (default).</td>
</tr>
<tr class="row-odd"><td>bzr+ssh:/</td>
<td>Access over SSH (best remote option).</td>
</tr>
<tr class="row-even"><td>sftp://</td>
<td>Access using SFTP (most SSH servers provide SFTP).</td>
</tr>
<tr class="row-odd"><td>bzr://</td>
<td>Fast access using the Breezy smart server.</td>
</tr>
<tr class="row-even"><td>ftp://</td>
<td>Access using passive FTP.</td>
</tr>
<tr class="row-odd"><td>http://</td>
<td>Access to branches exported by a web server.</td>
</tr>
<tr class="row-even"><td>https://</td>
<td>Encrypted access to branches exported by a web server.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>As indicated above, branches are identified using URLs with the
prefix indicating the transfer technology. If no prefix is given,
normal filenames are assumed. For a complete list of supported
protocols, see the <code class="docutils literal notranslate"><span class="pre">urlspec</span></code> online help topic or the
<a class="reference external" href="../user-reference/index.html#url-identifiers">URL Identifiers</a>
section of the Breezy User Reference.</p>
<p>URLs are normally resolved relative to the root directory of the server,
so <code class="docutils literal notranslate"><span class="pre">ftp://example.com/repo/foo</span></code> means the <code class="docutils literal notranslate"><span class="pre">/repo/foo</span></code> directory of
that host.  (We say ‘normally’ because some server software like Apache
can be configured to remap URLs arbitrarily, in which case you’ll need to
look at the server configuration to find out which URL corresponds to
which directory.)</p>
<p>To address a path relative to your home directory on the server, use a
tilde like so: <code class="docutils literal notranslate"><span class="pre">bzr+ssh://example.com/~/public_html</span></code> should map to
<code class="docutils literal notranslate"><span class="pre">public_html</span></code> within your home directory.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Access over HTTP or HTTPS is read-only by default.
See <a class="reference external" href="http_smart_server.html#pushing-over-the-http-smart-server">Pushing over the HTTP smart server</a> for
details on configuring read-write access.</p>
</div>
</div>
<div class="section" id="a-reminder-about-shared-repositories">
<h4>A reminder about shared repositories<a class="headerlink" href="#a-reminder-about-shared-repositories" title="Permalink to this headline">¶</a></h4>
<p>Before getting a copy of a branch, have a quick think about
where to put it on your filesystem. For maximum storage
efficiency down the track, it is recommended that branches
be created somewhere under a directory that has been set up
as a shared repository. (See <a class="reference external" href="organizing_your_workspace.html#feature-branches">Feature branches</a> in
<a class="reference external" href="organizing_your_workspace.html">Organizing your workspace</a>
for a commonly used layout.) For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">my</span><span class="o">-</span><span class="n">repo</span>
<span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">repo</span>
</pre></div>
</div>
<p>You are now ready to grab a branch from someone else and
hack away.</p>
</div>
<div class="section" id="the-branch-command">
<h4>The branch command<a class="headerlink" href="#the-branch-command" title="Permalink to this headline">¶</a></h4>
<p>To get a branch based on an existing branch, use the <code class="docutils literal notranslate"><span class="pre">branch</span></code> command.
The syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">URL</span> <span class="p">[</span><span class="n">directory</span><span class="p">]</span>
</pre></div>
</div>
<p>If a directory is not given, one is created based on the last part of
the URL. Here are some examples showing a drive qualified path (M:/) and an
SFTP URL respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">M</span><span class="p">:</span><span class="o">/</span><span class="n">cool</span><span class="o">-</span><span class="n">trunk</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">sftp</span><span class="p">:</span><span class="o">//</span><span class="n">bill</span><span class="nd">@mary</span><span class="o">-</span><span class="n">laptop</span><span class="o">/</span><span class="n">cool</span><span class="o">-</span><span class="n">repo</span><span class="o">/</span><span class="n">cool</span><span class="o">-</span><span class="n">trunk</span>
</pre></div>
</div>
<p>This example shows explicitly giving the directory name to use for the
new branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mary</span><span class="o">/</span><span class="n">cool</span><span class="o">-</span><span class="n">repo</span><span class="o">/</span><span class="n">cool</span><span class="o">-</span><span class="n">trunk</span> <span class="n">cool</span>
</pre></div>
</div>
</div>
<div class="section" id="time-and-space-considerations">
<h4>Time and space considerations<a class="headerlink" href="#time-and-space-considerations" title="Permalink to this headline">¶</a></h4>
<p>Depending on the size of the branch being transferred and the
speed and latency of the network between your computer and the
source branch, this initial transfer might take some time.
Subsequent updates should be much faster as only the
changes are transferred then.</p>
<p>Keep in mind that Breezy is transferring the
complete history of the branch, not just the latest snapshot.
As a consequence, you can be off the network (or disconnected
from the network share) after <code class="docutils literal notranslate"><span class="pre">branch</span></code> completes but you’ll
still be able to <code class="docutils literal notranslate"><span class="pre">log</span></code> and <code class="docutils literal notranslate"><span class="pre">diff</span></code> the history of the
branch as much as you want. Furthermore, these operations
are quick as the history is stored locally.</p>
<p>Note that Breezy uses smart compression technology to
minimize the amount of disk space required to store version
history. In many cases, the complete history of a project
will take up less disk space than the working copy of
the latest version.</p>
<p>As explained in later chapters, Breezy also has support for
<a class="reference external" href="using_checkouts.html#getting-a-lightweight-checkout">lightweight checkouts</a>
of a branch, i.e. working trees with
no local storage of history. Of course, disconnected usage
is not available then but that’s a tradeoff you can decide
to make if local disk space is really tight for you. Support for
limited lookback into history - <em>history horizons</em> - is
currently under development as well.</p>
</div>
<div class="section" id="viewing-branch-information">
<h4>Viewing branch information<a class="headerlink" href="#viewing-branch-information" title="Permalink to this headline">¶</a></h4>
<p>If you wish to see information about a branch including where it came from,
use the <code class="docutils literal notranslate"><span class="pre">info</span></code> command. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">info</span> <span class="n">cool</span>
</pre></div>
</div>
<p>If no branch is given, information on the current branch is displayed.</p>
</div>
</div>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id69">Merging changes</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<div class="section" id="parallel-development">
<h4>Parallel development<a class="headerlink" href="#parallel-development" title="Permalink to this headline">¶</a></h4>
<p>Once someone has their own branch of a project, they can make
and commit changes in parallel to any development proceeding
on the original branch. Pretty soon though, these independent
lines of development will need to be combined again. This
process is known as <em>merging</em>.</p>
</div>
<div class="section" id="the-merge-command">
<h4>The merge command<a class="headerlink" href="#the-merge-command" title="Permalink to this headline">¶</a></h4>
<p>To incorporate changes from another branch, use the <code class="docutils literal notranslate"><span class="pre">merge</span></code> command.
Its syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span> <span class="p">[</span><span class="n">URL</span><span class="p">]</span>
</pre></div>
</div>
<p>If no URL is given, a default is used, initially the branch this branch
originated from.
For example, if Bill made a branch from Mary’s work, he can merge her
subsequent changes by simply typing this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span>
</pre></div>
</div>
<p>On the other hand, Mary might want to merge into her branch the work Bill
has done in his. In this case, she needs to explicitly give the URL the
first time, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">mary</span><span class="nd">@bill</span><span class="o">-</span><span class="n">laptop</span><span class="o">/</span><span class="n">cool</span><span class="o">-</span><span class="n">repo</span><span class="o">/</span><span class="n">cool</span><span class="o">-</span><span class="n">trunk</span>
</pre></div>
</div>
<p>This sets the default merge branch if one is not already set.  Use
<code class="docutils literal notranslate"><span class="pre">--no-remember</span></code> to avoid setting it. To change the default after it is set,
use the <code class="docutils literal notranslate"><span class="pre">--remember</span></code> option.</p>
</div>
<div class="section" id="how-does-merging-work">
<h4>How does merging work?<a class="headerlink" href="#how-does-merging-work" title="Permalink to this headline">¶</a></h4>
<p>A variety of algorithms exist for merging changes. Breezy’s
default algorithm is a variation of <em>3-way merging</em> which
works as follows. Given an ancestor A and two branches B and C,
the following table provides the rules used.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="19%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">A</th>
<th class="head">B</th>
<th class="head">C</th>
<th class="head">Result</th>
<th class="head">Comment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>unchanged</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>x</td>
<td>y</td>
<td>y</td>
<td>line from C</td>
</tr>
<tr class="row-even"><td>x</td>
<td>y</td>
<td>x</td>
<td>y</td>
<td>line from B</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>y</td>
<td>z</td>
<td>?</td>
<td>conflict</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Note that some merges can only be completed with the assistance
of a human. Details on how to resolve these are given in
<a class="reference external" href="resolving_conflicts.html">Resolving conflicts</a>.</p>
</div>
<div class="section" id="recording-a-merge">
<h4>Recording a merge<a class="headerlink" href="#recording-a-merge" title="Permalink to this headline">¶</a></h4>
<p>After any conflicts are resolved, the merge needs to be committed.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Merged Mary&#39;s changes&quot;</span>
</pre></div>
</div>
<p>Even if there are no conflicts, an explicit commit is still required.
Unlike some other tools, this is considered a feature in Breezy.
A clean merge is not necessarily a good merge so making the commit
a separate explicit step allows you to run your test suite first to
verify all is good. If problems are found, you should correct them
before committing the merge or throw the merge away using <code class="docutils literal notranslate"><span class="pre">revert</span></code>.</p>
</div>
<div class="section" id="merge-tracking">
<h4>Merge tracking<a class="headerlink" href="#merge-tracking" title="Permalink to this headline">¶</a></h4>
<p>One of the most important features of Breezy is distributed,
high quality <em>merge tracking</em>.
In other words, Breezy remembers what has been merged already and
uses that information to intelligently choose the best ancestor for
a merge, minimizing the number and size of conflicts.</p>
<p>If you are a refugee from many other VCS tools, it can be really
hard to “unlearn” the <em>please-let-me-avoid-merging-at-any-cost</em> habit.
Breezy lets you safely merge as often as you like with other people.
By working in a peer-to-peer manner when it makes sense to do so, you
also avoid using a central branch as an “integration swamp”, keeping
its quality higher. When the change you’re collaborating on is
truly ready for wider sharing, that’s the time to merge and commit
it to a central branch, not before.</p>
<p>Merging that Just Works truly can change how developers work together.</p>
</div>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id70">Resolving conflicts</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<div class="section" id="workflow">
<h4>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h4>
<p>Unlike some other tools that force you to resolve each conflict during
the merge process, Breezy merges as much as it can and then reports the
conflicts. This can make conflict resolution easier because the contents
of the whole post-merge tree are available to help you decide how things
ought to be resolved. You may also wish to selectively run tests as you go
to confirm each resolution or group or resolutions is good.</p>
</div>
<div class="section" id="listing-conflicts">
<h4>Listing conflicts<a class="headerlink" href="#listing-conflicts" title="Permalink to this headline">¶</a></h4>
<p>As well as being reported by the <code class="docutils literal notranslate"><span class="pre">merge</span></code> command, the list of outstanding
conflicts may be displayed at any time by using the <code class="docutils literal notranslate"><span class="pre">conflicts</span></code>
command. It is also included as part of the output from the <code class="docutils literal notranslate"><span class="pre">status</span></code>
command.</p>
</div>
<div class="section" id="resolving-a-conflict">
<h4>Resolving a conflict<a class="headerlink" href="#resolving-a-conflict" title="Permalink to this headline">¶</a></h4>
<p>When a conflict is encountered, the <code class="docutils literal notranslate"><span class="pre">merge</span></code> command puts embedded
markers in each file showing the areas it couldn’t resolve. It also
creates 3 files for each file with a conflict:</p>
<blockquote>
<div><ul class="simple">
<li>foo.BASE</li>
<li>foo.THIS</li>
<li>foo.OTHER</li>
</ul>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">foo</span></code> is the name of the conflicted file.
In many cases, you can resolve conflicts by simply manually editing
each file in question, fixing the relevant areas and removing the
conflict markers as you go.</p>
<p>After fixing all the files in conflict, and removing the markers,
ask Breezy to mark them as resolved using the <code class="docutils literal notranslate"><span class="pre">resolve</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">resolve</span>
</pre></div>
</div>
<p>Alternatively, after fixing each file, you can mark it as resolved
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">resolve</span> <span class="n">foo</span>
</pre></div>
</div>
<p>Among other things, the <code class="docutils literal notranslate"><span class="pre">resolve</span></code> command cleans up the BASE,
THIS and OTHER files from your working tree.</p>
</div>
<div class="section" id="using-the-remerge-command">
<h4>Using the remerge command<a class="headerlink" href="#using-the-remerge-command" title="Permalink to this headline">¶</a></h4>
<p>In some cases, you may wish to try a different merge algorithm on a
given file. To do this, use the <code class="docutils literal notranslate"><span class="pre">remerge</span></code> command nominating
the file like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">remerge</span> <span class="o">--</span><span class="n">weave</span> <span class="n">foo</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">foo</span></code> is the file and <code class="docutils literal notranslate"><span class="pre">weave</span></code> is one of the available
merge algorithms. This algorithm is particularly useful when a
so-called <code class="docutils literal notranslate"><span class="pre">criss-cross</span></code> merge is detected, e.g. when two branches
merge the same thing then merge each other. See the online help for
<code class="docutils literal notranslate"><span class="pre">criss-cross</span></code> and <code class="docutils literal notranslate"><span class="pre">remerge</span></code> for further details.</p>
</div>
<div class="section" id="using-external-tools-to-resolve-conflicts">
<h4>Using external tools to resolve conflicts<a class="headerlink" href="#using-external-tools-to-resolve-conflicts" title="Permalink to this headline">¶</a></h4>
<p>If you have a GUI tool you like using to resolve conflicts, be sure
to install the <em>extmerge</em> plugin. Once installed, it can be used
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">extmerge</span> <span class="n">foo</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">foo</span></code> is the conflicted file. Rather than provide a list of
files to resolve, you can give the <code class="docutils literal notranslate"><span class="pre">--all</span></code> option to implicitly
specify all conflicted files.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">extmerge</span></code> command uses the tool specified by the
<code class="docutils literal notranslate"><span class="pre">external_merge</span></code> setting in your <code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> file.
If not set, it will look for some popular merge tools such
as <code class="docutils literal notranslate"><span class="pre">kdiff3</span></code> or <code class="docutils literal notranslate"><span class="pre">opendiff</span></code>, the latter being a command
line interface to the FileMerge utility in OS X.</p>
</div>
</div>
<div class="section" id="annotating-changes">
<h3><a class="toc-backref" href="#id71">Annotating changes</a><a class="headerlink" href="#annotating-changes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="seeing-the-origin-of-content">
<h4>Seeing the origin of content<a class="headerlink" href="#seeing-the-origin-of-content" title="Permalink to this headline">¶</a></h4>
<p>When two or more people are working on files, it can be highly
useful at times to see who created or last changed certain content.
To do this, using the annotate command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">annotate</span> <span class="n">readme</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>If you are a pessimist or an optimist, you might prefer to use
one of built-in aliases for <code class="docutils literal notranslate"><span class="pre">annotate</span></code>: <code class="docutils literal notranslate"><span class="pre">blame</span></code> or <code class="docutils literal notranslate"><span class="pre">praise</span></code>.
Either way, this displays each line of the file together with
information such as:</p>
<blockquote>
<div><ul class="simple">
<li>who changed it last</li>
<li>when it was last changed</li>
<li>the commit message.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="gui-tools">
<h4>GUI tools<a class="headerlink" href="#gui-tools" title="Permalink to this headline">¶</a></h4>
<p>The various GUI plugins for Breezy provide graphical tools for
viewing annotation information. For example, the brz-gtk plugin
provides a GUI tool for this that can be launched using the
<code class="docutils literal notranslate"><span class="pre">gannotate</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">gannotate</span> <span class="n">readme</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>The GUI tools typically provide a much richer display of
interesting information (e.g. all the changes in each commit)
so you may prefer them over the text-based command.</p>
</div>
</div>
</div>
<div class="section" id="team-collaboration-central-style">
<h2><a class="toc-backref" href="#id72">Team collaboration, central style</a><a class="headerlink" href="#team-collaboration-central-style" title="Permalink to this headline">¶</a></h2>
<div class="section" id="centralized-development">
<h3><a class="toc-backref" href="#id73">Centralized development</a><a class="headerlink" href="#centralized-development" title="Permalink to this headline">¶</a></h3>
<div class="section" id="motivation">
<h4>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h4>
<p>Rather than working in parallel and occasionally merging, it can be
useful at times to work in lockstep, i.e. for multiple people to
be continuously committing changes to a central location, merging
their work with the latest content before every commit.</p>
<p>This workflow is very familiar to users of central VCS tools like
Subversion and CVS. It is also applicable to a single developer
who works on multiple machines, e.g. someone who normally works
on a desktop computer but travels with a laptop, or someone who
uses their (Internet connected) home computer to complete office
work out of hours.</p>
<p>If centralized development works well for your team already, that’s
great. Many teams begin using Breezy this way and experiment with
alternative workflows later.</p>
</div>
<div class="section" id="centralized-workflow">
<h4>Centralized workflow<a class="headerlink" href="#centralized-workflow" title="Permalink to this headline">¶</a></h4>
<p>The diagram below provides an overview of the <em>centralized workflow</em>.</p>
<img alt="../_images/workflows_centralized.png" src="../_images/workflows_centralized.png" />
<p>Even if your team is planning to use a more distributed workflow, many
of the tasks covered in this chapter may be useful to you, particularly
how to publish branches.</p>
</div>
</div>
<div class="section" id="publishing-a-branch">
<span id="id11"></span><h3><a class="toc-backref" href="#id74">Publishing a branch</a><a class="headerlink" href="#publishing-a-branch" title="Permalink to this headline">¶</a></h3>
<div class="section" id="setting-up-a-central-repository">
<h4>Setting up a central repository<a class="headerlink" href="#setting-up-a-central-repository" title="Permalink to this headline">¶</a></h4>
<p>While the centralized workflow can be used by socially nominating
any branch on any computer as the central one, in practice most
teams have a dedicated server for hosting central branches.</p>
<p>Just as it’s best practice to use a shared repository locally,
it’s advisable to put central branches in a shared repository.
Note that central shared branches typically only want to
store history, not working copies of files, so their enclosing
repository is usually creating using the <code class="docutils literal notranslate"><span class="pre">no-trees</span></code> option, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">trees</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span>
</pre></div>
</div>
<p>You can think of this step as similar to setting up a new cvsroot or
Subversion repository. However, Breezy gives you more flexibility
in how branches may be organised in your repository. See
<a class="reference external" href="shared_repository_layouts.html">Advanced shared repository layouts</a>
in the appendices for guidelines and examples.</p>
</div>
<div class="section" id="starting-a-central-branch">
<h4>Starting a central branch<a class="headerlink" href="#starting-a-central-branch" title="Permalink to this headline">¶</a></h4>
<p>There are two ways of populating a central branch with some initial
content:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Making a local branch and pushing it to a central location</li>
<li>Making an empty central branch then committing content to it.</li>
</ol>
</div></blockquote>
<p>Here is an example of the first way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">PROJECT</span>  <span class="p">(</span><span class="n">prepare</span> <span class="n">local</span> <span class="n">repository</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">init</span> <span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
<span class="n">cd</span> <span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
                       <span class="p">(</span><span class="n">copy</span> <span class="n">development</span> <span class="n">files</span><span class="p">)</span>
<span class="n">cp</span> <span class="o">-</span><span class="n">ar</span> <span class="o">~/</span><span class="n">PROJECT</span> <span class="o">.</span>     <span class="p">(</span><span class="n">copy</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">using</span> <span class="n">OS</span><span class="o">-</span><span class="n">specific</span> <span class="n">tools</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">add</span>                <span class="p">(</span><span class="n">populate</span> <span class="n">repository</span><span class="p">;</span> <span class="n">start</span> <span class="n">version</span> <span class="n">control</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Initial import&quot;</span>
                       <span class="p">(</span><span class="n">publish</span> <span class="n">to</span> <span class="n">central</span> <span class="n">repository</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">push</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
</pre></div>
</div>
<p>Here is an example of the second way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">PROJECT</span>  <span class="p">(</span><span class="n">prepare</span> <span class="n">local</span> <span class="n">repository</span><span class="p">)</span>
<span class="n">cd</span> <span class="n">PROJECT</span>
<span class="n">brz</span> <span class="n">init</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
<span class="n">brz</span> <span class="n">checkout</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
<span class="n">cd</span> <span class="n">trunk</span>
<span class="n">cp</span> <span class="o">-</span><span class="n">ar</span> <span class="o">~/</span><span class="n">PROJECT</span> <span class="o">.</span>     <span class="p">(</span><span class="n">copy</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">using</span> <span class="n">OS</span><span class="o">-</span><span class="n">specific</span> <span class="n">tools</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">add</span>                <span class="p">(</span><span class="n">populate</span> <span class="n">repository</span><span class="p">;</span> <span class="n">start</span> <span class="n">version</span> <span class="n">control</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Initial import&quot;</span>
                       <span class="p">(</span><span class="n">publish</span> <span class="n">to</span> <span class="n">central</span> <span class="n">repository</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that committing inside a working tree created using
the <code class="docutils literal notranslate"><span class="pre">checkout</span></code> command implicitly commits the content to
the central location as well as locally. Had we used the
<code class="docutils literal notranslate"><span class="pre">branch</span></code> command instead of <code class="docutils literal notranslate"><span class="pre">checkout</span></code> above, the
content would have only been committed locally.</p>
<p>Working trees that are tightly bound to a central location
like this are called <em>checkouts</em>. The rest of this chapter
explains their numerous features in more detail.</p>
</div>
</div>
<div class="section" id="using-checkouts">
<h3><a class="toc-backref" href="#id75">Using checkouts</a><a class="headerlink" href="#using-checkouts" title="Permalink to this headline">¶</a></h3>
<div class="section" id="turning-a-branch-into-a-checkout">
<h4>Turning a branch into a checkout<a class="headerlink" href="#turning-a-branch-into-a-checkout" title="Permalink to this headline">¶</a></h4>
<p>If you have a local branch and wish to make it a checkout, use the
<code class="docutils literal notranslate"><span class="pre">bind</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">bind</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
</pre></div>
</div>
<p>This is necessary, for example, after creating a central branch using
<code class="docutils literal notranslate"><span class="pre">push</span></code> as illustrated in the previous section.</p>
<p>After this, commits will be applied to the bound branch before
being applied locally.</p>
</div>
<div class="section" id="turning-a-checkout-into-a-branch">
<h4>Turning a checkout into a branch<a class="headerlink" href="#turning-a-checkout-into-a-branch" title="Permalink to this headline">¶</a></h4>
<p>If you have a checkout and wish to make it a normal branch, use the
<code class="docutils literal notranslate"><span class="pre">unbind</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">unbind</span>
</pre></div>
</div>
<p>After this, commits will only be applied locally.</p>
</div>
<div class="section" id="getting-a-checkout">
<h4>Getting a checkout<a class="headerlink" href="#getting-a-checkout" title="Permalink to this headline">¶</a></h4>
<p>When working in a team using a central branch, one person needs
to provide some initial content as shown in the previous section.
After that, each person should use the <code class="docutils literal notranslate"><span class="pre">checkout</span></code> command to
create their local checkout, i.e. the sandbox in which they
will make their changes.</p>
<p>Unlike Subversion and CVS, in Breezy the <code class="docutils literal notranslate"><span class="pre">checkout</span></code> command creates a
local full copy of history in addition to creating a working tree holding
the latest content. This means that operations such as <code class="docutils literal notranslate"><span class="pre">diff</span></code> and <code class="docutils literal notranslate"><span class="pre">log</span></code>
are fast and can still be used when disconnected from the central location.</p>
</div>
<div class="section" id="getting-a-lightweight-checkout">
<h4>Getting a lightweight checkout<a class="headerlink" href="#getting-a-lightweight-checkout" title="Permalink to this headline">¶</a></h4>
<p>While Breezy does its best to efficiently store version history, there
are occasions when the history is simply not wanted. For example, if your
team is managing the content of a web site using Breezy with a
central repository, then your release process might be as simple as
updating a checkout of the content on the public web server. In this
case, you probably don’t want the history downloaded to that location
as doing so:</p>
<blockquote>
<div><ul class="simple">
<li>wastes disk space holding history that isn’t needed there</li>
<li>exposes a Breezy branch that you may want kept private.</li>
</ul>
</div></blockquote>
<p>To get a history-less checkout in Breezy, use the <code class="docutils literal notranslate"><span class="pre">--lightweight</span></code>
option like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">checkout</span> <span class="o">--</span><span class="n">lightweight</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
</pre></div>
</div>
<p>Of course, many of the benefits of a normal checkout are lost by doing
this but that’s a tradeoff you can make if and when it makes sense.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--lightweight</span></code> option only applies to checkouts, not to all branches.</p>
<p>Note: If your code base is really large and disk space on your computer
is limited, lightweight checkouts may be the right choice for you.
Be sure to consider all your options though including
<a class="reference external" href="branching_a_project.html#a-reminder-about-shared-repositories">shared repositories</a>,
<a class="reference external" href="stacked.html">stacked branches</a>, and
<a class="reference external" href="reusing_a_checkout.html">reusing a checkout</a>.</p>
</div>
<div class="section" id="updating-to-the-latest-content">
<h4>Updating to the latest content<a class="headerlink" href="#updating-to-the-latest-content" title="Permalink to this headline">¶</a></h4>
<p>One of the important aspects of working in lockstep with others is
keeping your checkout up to date with the latest changes made to
the central branch. Just as you would in Subversion or CVS, you do
this in Breezy by using the <code class="docutils literal notranslate"><span class="pre">update</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">update</span>
</pre></div>
</div>
<p>This gets any new revisions available in the bound branch and
merges your local changes, if any.</p>
</div>
<div class="section" id="handling-commit-failures">
<h4>Handling commit failures<a class="headerlink" href="#handling-commit-failures" title="Permalink to this headline">¶</a></h4>
<p>Note that your checkout <em>must</em> be up to date with the bound branch
before running <code class="docutils literal notranslate"><span class="pre">commit</span></code>. Breezy is actually stricter about this
than Subversion or CVS - you need to be up to date with the full
tree, not just for the files you’ve changed. Breezy will ask you
to run <code class="docutils literal notranslate"><span class="pre">update</span></code> if it detects that a revision has been added to
the central location since you last updated.</p>
<p>If the network connection to the bound branch is lost, the commit will
fail. Some alternative ways of working around that are outlined next.</p>
</div>
</div>
<div class="section" id="working-offline-on-a-central-branch">
<h3><a class="toc-backref" href="#id76">Working offline on a central branch</a><a class="headerlink" href="#working-offline-on-a-central-branch" title="Permalink to this headline">¶</a></h3>
<div class="section" id="the-centralized-with-local-commits-workflow">
<h4>The centralized with local commits workflow<a class="headerlink" href="#the-centralized-with-local-commits-workflow" title="Permalink to this headline">¶</a></h4>
<p>If you lose your network connection because you are travelling, the central
server goes down, or you simply want to snapshot changes locally without
publishing them centrally just yet, this workflow is for you.</p>
<img alt="../_images/workflows_localcommit.png" src="../_images/workflows_localcommit.png" />
</div>
<div class="section" id="committing-locally">
<h4>Committing locally<a class="headerlink" href="#committing-locally" title="Permalink to this headline">¶</a></h4>
<p>If you’re working in a checkout and need/wish to commit locally only,
add the <code class="docutils literal notranslate"><span class="pre">--local</span></code> option to the <code class="docutils literal notranslate"><span class="pre">commit</span></code> command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">commit</span> <span class="o">--</span><span class="n">local</span>
</pre></div>
</div>
</div>
<div class="section" id="being-disconnected-for-long-time-periods">
<h4>Being disconnected for long time periods<a class="headerlink" href="#being-disconnected-for-long-time-periods" title="Permalink to this headline">¶</a></h4>
<p>If you will be or want to be disconnected from the bound branch for
a while, then remembering to add <code class="docutils literal notranslate"><span class="pre">--local</span></code> to every <code class="docutils literal notranslate"><span class="pre">commit</span></code> command
can be annoying. An alternative is to use the <code class="docutils literal notranslate"><span class="pre">unbind</span></code> command to
make the checkout temporarily into a normal branch followed by the
<code class="docutils literal notranslate"><span class="pre">bind</span></code> command at some later point in time when you want to
keep in lockstep again.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">bind</span></code> command remembers where you were bound to
last time this branch was a checkout so it isn’t necessary to enter
the URL of the remote branch when you use <code class="docutils literal notranslate"><span class="pre">bind</span></code> after an earlier
<code class="docutils literal notranslate"><span class="pre">unbind</span></code>.</p>
</div>
<div class="section" id="merging-a-series-of-local-commits">
<h4>Merging a series of local commits<a class="headerlink" href="#merging-a-series-of-local-commits" title="Permalink to this headline">¶</a></h4>
<p>When you make commits locally independent of ongoing development
on a central branch, then Breezy treats these as two lines of
development next time you <code class="docutils literal notranslate"><span class="pre">update</span></code>. In this case, <code class="docutils literal notranslate"><span class="pre">update</span></code>
does the following:</p>
<blockquote>
<div><ul class="simple">
<li>it brings the latest revisions from the bound branch down and
makes that the mainline of development within your checkout</li>
<li>it moves your local changes since you last updated into a logical
parallel branch</li>
<li>it merges these together so that your local changes are reported
as a pending merge by <code class="docutils literal notranslate"><span class="pre">status</span></code>.</li>
</ul>
</div></blockquote>
<p>As always, you will need to run <code class="docutils literal notranslate"><span class="pre">commit</span></code> after this to send your
work to the central branch.</p>
</div>
</div>
<div class="section" id="id14">
<h3><a class="toc-backref" href="#id77">Reusing a checkout</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id15">
<h4>Motivation<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>At times, it can be useful to have a single checkout as your
sandbox for working on multiple branches. Some possible reasons
for this include:</p>
<blockquote>
<div><ul class="simple">
<li>saving disk space when the working tree is large</li>
<li>developing in a fixed location.</li>
</ul>
</div></blockquote>
<p>In many cases, working tree disk usage swamps the size of the
<code class="docutils literal notranslate"><span class="pre">.brz</span></code> directory. If you want to work on multiple branches
but can’t afford the overhead of a full working tree for each,
reusing a checkout across multiples branches is the way to go.</p>
<p>On other occasions, the location of your sandbox might be
configured into numerous development and testing tools. Once
again, reusing a checkout across multiple branches can help.</p>
</div>
<div class="section" id="changing-where-a-branch-is-bound-to">
<h4>Changing where a branch is bound to<a class="headerlink" href="#changing-where-a-branch-is-bound-to" title="Permalink to this headline">¶</a></h4>
<p>To change where a checkout is bound to, follow these steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Make sure that any local changes have been committed
centrally so that no work is lost.</li>
<li>Use the <code class="docutils literal notranslate"><span class="pre">bind</span></code> command giving the URL of the new
remote branch you wish to work on.</li>
<li>Make your checkout a copy of the desired branch by using
the <code class="docutils literal notranslate"><span class="pre">update</span></code> command followed by the <code class="docutils literal notranslate"><span class="pre">revert</span></code> command.</li>
</ol>
</div></blockquote>
<p>Note that simply binding to a new branch and running <code class="docutils literal notranslate"><span class="pre">update</span></code>
merges in your local changes, both committed and uncommitted. You need
to decide whether to keep them or not by running either <code class="docutils literal notranslate"><span class="pre">revert</span></code>
or <code class="docutils literal notranslate"><span class="pre">commit</span></code>.</p>
<p>An alternative to the bind+update recipe is using the <code class="docutils literal notranslate"><span class="pre">switch</span></code>
command. This is basically the same as removing the existing
branch and running <code class="docutils literal notranslate"><span class="pre">checkout</span></code> again on the new location, except
that any uncommitted changes in your tree are merged in.</p>
<p>Note: As <code class="docutils literal notranslate"><span class="pre">switch</span></code> can potentially throw away committed changes in
order to make a checkout an accurate cache of a different bound branch,
it will fail by design if there are changes which have been committed
locally but are not yet committed to the most recently bound branch.
To truly abandon these changes, use the <code class="docutils literal notranslate"><span class="pre">--force</span></code> option.</p>
</div>
<div class="section" id="switching-a-lightweight-checkout">
<h4>Switching a lightweight checkout<a class="headerlink" href="#switching-a-lightweight-checkout" title="Permalink to this headline">¶</a></h4>
<p>With a lightweight checkout, there are no local commits and <code class="docutils literal notranslate"><span class="pre">switch</span></code>
effectively changes which branch the working tree is associated with.
One possible setup is to use a lightweight checkout in combination
with a local tree-less repository. This lets you switch what you
are working on with ease. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">trees</span> <span class="n">PROJECT</span>
<span class="n">cd</span> <span class="n">PROJECT</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
<span class="n">brz</span> <span class="n">checkout</span> <span class="o">--</span><span class="n">lightweight</span> <span class="n">trunk</span> <span class="n">my</span><span class="o">-</span><span class="n">sandbox</span>
<span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">sandbox</span>
<span class="p">(</span><span class="n">hack</span> <span class="n">away</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that trunk in this example will have a <code class="docutils literal notranslate"><span class="pre">.brz</span></code> directory within it
but there will be no working tree there as the branch was created in
a tree-less repository. You can grab or create as many branches as you
need there and switch between them as required. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">assuming</span> <span class="ow">in</span> <span class="n">my</span><span class="o">-</span><span class="n">sandbox</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">../</span><span class="n">PROJECT</span><span class="o">-</span><span class="mf">1.0</span>
<span class="n">brz</span> <span class="n">switch</span> <span class="o">../</span><span class="n">PROJECT</span><span class="o">-</span><span class="mf">1.0</span>
<span class="p">(</span><span class="n">fix</span> <span class="n">bug</span> <span class="ow">in</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;blah, blah blah&quot;</span>
<span class="n">brz</span> <span class="n">switch</span> <span class="o">../</span><span class="n">trunk</span>
<span class="p">(</span><span class="n">go</span> <span class="n">back</span> <span class="n">to</span> <span class="n">working</span> <span class="n">on</span> <span class="n">the</span> <span class="n">trunk</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: The branches may be local only or they may be bound to
remote ones (by creating them with <code class="docutils literal notranslate"><span class="pre">checkout</span></code> or by using <code class="docutils literal notranslate"><span class="pre">bind</span></code>
after creating them with <code class="docutils literal notranslate"><span class="pre">branch</span></code>).</p>
</div>
</div>
</div>
<div class="section" id="team-collaboration-distributed-style">
<h2><a class="toc-backref" href="#id78">Team collaboration, distributed style</a><a class="headerlink" href="#team-collaboration-distributed-style" title="Permalink to this headline">¶</a></h2>
<div class="section" id="distributed-development">
<h3><a class="toc-backref" href="#id79">Distributed development</a><a class="headerlink" href="#distributed-development" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id16">
<h4>Motivation<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>Distributed VCS tools offer new ways of working together,
ways that better reflect the modern world we live in and
ways that enable higher quality outcomes.</p>
</div>
<div class="section" id="the-decentralized-with-shared-mainline-workflow">
<h4>The decentralized with shared mainline workflow<a class="headerlink" href="#the-decentralized-with-shared-mainline-workflow" title="Permalink to this headline">¶</a></h4>
<p>In this workflow, each developer has their own branch or branches, plus
a checkout of the main branch. They do their work in their personal
branch, then merge it into the mainline when it is ready.</p>
<img alt="../_images/workflows_shared.png" src="../_images/workflows_shared.png" />
<p>Other distributed workflows are explored later in this chapter.</p>
</div>
</div>
<div class="section" id="organizing-branches">
<h3><a class="toc-backref" href="#id80">Organizing branches</a><a class="headerlink" href="#organizing-branches" title="Permalink to this headline">¶</a></h3>
<div class="section" id="mirror-branches">
<h4>Mirror branches<a class="headerlink" href="#mirror-branches" title="Permalink to this headline">¶</a></h4>
<p>A primary difference when using distributed workflows to
develop is that your main local branch is not the place
to make changes. Instead, it is kept as a pristine copy
of the central branch, i.e. it’s a <em>mirror branch</em>.</p>
<p>To create a mirror branch, set-up a shared repository
(if you haven’t already) and then use the <code class="docutils literal notranslate"><span class="pre">branch</span></code>
(or <code class="docutils literal notranslate"><span class="pre">checkout</span></code>) command to create the mirror.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">PROJECT</span>
<span class="n">cd</span> <span class="n">PROJECT</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">centralhost</span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">/</span><span class="n">trunk</span>
</pre></div>
</div>
</div>
<div class="section" id="task-branches">
<h4>Task branches<a class="headerlink" href="#task-branches" title="Permalink to this headline">¶</a></h4>
<p>Each new feature or fix is developed in its own branch.
These branches are referred to as <em>feature branches</em> or
<em>task branches</em> - the terms are used interchangeably.</p>
<p>To create a task branch, use the <code class="docutils literal notranslate"><span class="pre">branch</span></code> command
against your mirror branch. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">trunk</span> <span class="n">fix</span><span class="o">-</span><span class="mi">123</span>
<span class="n">cd</span> <span class="n">fix</span><span class="o">-</span><span class="mi">123</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">)</span>
</pre></div>
</div>
<p>There are numerous advantages to this approach:</p>
<blockquote>
<div><ol class="arabic simple">
<li>You can work on multiple changes in parallel</li>
<li>There is reduced coupling between changes</li>
<li>Multiple people can work in a peer-to-peer mode
on a branch until it is ready to go.</li>
</ol>
</div></blockquote>
<p>In particular, some changes take longer to cook than others
so you can ask for reviews, apply feedback, ask for another
review, etc. By completing work to sufficient quality in
separate branches before merging into a central branch, the
quality and stability of the central branch are maintained
at higher level than they otherwise would be.</p>
</div>
<div class="section" id="refreshing-a-mirror-branch">
<h4>Refreshing a mirror branch<a class="headerlink" href="#refreshing-a-mirror-branch" title="Permalink to this headline">¶</a></h4>
<p>Use the <code class="docutils literal notranslate"><span class="pre">pull</span></code> command to do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">trunk</span>
<span class="n">brz</span> <span class="n">pull</span>
</pre></div>
</div>
</div>
<div class="section" id="merging-the-latest-trunk-into-a-feature-branch">
<h4>Merging the latest trunk into a feature branch<a class="headerlink" href="#merging-the-latest-trunk-into-a-feature-branch" title="Permalink to this headline">¶</a></h4>
<p>Use the <code class="docutils literal notranslate"><span class="pre">merge</span></code> command to do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">fix</span><span class="o">-</span><span class="mi">123</span>
<span class="n">brz</span> <span class="n">merge</span>
<span class="p">(</span><span class="n">resolve</span> <span class="nb">any</span> <span class="n">conflicts</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;merged trunk&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="merging-a-feature-into-the-trunk">
<h4>Merging a feature into the trunk<a class="headerlink" href="#merging-a-feature-into-the-trunk" title="Permalink to this headline">¶</a></h4>
<p>The policies for different distributed workflows vary here.
The simple case where all developers have commit rights to
the main trunk are shown below.</p>
<p>If your mirror is a checkout:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">trunk</span>
<span class="n">brz</span> <span class="n">update</span>
<span class="n">brz</span> <span class="n">merge</span> <span class="o">../</span><span class="n">fix</span><span class="o">-</span><span class="mi">123</span>
<span class="p">(</span><span class="n">resolve</span> <span class="nb">any</span> <span class="n">conflicts</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Fixed bug #123&quot;</span>
</pre></div>
</div>
<p>If your mirror is a branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">trunk</span>
<span class="n">brz</span> <span class="n">pull</span>
<span class="n">brz</span> <span class="n">merge</span> <span class="o">../</span><span class="n">fix</span><span class="o">-</span><span class="mi">123</span>
<span class="p">(</span><span class="n">resolve</span> <span class="nb">any</span> <span class="n">conflicts</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Fixed bug #123&quot;</span>
<span class="n">brz</span> <span class="n">push</span>
</pre></div>
</div>
</div>
<div class="section" id="backing-up-task-branches">
<h4>Backing up task branches<a class="headerlink" href="#backing-up-task-branches" title="Permalink to this headline">¶</a></h4>
<p>One of the side effects of centralized workflows is that changes
get frequently committed to a central location which is backed up as
part of normal IT operations. When developing on task branches,
it is a good idea to publish your work to a central location
(but not necessarily a shared location) that will be backed up.
You may even wish to bind local task branches to remote ones
established on a backup server just for this purpose.</p>
</div>
</div>
<div class="section" id="using-gatekeepers">
<h3><a class="toc-backref" href="#id81">Using gatekeepers</a><a class="headerlink" href="#using-gatekeepers" title="Permalink to this headline">¶</a></h3>
<div class="section" id="the-decentralized-with-human-gatekeeper-workflow">
<h4>The decentralized with human gatekeeper workflow<a class="headerlink" href="#the-decentralized-with-human-gatekeeper-workflow" title="Permalink to this headline">¶</a></h4>
<p>In this workflow, one developer (the gatekeeper) has commit rights
to the main branch while other developers have read-only access.
All developers make their changes in task branches.</p>
<img alt="../_images/workflows_gatekeeper.png" src="../_images/workflows_gatekeeper.png" />
<p>When a developer wants their work merged, they ask the gatekeeper
to review their change and merge it if acceptable. If a change fails
review, further development proceeds in the relevant task branch
until it is good to go.</p>
<p>Note that a key aspect of this approach is the inversion of control
that is implied: developers no longer decide when to “commit/push”
changes into the central branch: the code base evolves by gatekeepers
“merging/pulling” changes in a controlled manner. It’s perfectly
acceptable, indeed common, to have multiple central branches with
different gatekeepers, e.g. one branch for the current production
release and another for the next release. In this case, a task branch
holding a bug fix will most likely be advertised to both gatekeepers.</p>
<p>One of the great things about this workflow is that it is hugely
scalable. Large projects can be broken into teams and each
team can have a <em>local master branch</em> managed by a gatekeeper.
Someone can be appointed as the primary gatekeeper to merge
changes from the team master branches into the primary master
branch when team leaders request it.</p>
</div>
<div class="section" id="the-decentralized-with-automatic-gatekeeper-workflow">
<h4>The decentralized with automatic gatekeeper workflow<a class="headerlink" href="#the-decentralized-with-automatic-gatekeeper-workflow" title="Permalink to this headline">¶</a></h4>
<p>To obtain even higher quality, all developers can be required to
submit changes to an automated gatekeeper that only merges and
commits a change if it passes a regression test suite. One
such gatekeeper is a software tool called PQM.</p>
<img alt="../_images/workflows_pqm.png" src="../_images/workflows_pqm.png" />
<p>For further information on PQM, see <a class="reference external" href="https://launchpad.net/pqm">https://launchpad.net/pqm</a>.</p>
</div>
</div>
<div class="section" id="sending-changes">
<h3><a class="toc-backref" href="#id82">Sending changes</a><a class="headerlink" href="#sending-changes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id17">
<h4>Motivation<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p>In many distributed development scenarios, it isn’t always feasible for
developers to share task branches by advertising their URLs.
For example, a developer working on a laptop might take it home overnight
so his/her task branches could well be inaccessible when a gatekeeper
in another timezone wants to review or merge it.</p>
<p>Breezy provides a neat feature to assist here: <em>merge directives</em>.</p>
</div>
<div class="section" id="understanding-merge-directives">
<h4>Understanding merge directives<a class="headerlink" href="#understanding-merge-directives" title="Permalink to this headline">¶</a></h4>
<p>You can think of a merge directive as a “mini branch” - just the
new growth on a branch since it was created. It’s a software
patch showing what’s new but with added intelligence: metadata
like interim commits, renames and digital signatures.</p>
<p>Another useful metaphor is a packet cake: a merge directive has a recipe
together with the ingredients you need bundled inside it.
To stretch the metaphor, the ingredients are all the metadata on the
changes made to the branch; the recipe is instructions on how those
changes ought to be merged, i.e. information for the <code class="docutils literal notranslate"><span class="pre">merge</span></code> command
to use in selecting common ancestors.</p>
<p>Regardless of how you think of them, merge directives are neat.
They are easy to create, suitable for mailing around as attachments
and can be processed much like branches can on the receiving end.</p>
</div>
<div class="section" id="creating-a-merge-directive">
<h4>Creating a merge directive<a class="headerlink" href="#creating-a-merge-directive" title="Permalink to this headline">¶</a></h4>
<p>To create and optionally send a merge directive, use the <code class="docutils literal notranslate"><span class="pre">send</span></code> command.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">send</span></code> will email the merge directive to the “submission
address” for the branch, which is typically the lead developer or the
development mailing list.
<code class="docutils literal notranslate"><span class="pre">send</span></code> without options will create a merge directive, fire up your email
tool and attach it, ready for you to add the explanatory text bit.
(See the online help for <code class="docutils literal notranslate"><span class="pre">send</span></code> and
<a class="reference external" href="../user-reference/index.html#configuration-settings">Configuration Settings</a>
in the User Reference for further details on how to configure this.)</p>
<p>Most projects like people to add some explanation to the mail along with
the patch, explaining the reason for the patch, and why it is done the way
it is.  This gives a reviewer some context before going into the
line-by-line diff.</p>
<p>Alternatively, if the <code class="docutils literal notranslate"><span class="pre">--output</span></code> (or <code class="docutils literal notranslate"><span class="pre">-o</span></code>) option is given, <code class="docutils literal notranslate"><span class="pre">send</span></code>
will write the merge directive to a file, so you can mail it yourself,
examine it, or save it for later use.  If an output file of <code class="docutils literal notranslate"><span class="pre">-</span></code> is
given, the directive is written to stdout.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">X</span><span class="o">-</span><span class="n">fix</span><span class="o">-</span><span class="mi">123</span>
<span class="n">brz</span> <span class="n">send</span> <span class="o">-</span><span class="n">o</span> <span class="o">../</span><span class="n">fix</span><span class="o">-</span><span class="mf">123.</span><span class="n">patch</span>
</pre></div>
</div>
</div>
<div class="section" id="applying-a-merge-directive">
<h4>Applying a merge directive<a class="headerlink" href="#applying-a-merge-directive" title="Permalink to this headline">¶</a></h4>
<p>Merge directives can be applied in much the same way as branches: by
using the <code class="docutils literal notranslate"><span class="pre">merge</span></code> and <code class="docutils literal notranslate"><span class="pre">pull</span></code> commands.</p>
<p>They can also be useful when communicating with upstream projects
that don’t use Breezy. In particular, the preview of the overall
change in a merge directive looks like a vanilla software patch, so
they can be applied using <code class="docutils literal notranslate"><span class="pre">patch</span> <span class="pre">-p0</span></code> for example.</p>
</div>
</div>
</div>
<div class="section" id="miscellaneous-topics">
<h2><a class="toc-backref" href="#id83">Miscellaneous topics</a><a class="headerlink" href="#miscellaneous-topics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-journey-ahead">
<h3><a class="toc-backref" href="#id84">The journey ahead</a><a class="headerlink" href="#the-journey-ahead" title="Permalink to this headline">¶</a></h3>
<p>We hope that earlier chapters have given you a solid
understanding of how Breezy can assist you in being productive
on your own and working effectively with others.
If you are learning Breezy for the first time, it might be
good to try the procedures covered already for a while,
coming back to this manual once you have mastered them.</p>
<p>Remaining chapters
covers various topics to guide you in further optimizing how you
use Breezy. Unless stated otherwise, the topics in this and
remaining chapters are independent of each other and can therefore
be read in whichever order you wish.</p>
</div>
<div class="section" id="pseudo-merging">
<h3><a class="toc-backref" href="#id85">Pseudo merging</a><a class="headerlink" href="#pseudo-merging" title="Permalink to this headline">¶</a></h3>
<div class="section" id="cherrypicking">
<h4>Cherrypicking<a class="headerlink" href="#cherrypicking" title="Permalink to this headline">¶</a></h4>
<p>At times, it can be useful to selectively merge some of the changes
in a branch, but not all of them. This is commonly referred to as
<em>cherrypicking</em>. Here are some examples of where cherrypicking is
useful:</p>
<ul class="simple">
<li>selectively taking fixes from the main development branch into
a release branch</li>
<li>selectively taking improvements out of an experimental branch into
a feature branch.</li>
</ul>
<p>To merge only the changes made by revision X in branch <code class="docutils literal notranslate"><span class="pre">foo</span></code>,
the command is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span> <span class="o">-</span><span class="n">c</span> <span class="n">X</span> <span class="n">foo</span>
</pre></div>
</div>
<p>To merge only the changes up to revision X in branch <code class="docutils literal notranslate"><span class="pre">foo</span></code>,
the command is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span> <span class="o">-</span><span class="n">r</span> <span class="n">X</span> <span class="n">foo</span>
</pre></div>
</div>
<p>To merge only the changes since revision X in branch <code class="docutils literal notranslate"><span class="pre">foo</span></code>,
the command is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span> <span class="o">-</span><span class="n">r</span> <span class="n">X</span><span class="o">..</span> <span class="n">foo</span>
</pre></div>
</div>
<p>To merge only the changes from revision X to revision Y in branch <code class="docutils literal notranslate"><span class="pre">foo</span></code>,
the command is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span> <span class="o">-</span><span class="n">r</span> <span class="n">X</span><span class="o">..</span><span class="n">Y</span> <span class="n">foo</span>
</pre></div>
</div>
<p>Like a normal merge, you must explicitly commit a cherrypick. You may wish
to see the changes made using <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">diff</span></code>, and run your test suite if any,
before doing this.</p>
<p>Unlike a normal merge, Breezy does not currently track cherrypicks.
In particular, the changes look like a normal commit and the (internal)
revision history of the changes from the other branch is lost.
In many cases where they are useful (see above), this is not a major
problem because there are good reasons why a full merge should never
be done at a later time. In other cases, additional conflicts will need
to be resolved when the changes are merged again.</p>
</div>
<div class="section" id="merging-without-parents">
<h4>Merging without parents<a class="headerlink" href="#merging-without-parents" title="Permalink to this headline">¶</a></h4>
<p>A related technique to cherrypicking, in that it makes changes without
reference to the revisions that they came from is to perform a merge, but
forget about the parent revisions before committing.  This has the effect of
making all of the changes that would have been in the merge happen in a single
commit.  After the merge and before the corresponding commit, you can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">revert</span> <span class="o">--</span><span class="n">forget</span><span class="o">-</span><span class="n">merges</span>
</pre></div>
</div>
<p>to keep the changes in the working tree, but remove the record of the
revisions where the changes originated.  The next commit would then record
all of those changes without any record of the merged revisions.</p>
<p>This is desired by some users to make their history “cleaner”, but you should
be careful that the loss of history does not outweigh the value of cleanliness,
particularly given Breezy’s capabilities for progressively disclosing merged
revisions.  In particular, because this will include the changes from the
source branch, but without attribution to that branch, it can lead to
additional conflicts on later merges that involve the same source and
target branches.</p>
</div>
<div class="section" id="id19">
<h4>Reverse cherrypicking<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>Cherrypicking can be used to reverse a set of changes made by giving an
upper bound in the revision range which is <em>below</em> the lower bound.
For example, to back-out changes made in revision 10, the command is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span> <span class="o">-</span><span class="n">r</span> <span class="mf">10.</span><span class="o">.</span><span class="mi">9</span>
</pre></div>
</div>
<p>If you want to take most changes, but not all, from somewhere else, you
may wish to do a normal merge followed by a few reverse cherrypicks.</p>
</div>
<div class="section" id="merging-uncommitted-changes">
<h4>Merging uncommitted changes<a class="headerlink" href="#merging-uncommitted-changes" title="Permalink to this headline">¶</a></h4>
<p>If you have several branches and you accidentally start making changes in the
wrong one, here are the steps to take to correct this. Assuming you began
working in branch <code class="docutils literal notranslate"><span class="pre">foo</span></code> when you meant to work in branch <code class="docutils literal notranslate"><span class="pre">bar</span></code>:</p>
<ol class="arabic simple">
<li>Change into branch <code class="docutils literal notranslate"><span class="pre">bar</span></code>.</li>
<li>Run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">merge</span> <span class="pre">--uncommitted</span> <span class="pre">foo</span></code></li>
<li>Check the changes came across (<code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">diff</span></code>)</li>
<li>Change into branch <code class="docutils literal notranslate"><span class="pre">foo</span></code></li>
<li>Run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">revert</span></code>.</li>
</ol>
</div>
<div class="section" id="rebasing">
<h4>Rebasing<a class="headerlink" href="#rebasing" title="Permalink to this headline">¶</a></h4>
<p>Another option to normal merging is <em>rebasing</em>, i.e. making it look like
the current branch originated from a different point than it did.
Rebasing is supported in Breezy by the <code class="docutils literal notranslate"><span class="pre">rebase</span></code> command provided by
the <code class="docutils literal notranslate"><span class="pre">rebase</span></code> plugin.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rebase</span></code> command takes the location of another branch on which
the branch in the current working directory will be rebased. If a branch
is not specified then the parent branch is used, and this is usually the
desired result.</p>
<p>The first step identifies the revisions that are in the current branch
that are not in the parent branch. The current branch is then set to be
at the same revision as the target branch, and each revision is replayed
on top of the branch. At the end of the process it will appear as though
your current branch was branched off the current last revision of the target.</p>
<p>Each revision that is replayed may cause conflicts in the tree. If this
happens the command will stop and allow you to fix them up. Resolve the
commits as you would for a <code class="docutils literal notranslate"><span class="pre">merge</span></code>, and then run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">resolve</span></code> to
marked them as resolved. Once you have resolved all the conflicts, you
should run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">rebase-continue</span></code> to continue the rebase operation.
If conflicts are encountered and you decide not to continue,
you can run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">rebase-abort</span></code>. You can also use <code class="docutils literal notranslate"><span class="pre">rebase-todo</span></code> to
show the list of commits still to be replayed.</p>
<p>Note: Some users coming from central VCS tools with poor merge tracking
like rebasing because it’s similar to how they are use to working in older
tools, or because “perfectly clean” history seems important. Before rebasing
in Breezy, think about whether a normal merge is a better choice. In
particular, rebasing a private branch before sharing it is OK but
rebasing after sharing a branch with someone else is <strong>strongly</strong> discouraged.</p>
</div>
</div>
<div class="section" id="shelving-changes">
<h3><a class="toc-backref" href="#id86">Shelving Changes</a><a class="headerlink" href="#shelving-changes" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you will want to temporarily remove changes from your working
tree and restore them later, For instance to commit a small bug-fix you
found while working on something. Breezy allows you to put changes on
a <code class="docutils literal notranslate"><span class="pre">shelf</span></code> to achieve this. When you want to restore the changes later
you can use <code class="docutils literal notranslate"><span class="pre">unshelve</span></code> to apply them to your working tree again.</p>
<p>For example, consider a working tree with one or more changes made …</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz diff
=== modified file &#39;description.txt&#39;
--- description.txt
+++ description.txt
@@ -2,7 +2,7 @@
 ===============

 These plugins
-by Michael Ellerman
+written by Michael Ellerman
 provide a very
 fine-grained &#39;undo&#39;
 facility
@@ -11,6 +11,6 @@
 This allows you to
 undo some of
 your changes,
-commit, and get
+perform a commit, and get
 back to where you
 were before.
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">shelve</span></code> command interactively asks which changes
you want to retain in the working tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz shelve
--- description.txt
+++ description.txt
@@ -2,7 +2,7 @@
 ===============

 These plugins
-by Michael Ellerman
+written by Michael Ellerman
 provide a very
 fine-grained &#39;undo&#39;
 facility

Shelve? [yNfrq?]: y
--- description.txt
+++ description.txt
@@ -11,6 +11,6 @@
 This allows you to
 undo some of
 your changes,
-commit, and get
+perform a commit, and get
 back to where you
 were before.

Shelve? [yNfrq?]: n
Shelve 2 change(s)? [yNfrq?]&#39;, &#39;y&#39;
Selected changes:
 M  description.txt
Changes shelved with id &quot;1&quot;.
</pre></div>
</div>
<p>If there are lots of changes in the working tree, you
can provide the <code class="docutils literal notranslate"><span class="pre">shelve</span></code> command with a list of files
and you will only be asked about changes in those files.
After shelving changes, it’s a good idea to use <code class="docutils literal notranslate"><span class="pre">diff</span></code>
to confirm the tree has just the changes you expect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz diff
=== modified file &#39;description.txt&#39;
--- description.txt
+++ description.txt
@@ -2,7 +2,7 @@
 ===============

 These plugins
-by Michael Ellerman
+written by Michael Ellerman
 provide a very
 fine-grained &#39;undo&#39;
 facility
</pre></div>
</div>
<p>Great - you’re ready to commit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz commit -m &quot;improve first sentence&quot;
</pre></div>
</div>
<p>At some later time, you can bring the shelved changes back into the
working tree using <code class="docutils literal notranslate"><span class="pre">unshelve</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz unshelve
Unshelving changes with id &quot;1&quot;.
 M  description.txt
All changes applied successfully.
</pre></div>
</div>
<p>If you want to, you can put multiple items on the shelf.
Normally each time you run <code class="docutils literal notranslate"><span class="pre">unshelve</span></code> the most recently
shelved changes will be reinstated. However, you can also
unshelve changes in a different order by explicitly
specifying which changes to unshelve.</p>
<p>Breezy merges the changes in to your working tree, so they
will apply even if you have edited the files since you shelved
them, though they may conflict, in which case you will have to
resolve the conflicts in the same way you do after a conflicted
merge.</p>
</div>
<div class="section" id="switch-store">
<h3><a class="toc-backref" href="#id87">Switch –store</a><a class="headerlink" href="#switch-store" title="Permalink to this headline">¶</a></h3>
<p>In workflows that a single working tree, like co-located branches, sometimes
you want to switch while you have uncommitted changes.  By default, <code class="docutils literal notranslate"><span class="pre">switch</span></code>
will apply your uncommitted changes to the new branch that you switch to.  But
often you don’t want that.  You just want to do some work in the other branch,
and eventually return to this branch and work some more.</p>
<p>You could run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">shelve</span> <span class="pre">--all</span></code> before switching, to store the changes
safely.  So you have to know that there are uncommitted changes present, and
you have to remember to run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">shelve</span> <span class="pre">--all</span></code>.  Then when you switch back to
the branch, you need to remember to unshelve the changes, and you need to know
what their shelf-id was.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">switch</span> <span class="pre">--store</span></code> takes care of all of this for you.  If there are any
uncommitted changes in your tree, it stores them in your branch.  It then
restores any uncommitted changes that were stored in the branch of your target
tree.  It’s almost like having two working trees and using <code class="docutils literal notranslate"><span class="pre">cd</span></code> to switch
between them.</p>
<p>To take an example, first we’d set up a co-located branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz init foo
Created a standalone tree (format: 2a)
$ cd foo
$ brz switch -b foo
</pre></div>
</div>
<p>Now create committed and uncommitted changes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ touch committed
$ brz add
adding committed
$ brz commit -m &quot;Add committed&quot;
Committing to: /home/abentley/sandbox/foo/
added committed
Committed revision 1.
$ touch uncommitted
$ brz add
adding uncommitted
$ ls
committed  uncommitted
</pre></div>
</div>
<p>Now create a new branch using <code class="docutils literal notranslate"><span class="pre">--store</span></code>.  The uncommitted changes are stored
in “foo”, but the committed changes are retained.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz switch -b --store bar
Uncommitted changes stored in branch &quot;foo&quot;.
Tree is up to date at revision 1.
Switched to branch: /home/abentley/sandbox/foo/
abentley@speedy:~/sandbox/foo$ ls
committed
</pre></div>
</div>
<p>Now, create uncommitted changes in “bar”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ touch uncommitted-bar
$ brz add
adding uncommitted-bar
</pre></div>
</div>
<p>Finally, switch back to “foo”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz switch --store foo
Uncommitted changes stored in branch &quot;bar&quot;.
Tree is up to date at revision 1.
Switched to branch: /home/abentley/sandbox/foo/
$ ls
committed  uncommitted
</pre></div>
</div>
<p>Each branch holds only one set of stored changes.  If you try to store a second
set, you get an error.  If you use <code class="docutils literal notranslate"><span class="pre">--store</span></code> all the time, this can’t happen.
But if you use plain switch, then it won’t restore the uncommitted changes
already present:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz switch bar
Tree is up to date at revision 1.
Switched to branch: /home/abentley/sandbox/foo/
$ brz switch --store foo
brz: ERROR: Cannot store uncommitted changes because this branch already
stores uncommitted changes.
</pre></div>
</div>
<p>If you’re working in a branch that already has stored changes, you can restore
them with <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">switch</span> <span class="pre">.</span> <span class="pre">--store</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz shelve --all -m &quot;Uncommitted changes from foo&quot;
Selected changes:
-D  uncommitted
Changes shelved with id &quot;1&quot;.
$ brz switch . --store
Tree is up to date at revision 1.
Switched to branch: /home/abentley/sandbox/foo/
$ ls
committed  uncommitted-bar
</pre></div>
</div>
</div>
<div class="section" id="filtered-views">
<h3><a class="toc-backref" href="#id88">Filtered views</a><a class="headerlink" href="#filtered-views" title="Permalink to this headline">¶</a></h3>
<div class="section" id="introducing-filtered-views">
<h4>Introducing filtered views<a class="headerlink" href="#introducing-filtered-views" title="Permalink to this headline">¶</a></h4>
<p>Views provide a mask over the tree so that users can focus on a subset
of a tree when doing their work. There are several cases where this
masking can be helpful. For example, technical writers and testers on
many large projects may prefer to deal with just the directories/files
in the project of interest to them.</p>
<p>Developers may also wish to break a large set of changes into multiple
commits by using views. While <code class="docutils literal notranslate"><span class="pre">shelve</span></code> and <code class="docutils literal notranslate"><span class="pre">unshelve</span></code> let developers
put some changes aside for a later commit, views let developers specify
what to include in (instead of exclude from) the next commit.</p>
<p>After creating a view, commands that support a list of files - status,
diff, commit, etc - effectively have that list of files implicitly
given each time. An explicit list of files can still be given to these
commands but the nominated files must be within the current view. In
contrast, tree-centric commands - pull, merge, update, etc. - continue
to operate on the whole tree but only report changes relevant to the
current view. In both cases, Breezy notifies the user each time it uses
a view implicitly so that it is clear that the operation or output is
being masked accordingly.</p>
<p>Note: Filtered views are only supported in format 2a, the default in
Breezy 2.0, or later.</p>
</div>
<div class="section" id="creating-a-view">
<h4>Creating a view<a class="headerlink" href="#creating-a-view" title="Permalink to this headline">¶</a></h4>
<p>This is done by specifying the files and directories using the <code class="docutils literal notranslate"><span class="pre">view</span></code>
command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="n">file1</span> <span class="n">file2</span> <span class="n">dir1</span> <span class="o">...</span>
</pre></div>
</div>
<p>The output is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Using</span> <span class="s1">&#39;my&#39;</span> <span class="n">view</span><span class="p">:</span> <span class="n">file1</span><span class="p">,</span> <span class="n">file2</span><span class="p">,</span> <span class="n">dir1</span>
</pre></div>
</div>
</div>
<div class="section" id="listing-the-current-view">
<h4>Listing the current view<a class="headerlink" href="#listing-the-current-view" title="Permalink to this headline">¶</a></h4>
<p>To see the current view, use the <code class="docutils literal notranslate"><span class="pre">view</span></code> command without arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span>
</pre></div>
</div>
<p>If no view is current, a message will be output saying <code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">current</span> <span class="pre">view.</span></code>.
Otherwise the name and content of the current view will be displayed
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;my&#39;</span> <span class="n">view</span> <span class="ow">is</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<div class="section" id="switching-between-views">
<h4>Switching between views<a class="headerlink" href="#switching-between-views" title="Permalink to this headline">¶</a></h4>
<p>In most cases, a view has a short life-span: it is created to make a
selected change and is deleted once that change is committed. At other
times, you may wish to create one or more named views and switch
between them.</p>
<p>To define a named view and switch to it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">name</span> <span class="n">view</span><span class="o">-</span><span class="n">name</span> <span class="n">file1</span> <span class="n">dir1</span> <span class="o">...</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">name</span> <span class="n">doc</span> <span class="n">NEWS</span> <span class="n">doc</span><span class="o">/</span>
<span class="n">Using</span> <span class="n">doc</span> <span class="n">view</span><span class="p">:</span> <span class="n">NEWS</span><span class="p">,</span> <span class="n">doc</span><span class="o">/</span>
</pre></div>
</div>
<p>To list a named view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">name</span> <span class="n">view</span><span class="o">-</span><span class="n">name</span>
</pre></div>
</div>
<p>To switch to a named view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">switch</span> <span class="n">view</span><span class="o">-</span><span class="n">name</span>
</pre></div>
</div>
<p>To list all views defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="nb">all</span>
</pre></div>
</div>
</div>
<div class="section" id="temporarily-disabling-a-view">
<h4>Temporarily disabling a view<a class="headerlink" href="#temporarily-disabling-a-view" title="Permalink to this headline">¶</a></h4>
<p>To disable the current view without deleting it, you can switch to the
pseudo view called <code class="docutils literal notranslate"><span class="pre">off</span></code>. This can be useful when you need to see the
whole tree for an operation or two (e.g. merge) but want to switch back
to your view after that.</p>
<p>To disable the current view without deleting it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">switch</span> <span class="n">off</span>
</pre></div>
</div>
<p>After doing the operations you need to, you can switch back to the
view you were using by name. For example, if the previous view used
the default name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">switch</span> <span class="n">my</span>
</pre></div>
</div>
</div>
<div class="section" id="deleting-views">
<h4>Deleting views<a class="headerlink" href="#deleting-views" title="Permalink to this headline">¶</a></h4>
<p>To delete the current view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">delete</span>
</pre></div>
</div>
<p>To delete a named view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">name</span> <span class="n">view</span><span class="o">-</span><span class="n">name</span> <span class="o">--</span><span class="n">delete</span>
</pre></div>
</div>
<p>To delete all views:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">view</span> <span class="o">--</span><span class="n">delete</span> <span class="o">--</span><span class="nb">all</span>
</pre></div>
</div>
</div>
<div class="section" id="things-to-be-aware-of">
<h4>Things to be aware of<a class="headerlink" href="#things-to-be-aware-of" title="Permalink to this headline">¶</a></h4>
<p>Defining a view does not delete the other files in the working
tree - it merely provides a “lens” over the working tree.</p>
<p>Views are stored as working tree metadata. They are not
propagated by branch commands like pull, push and update.</p>
<p>Views are defined in terms of file paths. If you move a
file in a view to a location outside of the view, the view
will no longer track that path. For example, if a view is
defined as <code class="docutils literal notranslate"><span class="pre">doc/</span></code> and <code class="docutils literal notranslate"><span class="pre">doc/NEWS</span></code> gets moved to <code class="docutils literal notranslate"><span class="pre">NEWS</span></code>,
the views stays defined as <code class="docutils literal notranslate"><span class="pre">doc/</span></code> and does not get changed
to <code class="docutils literal notranslate"><span class="pre">doc/</span> <span class="pre">NEWS</span></code>. Likewise, deleting a file in a view does
not remove the file from that view.</p>
<p>The commands that use the current view are:</p>
<ul class="simple">
<li>status</li>
<li>diff</li>
<li>commit</li>
<li>add</li>
<li>remove</li>
<li>revert</li>
<li>mv</li>
<li>ls.</li>
</ul>
<p>Commands that operate on the full tree but only report changes
inside the current view are:</p>
<ul class="simple">
<li>pull</li>
<li>update</li>
<li>merge.</li>
</ul>
<p>Many commands currently ignore the current view. Over time,
some of these commands may be added to the lists above as
the need arises. By design, some commands will most likely
always ignore the current view because showing the whole
picture is the better thing to do. Commands in this group
include:</p>
<ul class="simple">
<li>log</li>
<li>info.</li>
</ul>
</div>
</div>
<div class="section" id="using-stacked-branches">
<h3><a class="toc-backref" href="#id89">Using stacked branches</a><a class="headerlink" href="#using-stacked-branches" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id20">
<h4>Motivation<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>If you are working on a project, and you have read access to whose
public repository but do not have write access to it, using stacked
branches to backup/publish your work onto the same host of the public
repository might be an option for you.</p>
<p>Other scenarios for stacked branch usage include experimental branches
and code hosting sites. For these scenarios, stacked branches are
ideal because of the benefits it provides.</p>
</div>
<div class="section" id="what-is-a-stacked-branch">
<h4>What is a stacked branch?<a class="headerlink" href="#what-is-a-stacked-branch" title="Permalink to this headline">¶</a></h4>
<p>A stacked branch is a branch that knows how to find revisions in
another branch (the stacked-on branch). Stacked branches store just
the unique revisions that are not in the stacked-on branch, making
them faster to create and more storage efficient. In these respects,
stacked branches are similar to shared repositories. However, stacked
branches have additional benefits:</p>
<ul class="simple">
<li>The new branch can be in a completely different location to the
branch being stacked on.</li>
<li>Deleting the stacked branch really deletes the revisions (rather
than leaving them in a shared repository).</li>
<li>Security is improved over shared repositories, because the stacked-on
repository can be physically readonly to developers committing to stacked
branches.</li>
</ul>
</div>
<div class="section" id="creating-a-stacked-branch">
<h4>Creating a stacked branch<a class="headerlink" href="#creating-a-stacked-branch" title="Permalink to this headline">¶</a></h4>
<p>To create a stacked branch, use the <code class="docutils literal notranslate"><span class="pre">stacked</span></code> option of the branch command.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="o">--</span><span class="n">stacked</span> <span class="n">source</span><span class="o">-</span><span class="n">url</span> <span class="n">my</span><span class="o">-</span><span class="nb">dir</span>
</pre></div>
</div>
<p>This will create <code class="docutils literal notranslate"><span class="pre">my-dir</span></code> as a stacked branch with no local revisions.
If it is defined, the public branch associated with <code class="docutils literal notranslate"><span class="pre">source-url</span></code> will be
used as the <em>stacked-on</em> location. Otherwise, <code class="docutils literal notranslate"><span class="pre">source-url</span></code> will be the
<em>stacked-on</em> location.</p>
</div>
<div class="section" id="creating-a-stacked-checkout">
<h4>Creating a stacked checkout<a class="headerlink" href="#creating-a-stacked-checkout" title="Permalink to this headline">¶</a></h4>
<p>Direct creation of a stacked checkout is expected to be supported soon.
In the meantime, a two step process is required:</p>
<ol class="arabic simple">
<li>Create a stacked branch as shown above.</li>
<li>Convert the branch into a checkout using either the <code class="docutils literal notranslate"><span class="pre">reconfigure</span></code>
or <code class="docutils literal notranslate"><span class="pre">bind</span></code> command.</li>
</ol>
</div>
<div class="section" id="pushing-a-stacked-branch">
<h4>Pushing a stacked branch<a class="headerlink" href="#pushing-a-stacked-branch" title="Permalink to this headline">¶</a></h4>
<p>Most changes on most projects build on an existing branch such as the
<em>development trunk</em> or <em>current stable</em> branch. Creating a new
branch stacked on one of these is easy to do using the <code class="docutils literal notranslate"><span class="pre">push</span></code>
command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">push</span> <span class="o">--</span><span class="n">stacked</span><span class="o">-</span><span class="n">on</span> <span class="n">reference</span><span class="o">-</span><span class="n">url</span> <span class="n">my</span><span class="o">-</span><span class="n">url</span>
</pre></div>
</div>
<p>This creates a new branch at <code class="docutils literal notranslate"><span class="pre">my-url</span></code> that is stacked on <code class="docutils literal notranslate"><span class="pre">reference-url</span></code>
and only contains the revisions in the current branch that are not already
in the branch at <code class="docutils literal notranslate"><span class="pre">reference-url</span></code>. In particular, <code class="docutils literal notranslate"><span class="pre">my-url</span></code> and
<code class="docutils literal notranslate"><span class="pre">reference-url</span></code> can be on the same host, and the <code class="docutils literal notranslate"><span class="pre">--stacked-on</span></code> option
can be used additionally to inform <code class="docutils literal notranslate"><span class="pre">push</span></code> to reference the
revisions in <code class="docutils literal notranslate"><span class="pre">reference-url</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">push</span> <span class="o">--</span><span class="n">stacked</span><span class="o">-</span><span class="n">on</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">project</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">stacked</span><span class="o">-</span><span class="n">branch</span>
</pre></div>
</div>
<p>This usage fits the scenario described in the Motivation section.</p>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">--stacked</span></code> option without specifying <code class="docutils literal notranslate"><span class="pre">--stacked-on</span></code>.
This will automatically set the <em>stacked-on</em> location to the parent branch of
the branch you are pushing (or its <code class="docutils literal notranslate"><span class="pre">public_location</span></code> if configured).  For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">source</span><span class="o">-</span><span class="n">url</span> <span class="n">my</span><span class="o">-</span><span class="nb">dir</span>
<span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="nb">dir</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;fix bug&quot;</span>
<span class="n">brz</span> <span class="n">push</span> <span class="o">--</span><span class="n">stacked</span>
</pre></div>
</div>
<p>You can combine <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">branch</span> <span class="pre">--stacked</span></code> and <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">push</span> <span class="pre">--stacked</span></code> to work on a
branch without downloading or uploading the whole history:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="o">--</span><span class="n">stacked</span> <span class="n">source</span><span class="o">-</span><span class="n">url</span> <span class="n">my</span><span class="o">-</span><span class="nb">dir</span>
<span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="nb">dir</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;fix bug&quot;</span>
<span class="n">brz</span> <span class="n">push</span> <span class="o">--</span><span class="n">stacked</span>
</pre></div>
</div>
</div>
<div class="section" id="limitations-of-stacked-branches">
<h4>Limitations of stacked branches<a class="headerlink" href="#limitations-of-stacked-branches" title="Permalink to this headline">¶</a></h4>
<p>The important thing to remember about a stacked branch is that the stacked-on
branch needs to be accessible for almost all operations.  This is not an issue
when both branches are local, or when both branches are on the same server and
the stacked-on location is a relative path.  But clearly a branch hosted on a
server with a stacked-on location of <code class="docutils literal notranslate"><span class="pre">file:///...</span></code> is not going to work for
anyone except the user that originally pushed it.  It’s a good idea to configure
<code class="docutils literal notranslate"><span class="pre">public_location</span></code> to help prevent that.</p>
<p>Similarly, because most of the history is stored in the stacked-on repository,
operations like <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">log</span></code> can be slower when the stacked-on repository is
accessed via a network.</p>
<p>If a stacked branch is in a format older than 2a, you cannot commit to it due to
<a class="reference external" href="https://bugs.launchpad.net/bzr/+bug/375013">bug 375013</a>.</p>
</div>
<div class="section" id="changing-branch-stacking">
<h4>Changing branch stacking<a class="headerlink" href="#changing-branch-stacking" title="Permalink to this headline">¶</a></h4>
<p>Stacking of existing branches can be changed using the <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">reconfigure</span></code>
command to either stack on an existing branch, or to turn off stacking.
Be aware that when <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">reconfigure</span> <span class="pre">--unstacked</span></code> is used, brz will
copy all the referenced data from the stacked-on repository into the
previously stacked repository.  For large repositories this may take
considerable time and may substantially increase the size of the
repository.</p>
</div>
</div>
<div class="section" id="running-a-smart-server">
<h3><a class="toc-backref" href="#id90">Running a smart server</a><a class="headerlink" href="#running-a-smart-server" title="Permalink to this headline">¶</a></h3>
<p>Breezy does not require a specialised server because it operates over HTTP, FTP
or SFTP.  There is an optional smart server that can be invoked over SSH, from
inetd, or in a dedicated mode.</p>
<div class="section" id="dumb-servers">
<h4>Dumb servers<a class="headerlink" href="#dumb-servers" title="Permalink to this headline">¶</a></h4>
<p>We describe HTTP, FTP, SFTP and HTTP-WebDAV as “dumb” servers because they do
not offer any assistance to Breezy.  If you make a Breezy repository available
over any of these protocols, Breezy will allow you to read it remotely.  Just
enter the URL to the branch in the Breezy command you are running.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">bazaar</span><span class="o">.</span><span class="n">launchpad</span><span class="o">.</span><span class="n">net</span><span class="o">/~</span><span class="n">brz</span><span class="o">-</span><span class="n">pqm</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">brz</span><span class="o">.</span><span class="n">dev</span>
</pre></div>
</div>
<p>Breezy supports writing over FTP, SFTP and (via a plugin) over HTTP-WebDAV.</p>
</div>
<div class="section" id="high-performance-smart-server">
<h4>High-performance smart server<a class="headerlink" href="#high-performance-smart-server" title="Permalink to this headline">¶</a></h4>
<p>The high-performance smart server (hpss) performs certain operations much faster
than dumb servers are capable of.  In future releases, the range of operations
that are improved by using the smart server will increase as we continue to
tune performance.</p>
<p>To maintain the highest security possible, the current
smart server provides read-only access by default.  To
enable read-write access, run it with <code class="docutils literal notranslate"><span class="pre">--allow-writes</span></code>. When using
the SSH access method, brz automatically runs with the
<code class="docutils literal notranslate"><span class="pre">--allow-writes</span></code> option.</p>
<p>The alternative ways of configuring a smart server are explained below.</p>
<div class="section" id="ssh">
<h5>SSH<a class="headerlink" href="#ssh" title="Permalink to this headline">¶</a></h5>
<p>Using Breezy over SSH requires no special configuration on the server; so long
as Breezy is installed on the server you can use <code class="docutils literal notranslate"><span class="pre">bzr+ssh</span></code> URLs, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">branch</span>
</pre></div>
</div>
<p>If <cite>brz</cite> is not installed system-wide on the server you may need to explicitly
tell the local <cite>brz</cite> where to find the remote <cite>brz</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BZR_REMOTE_PATH</span><span class="o">=~/</span><span class="nb">bin</span><span class="o">/</span><span class="n">brz</span> <span class="n">brz</span> <span class="n">log</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">branch</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">BZR_REMOTE_PATH</span></code> environment variable adjusts how <cite>brz</cite> will be
invoked on the remote system.  By default, just <cite>brz</cite> will be invoked,
which requires the <cite>brz</cite> executable to be on the default search path.  You can
also set this permanently per-location in <code class="docutils literal notranslate"><span class="pre">locations.conf</span></code>.</p>
<p>Like SFTP, paths starting with <code class="docutils literal notranslate"><span class="pre">~</span></code> are relative to your home directory, e.g.
<code class="docutils literal notranslate"><span class="pre">bzr+ssh://example.com/~/code/proj</span></code>.  Additionally, paths starting with
<code class="docutils literal notranslate"><span class="pre">~user</span></code> will be relative to that user’s home directory.</p>
</div>
<div class="section" id="inetd">
<h5>inetd<a class="headerlink" href="#inetd" title="Permalink to this headline">¶</a></h5>
<p>This example shows how to run <cite>brz</cite> with a dedicated user <cite>brzuser</cite>
for a shared repository in <code class="docutils literal notranslate"><span class="pre">/srv/brz/repo</span></code> which has a branch at
<code class="docutils literal notranslate"><span class="pre">/srv/brz/repo/branchname</span></code>.</p>
<p>Running a Breezy server from inetd requires an inetd.conf entry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4155</span>  <span class="n">stream</span>  <span class="n">TCP</span>  <span class="n">nowait</span>  <span class="n">brzuser</span>  <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">brz</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">brz</span> <span class="n">serve</span> <span class="o">--</span><span class="n">inet</span> <span class="o">--</span><span class="n">directory</span><span class="o">=/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">repo</span>
</pre></div>
</div>
<p>When running client commands, the URL you supply is a <cite>bzr://</cite> URL relative to
the <code class="docutils literal notranslate"><span class="pre">--directory</span></code> option given in inetd.conf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">bzr</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">branchname</span>
</pre></div>
</div>
<p>If possible, paths starting with <code class="docutils literal notranslate"><span class="pre">~</span></code> and <code class="docutils literal notranslate"><span class="pre">~user</span></code> will be expanded as for
<code class="docutils literal notranslate"><span class="pre">bzr+ssh</span></code>.  Home directories outside the <code class="docutils literal notranslate"><span class="pre">--directory</span></code> specified to <code class="docutils literal notranslate"><span class="pre">brz</span>
<span class="pre">serve</span></code> will not be accessible.</p>
</div>
<div class="section" id="dedicated">
<h5>Dedicated<a class="headerlink" href="#dedicated" title="Permalink to this headline">¶</a></h5>
<p>This mode has the same path and URL behaviour as the inetd mode.  To
run as a specific user, you should use <code class="docutils literal notranslate"><span class="pre">su</span></code> or login as that user.</p>
<p>This example runs brz on its official port number of <cite>4155</cite> and listens on all
interfaces. This allows connections from anywhere in the world that can reach
your machine on port <cite>4155</cite>.</p>
<p>server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">serve</span> <span class="o">--</span><span class="n">directory</span><span class="o">=/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">repo</span>
</pre></div>
</div>
<p>client:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">bzr</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">branchname</span>
</pre></div>
</div>
<p>This example runs <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">serve</span></code> on <cite>localhost</cite> port <cite>1234</cite>.</p>
<p>server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">serve</span> <span class="o">--</span><span class="n">listen</span><span class="o">=</span><span class="n">localhost</span> <span class="o">--</span><span class="n">port</span><span class="o">=</span><span class="mi">1234</span> <span class="o">--</span><span class="n">directory</span><span class="o">=/</span><span class="n">srv</span><span class="o">/</span><span class="n">brz</span><span class="o">/</span><span class="n">repo</span>
</pre></div>
</div>
<p>client:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">bzr</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">1234</span><span class="o">/</span><span class="n">branchname</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="using-hooks">
<h3><a class="toc-backref" href="#id91">Using hooks</a><a class="headerlink" href="#using-hooks" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-is-a-hook">
<h4>What is a hook?<a class="headerlink" href="#what-is-a-hook" title="Permalink to this headline">¶</a></h4>
<p>One way to customize Breezy’s behaviour is with <em>hooks</em>.  Hooks allow you to
perform actions before or after certain Breezy operations.  The operations
include <code class="docutils literal notranslate"><span class="pre">commit</span></code>, <code class="docutils literal notranslate"><span class="pre">push</span></code>, <code class="docutils literal notranslate"><span class="pre">pull</span></code>, and <code class="docutils literal notranslate"><span class="pre">uncommit</span></code>.
For a complete list of hooks and their parameters, see <a class="reference external" href="../user-reference/index.html#hooks">Hooks</a> in the User Reference.</p>
<p>Most hooks are run on the client, but a few are run on the server.  (Also
see the <a class="reference external" href="http://doc.bazaar.canonical.com/plugins/en/push-and-update-plugin.html">push-and-update plugin</a> that handles one special case of
server-side operations.)</p>
</div>
<div class="section" id="id21">
<h4>Using hooks<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>To use a hook, you should <a class="reference external" href="../../developers/plugin-development.html">write a plugin</a>.  Instead of
creating a new command, this plugin will define and install the hook.  Here’s
an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">breezy</span> <span class="k">import</span> <span class="n">branch</span>


<span class="k">def</span> <span class="nf">post_push_hook</span><span class="p">(</span><span class="n">push_result</span><span class="p">):</span>
    <span class="nb">print</span> <span class="s2">&quot;The new revno is </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">push_result</span><span class="o">.</span><span class="n">new_revno</span>


<span class="n">branch</span><span class="o">.</span><span class="n">Branch</span><span class="o">.</span><span class="n">hooks</span><span class="o">.</span><span class="n">install_named_hook</span><span class="p">(</span><span class="s1">&#39;post_push&#39;</span><span class="p">,</span> <span class="n">post_push_hook</span><span class="p">,</span>
                                 <span class="s1">&#39;My post_push hook&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To use this example, create a file named <code class="docutils literal notranslate"><span class="pre">push_hook.py</span></code>, and stick it in
<code class="docutils literal notranslate"><span class="pre">plugins</span></code> subdirectory of your configuration directory.  (If you have never
installed any plugins, you may need to create the <code class="docutils literal notranslate"><span class="pre">plugins</span></code> directory).</p>
<p>That’s it!  The next time you push, it should show “The new revno is…”.
Of course, hooks can be much more elaborate than this, because you have the
full power of Python at your disposal.  Now that you know how to use hooks,
what you do with them is up to you.</p>
<p>The plugin code does two things.  First, it defines a function that will be
run after <code class="docutils literal notranslate"><span class="pre">push</span></code> completes.  (It could instead use an instance method or
a callable object.)  All push hooks take a single argument, the
<code class="docutils literal notranslate"><span class="pre">push_result</span></code>.</p>
<p>Second, the plugin installs the hook.  The first argument <code class="docutils literal notranslate"><span class="pre">'post_push'</span></code>
identifies where to install the hook.  The second argument is the hook
itself.  The third argument is a name <code class="docutils literal notranslate"><span class="pre">'My</span> <span class="pre">post_push</span> <span class="pre">hook'</span></code>, which can be
used in progress messages and error messages.</p>
<p>To reduce the start-up time of Breezy it is also possible to “lazily” install hooks,
using the <code class="docutils literal notranslate"><span class="pre">breezy.hooks.install_lazy_named_hook</span></code> function. This removes the need
to load the module that contains the hook point just to install the hook. Here’s lazy
version of the example above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">breezy</span> <span class="k">import</span> <span class="n">hooks</span>

<span class="k">def</span> <span class="nf">post_push_hook</span><span class="p">(</span><span class="n">push_result</span><span class="p">):</span>
    <span class="nb">print</span> <span class="s2">&quot;The new revno is </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">push_result</span><span class="o">.</span><span class="n">new_revno</span>


<span class="n">hooks</span><span class="o">.</span><span class="n">install_lazy_named_hook</span><span class="p">(</span><span class="s1">&#39;breezy.branch&#39;</span><span class="p">,</span> <span class="s1">&#39;Branch.hooks&#39;</span><span class="p">,</span>
    <span class="s1">&#39;post_push&#39;</span><span class="p">,</span> <span class="n">post_push_hook</span><span class="p">,</span> <span class="s1">&#39;My post_push hook&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="debugging-hooks">
<h4>Debugging hooks<a class="headerlink" href="#debugging-hooks" title="Permalink to this headline">¶</a></h4>
<p>To get a list of installed hooks (and available hook points), use the hidden
<code class="docutils literal notranslate"><span class="pre">hooks</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">hooks</span>
</pre></div>
</div>
</div>
<div class="section" id="example-a-merge-plugin">
<h4>Example: a merge plugin<a class="headerlink" href="#example-a-merge-plugin" title="Permalink to this headline">¶</a></h4>
<p>Here’s a complete plugin that demonstrates the <code class="docutils literal notranslate"><span class="pre">Merger.merge_file_content</span></code>
hook.  It installs a hook that forces any merge of a file named <code class="docutils literal notranslate"><span class="pre">*.xml</span></code>
to be a conflict, even if Breezy thinks it can merge it cleanly.</p>
<p><code class="docutils literal notranslate"><span class="pre">merge_xml.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Custom &#39;merge&#39; logic for *.xml files.</span>

<span class="sd">Always conflicts if both branches have changed the file.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">breezy.merge</span> <span class="k">import</span> <span class="n">PerFileMerger</span><span class="p">,</span> <span class="n">Merger</span>

<span class="k">def</span> <span class="nf">merge_xml_files_hook</span><span class="p">(</span><span class="n">merger</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hook to merge *.xml files&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AlwaysConflictXMLMerger</span><span class="p">(</span><span class="n">merger</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">AlwaysConflictXMLMerger</span><span class="p">(</span><span class="n">PerFileMerger</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">file_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">merger</span><span class="o">.</span><span class="n">this_tree</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xml&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">merge_matching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;conflicted&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">this_lines</span>

<span class="n">Merger</span><span class="o">.</span><span class="n">hooks</span><span class="o">.</span><span class="n">install_named_hook</span><span class="p">(</span>
    <span class="s1">&#39;merge_file_content&#39;</span><span class="p">,</span> <span class="n">merge_xml_files_hook</span><span class="p">,</span> <span class="s1">&#39;*.xml file merge&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">merge_file_content</span></code> hooks are executed for each file to be merged.  For
a more a complex example look at the <code class="docutils literal notranslate"><span class="pre">news_merge</span></code> plugin that’s bundled with
Breezy in the <code class="docutils literal notranslate"><span class="pre">breezy/plugins</span></code> directory.</p>
</div>
</div>
<div class="section" id="exporting-version-information">
<h3><a class="toc-backref" href="#id92">Exporting version information</a><a class="headerlink" href="#exporting-version-information" title="Permalink to this headline">¶</a></h3>
<div class="section" id="getting-the-last-revision-number">
<h4>Getting the last revision number<a class="headerlink" href="#getting-the-last-revision-number" title="Permalink to this headline">¶</a></h4>
<p>If you only need the last revision number in your build scripts, you can
use the <code class="docutils literal notranslate"><span class="pre">revno</span></code> command to get that value like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz revno
3104
</pre></div>
</div>
</div>
<div class="section" id="getting-more-version-information">
<h4>Getting more version information<a class="headerlink" href="#getting-more-version-information" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">version-info</span></code> command can be used to output more information
about the latest version like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz version-info
revision-id: pqm@pqm.ubuntu.com-20071211175118-s94sizduj201hrs5
date: 2007-12-11 17:51:18 +0000
build-date: 2007-12-13 13:14:51 +1000
revno: 3104
branch-nick: brz.dev
</pre></div>
</div>
<p>You can easily filter that output using operating system tools or
scripts. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz version-info | grep ^date
date: 2007-12-11 17:51:18 +0000
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--all</span></code> option will actually dump version information about
every revision if you need that information for more advanced
post-processing.</p>
</div>
<div class="section" id="python-projects">
<h4>Python projects<a class="headerlink" href="#python-projects" title="Permalink to this headline">¶</a></h4>
<p>If using a Makefile to build your project, you can generate the version
information file as simply as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">library</span><span class="o">/</span><span class="n">_version</span><span class="o">.</span><span class="n">py</span><span class="p">:</span>
      <span class="n">brz</span> <span class="n">version</span><span class="o">-</span><span class="n">info</span> <span class="o">--</span><span class="nb">format</span> <span class="n">python</span> <span class="o">&gt;</span> <span class="n">library</span><span class="o">/</span><span class="n">_version</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This generates a file which contains 3 dictionaries:</p>
<blockquote>
<div><ul class="simple">
<li><cite>version_info</cite>: A dictionary containing the basic information about the
current state.</li>
<li><cite>revisions</cite>: A dictionary listing all of the revisions in the
history of the tree, along with the commit times and commit
message.  This defaults to being empty unless <code class="docutils literal notranslate"><span class="pre">--all</span></code> or
<code class="docutils literal notranslate"><span class="pre">--include-history</span></code> is supplied. This is useful if you want to
track what bug fixes, etc, might be included in the released
version. But for many projects it is more information than needed.</li>
<li><cite>file_revisions</cite>: A dictionary listing the last-modified revision
for all files in the project. This can be used similarly to how
<code class="docutils literal notranslate"><span class="pre">$Id$</span></code> keywords are used in CVS-controlled files. The last
modified date can be determined by looking in the <code class="docutils literal notranslate"><span class="pre">revisions</span></code>
map. This is also empty by default, and enabled only by <code class="docutils literal notranslate"><span class="pre">--all</span></code>
or <code class="docutils literal notranslate"><span class="pre">--include-file-revisions</span></code>.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="getting-version-info-in-other-formats">
<h4>Getting version info in other formats<a class="headerlink" href="#getting-version-info-in-other-formats" title="Permalink to this headline">¶</a></h4>
<p>Breezy supports a template-based method for getting version information in
arbitrary formats.  The <code class="docutils literal notranslate"><span class="pre">--custom</span></code> option to <code class="docutils literal notranslate"><span class="pre">version-info</span></code> can be
used by providing a <code class="docutils literal notranslate"><span class="pre">--template</span></code> argument that contains variables that
will be expanded based on the status of the working tree.  For example, to
generate a C header file with a formatted string containing the current
revision number:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">version</span><span class="o">-</span><span class="n">info</span> <span class="o">--</span><span class="n">custom</span> \
     <span class="o">--</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;#define VERSION_INFO </span><span class="se">\&quot;</span><span class="s2">Project 1.2.3 (r</span><span class="si">{revno}</span><span class="s2">)</span><span class="se">\&quot;\n</span><span class="s2">&quot;</span> \
     <span class="o">&gt;</span> <span class="n">version_info</span><span class="o">.</span><span class="n">h</span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">{revno}</span></code> will be replaced by the revision number of the
working tree.  (If the example above doesn’t work on your OS, try
entering the command all on one line.) For more information on the
variables that can be used in templates, see <a class="reference external" href="../user-reference/index.html#version-info">Version Info</a> in the
Breezy User Reference.</p>
<p>Predefined formats for dumping version information in specific languages
are currently in development. Please contact us on the mailing list about
your requirements in this area.</p>
</div>
<div class="section" id="check-clean">
<h4>Check clean<a class="headerlink" href="#check-clean" title="Permalink to this headline">¶</a></h4>
<p>Most information about the contents of the project can be cheaply
determined by just reading the revision entry. However, it can be useful
to know if the working tree was completely up-to-date when it was
packaged, or if there was a local modification. By supplying either
<code class="docutils literal notranslate"><span class="pre">--all</span></code> or <code class="docutils literal notranslate"><span class="pre">--check-clean</span></code>, <code class="docutils literal notranslate"><span class="pre">brz</span></code> will inspect the working tree, and
set the <code class="docutils literal notranslate"><span class="pre">clean</span></code> flag in <code class="docutils literal notranslate"><span class="pre">version_info</span></code>, as well as set entries in
<code class="docutils literal notranslate"><span class="pre">file_revisions</span></code> as <code class="docutils literal notranslate"><span class="pre">modified</span></code> where appropriate.</p>
</div>
</div>
</div>
<div class="section" id="a-brief-tour-of-some-popular-plugins">
<h2><a class="toc-backref" href="#id93">A brief tour of some popular plugins</a><a class="headerlink" href="#a-brief-tour-of-some-popular-plugins" title="Permalink to this headline">¶</a></h2>
<div class="section" id="brz-svn">
<h3><a class="toc-backref" href="#id94">brz-svn</a><a class="headerlink" href="#brz-svn" title="Permalink to this headline">¶</a></h3>
<div class="section" id="overview">
<h4>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h4>
<p>brz-svn lets developers use Breezy as their VCS client on projects
still using a central Subversion repository. Access to Subversion
repositories is largely transparent, i.e. you can use most <code class="docutils literal notranslate"><span class="pre">brz</span></code>
commands directly on Subversion repositories exactly the same
as if you were using <code class="docutils literal notranslate"><span class="pre">brz</span></code> on native Breezy branches.</p>
<p>Many brz-svn users create a local mirror of the central Subversion
trunk, work in local feature branches, and submit their
overall change back to Subversion when it is ready
to go. This lets them gain many of the advantages of distributed
VCS tools without interrupting existing team-wide processes and
tool integration hooks currently built on top of Subversion. Indeed,
this is a common interim step for teams looking to adopt Breezy but
who are unable to do so yet for timing or non-technical reasons.</p>
<p>For installation instructions, see the brz-svn home page:
<a class="reference external" href="http://wiki.bazaar.canonical.com/BzrForeignBranches/Subversion">http://wiki.bazaar.canonical.com/BzrForeignBranches/Subversion</a>.</p>
</div>
<div class="section" id="a-simple-example">
<h4>A simple example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h4>
<p>Here’s a simple example of how you can use brz-svn to hack on a
GNOME project like <strong>beagle</strong>. Firstly, setup a local shared repository
for storing your branches in and checkout the trunk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">beagle</span><span class="o">-</span><span class="n">repo</span>
<span class="n">cd</span> <span class="n">beagle</span><span class="o">-</span><span class="n">repo</span>
<span class="n">brz</span> <span class="n">checkout</span> <span class="n">svn</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">svn</span><span class="o">.</span><span class="n">gnome</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">svn</span><span class="o">/</span><span class="n">beagle</span><span class="o">/</span><span class="n">trunk</span> <span class="n">beagle</span><span class="o">-</span><span class="n">trunk</span>
</pre></div>
</div>
<p>Next, create a feature branch and hack away:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">beagle</span><span class="o">-</span><span class="n">trunk</span> <span class="n">beagle</span><span class="o">-</span><span class="n">feature1</span>
<span class="n">cd</span> <span class="n">beagle</span><span class="o">-</span><span class="n">feature1</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;blah blah blah&quot;</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;blah blah blah&quot;</span>
</pre></div>
</div>
<p>When the feature is cooked, refresh your trunk mirror and merge
your change:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">../</span><span class="n">beagle</span><span class="o">-</span><span class="n">trunk</span>
<span class="n">brz</span> <span class="n">update</span>
<span class="n">brz</span> <span class="n">merge</span> <span class="o">../</span><span class="n">beagle</span><span class="o">-</span><span class="n">feature1</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Complete comment for SVN commit&quot;</span>
</pre></div>
</div>
<p>As your trunk mirror is a checkout, committing to it implicitly
commits to the real Subversion trunk. That’s it!</p>
</div>
<div class="section" id="using-a-central-repository-mirror">
<h4>Using a central repository mirror<a class="headerlink" href="#using-a-central-repository-mirror" title="Permalink to this headline">¶</a></h4>
<p>For large projects, it often makes sense to tweak the recipe given above.
In particular, the initial checkout can get quite slow so you may wish
to import the Subversion repository into a Breezy one once and for all
for your project, and then branch from that native Breezy repository
instead. brz-svn provides the <code class="docutils literal notranslate"><span class="pre">svn-import</span></code> command for doing this
repository-to-repository conversion. Here’s an example of how to use it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">svn</span><span class="o">-</span><span class="kn">import</span> <span class="nn">svn</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">svn</span><span class="o">.</span><span class="n">gnome</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">svn</span><span class="o">/</span><span class="n">beagle</span>
</pre></div>
</div>
<p>Here’s the recipe from above updated to use a central Breezy mirror:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">beagle</span><span class="o">-</span><span class="n">repo</span>
<span class="n">cd</span> <span class="n">beagle</span><span class="o">-</span><span class="n">repo</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">bzr</span><span class="o">+</span><span class="n">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">brz</span><span class="o">.</span><span class="n">gnome</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">beagle</span><span class="o">.</span><span class="n">brz</span><span class="o">/</span><span class="n">trunk</span> <span class="n">beagle</span><span class="o">-</span><span class="n">trunk</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">beagle</span><span class="o">-</span><span class="n">trunk</span> <span class="n">beagle</span><span class="o">-</span><span class="n">feature1</span>
<span class="n">cd</span> <span class="n">beagle</span><span class="o">-</span><span class="n">feature1</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;blah blah blah&quot;</span>
<span class="p">(</span><span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">,</span> <span class="n">hack</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;blah blah blah&quot;</span>
<span class="n">cd</span> <span class="o">../</span><span class="n">beagle</span><span class="o">-</span><span class="n">trunk</span>
<span class="n">brz</span> <span class="n">pull</span>
<span class="n">brz</span> <span class="n">merge</span> <span class="o">../</span><span class="n">beagle</span><span class="o">-</span><span class="n">feature1</span>
<span class="n">brz</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Complete comment for SVN commit&quot;</span>
<span class="n">brz</span> <span class="n">push</span>
</pre></div>
</div>
<p>In this case, committing to the trunk only commits the merge locally.
To commit back to the master Subversion trunk, an additional command
(<code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">push</span></code>) is required.</p>
<p>Note: You’ll need to give <code class="docutils literal notranslate"><span class="pre">pull</span></code> and <code class="docutils literal notranslate"><span class="pre">push</span></code> the relevant URLs
the first time you use those commands in the trunk branch. After that,
brz remembers them.</p>
<p>The final piece of the puzzle in this setup is to put scripts in
place to keep the central Breezy mirror synchronized with the Subversion
one. This can be done by adding a cron job, using a Subversion hook,
or whatever makes sense in your environment.</p>
</div>
<div class="section" id="limitations-of-brz-svn">
<h4>Limitations of brz-svn<a class="headerlink" href="#limitations-of-brz-svn" title="Permalink to this headline">¶</a></h4>
<p>Breezy and Subversion are different tools with different capabilities
so there will always be some limited interoperability issues.
Here are some examples current as of brz-svn 0.5.4:</p>
<blockquote>
<div><ul class="simple">
<li>Breezy doesn’t support versioned properties</li>
<li>Breezy doesn’t support tracking of file copies.</li>
</ul>
</div></blockquote>
<p>See the brz-svn web page,
<a class="reference external" href="http://wiki.bazaar.canonical.com/BzrForeignBranches/Subversion">http://wiki.bazaar.canonical.com/BzrForeignBranches/Subversion</a>,
for the current list of constraints.</p>
</div>
</div>
</div>
<div class="section" id="integrating-breezy-into-your-environment">
<h2><a class="toc-backref" href="#id95">Integrating Breezy into your environment</a><a class="headerlink" href="#integrating-breezy-into-your-environment" title="Permalink to this headline">¶</a></h2>
<div class="section" id="web-browsing">
<h3><a class="toc-backref" href="#id96">Web browsing</a><a class="headerlink" href="#web-browsing" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id22">
<h4>Overview<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>There are a range of options available for providing a web view of a
Breezy repository, the main one being Loggerhead. The homepage of Loggerhead
can be found at <a class="reference external" href="https://launchpad.net/loggerhead">https://launchpad.net/loggerhead</a>.</p>
<p>A list of alternative web viewers including download links can be found on
<a class="reference external" href="http://wiki.bazaar.canonical.com/WebInterface">http://wiki.bazaar.canonical.com/WebInterface</a>.</p>
<p>Note: If your project is hosted or mirrored on Launchpad,
Loggerhead code browsing is provided as part of the service.</p>
</div>
</div>
<div class="section" id="bug-trackers">
<h3><a class="toc-backref" href="#id97">Bug trackers</a><a class="headerlink" href="#bug-trackers" title="Permalink to this headline">¶</a></h3>
<p>Breezy has a facility that allows you to associate a commit with a bug
in the project’s bug tracker. Other tools (or hooks) can then use this
information to generate hyperlinks between the commit and the bug, or to
automatically mark the bug closed in the branches that contain the commit.</p>
<div class="section" id="associating-commits-and-bugs">
<h4>Associating commits and bugs<a class="headerlink" href="#associating-commits-and-bugs" title="Permalink to this headline">¶</a></h4>
<p>When you make a commit, you can associate it with a bug by using the
<code class="docutils literal notranslate"><span class="pre">--fixes</span></code> option of <code class="docutils literal notranslate"><span class="pre">commit</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz commit --fixes lp:12345 -m &quot;Properly close the connection&quot;
</pre></div>
</div>
<p>This records metadata in Breezy linking the commit with bug 12345 in
Launchpad. If you use a different bug tracker, it can be given its own
tracker code (instead of <code class="docutils literal notranslate"><span class="pre">lp</span></code>) and used instead. For details on how
to configure this for Bugzilla, Trac, Roundup and other bug/issue trackers,
refer to <a class="reference external" href="../user-reference/index.html#bug-tracker-settings">Bug Tracker Settings</a> in the Breezy User Reference.</p>
</div>
<div class="section" id="metadata-recording-vs-bug-tracker-updating">
<h4>Metadata recording vs bug tracker updating<a class="headerlink" href="#metadata-recording-vs-bug-tracker-updating" title="Permalink to this headline">¶</a></h4>
<p>Recording metadata about bugs fixed at commit time is only
one of the features needed for complete bug tracker integration.
As Breezy is a distributed VCS, users may be offline while committing
so accessing the bug tracker itself at that time may not be possible.
Instead, it is recommended that a hook be installed to update
the bug tracker when changes are pushed to a central location
appropriate for your project’s workflow.</p>
<p>Note: This second processing stage is part of the integration provided
by Launchpad when it scans external or hosted branches.</p>
</div>
<div class="section" id="making-corrections">
<h4>Making corrections<a class="headerlink" href="#making-corrections" title="Permalink to this headline">¶</a></h4>
<p>This method of associating revisions and bugs does have some limitations. The
first is that the association can only be made at commit time. This means that
if you forget to make the association when you commit, or the bug is reported
after you fix it, you generally cannot go back and add the link later.</p>
<p>Related to this is the fact that the association is immutable. If a bug is
marked as fixed by one commit but that revision does not fully solve the
bug, or there is a later regression, you cannot go back and remove the link.</p>
<p>Of course, <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">uncommit</span></code> can always be used to undo the last commit in
order to make it again with the correct options. This is commonly done
to correct a bad commit message and it equally applies to correcting
metadata recorded (via <code class="docutils literal notranslate"><span class="pre">--fixes</span></code> for example) on the last commit.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">uncommit</span></code> is best done before incorrect revisions become public.</p>
</div>
</div>
</div>
<div class="section" id="appendices">
<h2><a class="toc-backref" href="#id98">Appendices</a><a class="headerlink" href="#appendices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id23">
<h3><a class="toc-backref" href="#id99">Specifying revisions</a><a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<div class="section" id="revision-identifiers-and-ranges">
<h4>Revision identifiers and ranges<a class="headerlink" href="#revision-identifiers-and-ranges" title="Permalink to this headline">¶</a></h4>
<p>Breezy has a very expressive way to specify a revision or a range of revisions.
To specify a range of revisions, the upper and lower bounds are separated by the
<code class="docutils literal notranslate"><span class="pre">..</span></code> symbol. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz log -r 1..4
</pre></div>
</div>
<p>You can omit one bound like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz log -r 1..
$ brz log -r ..4
</pre></div>
</div>
<p>Some commands take only one revision, not a range. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz cat -r 42 foo.c
</pre></div>
</div>
<p>In other cases, a range is required but you want the length of the range to
be one. For commands where this is relevant, the <code class="docutils literal notranslate"><span class="pre">-c</span></code> option is used like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz diff -c 42
</pre></div>
</div>
</div>
<div class="section" id="available-revision-identifiers">
<h4>Available revision identifiers<a class="headerlink" href="#available-revision-identifiers" title="Permalink to this headline">¶</a></h4>
<p>The revision, or the bounds of the range, can be given using
different format specifications as shown below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>argument type</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>number</em></td>
<td>revision number</td>
</tr>
<tr class="row-odd"><td><strong>revno</strong>:<em>number</em></td>
<td>revision number</td>
</tr>
<tr class="row-even"><td><strong>last</strong>:<em>number</em></td>
<td>negative revision number</td>
</tr>
<tr class="row-odd"><td><em>guid</em></td>
<td>globally unique revision id</td>
</tr>
<tr class="row-even"><td><strong>revid</strong>:<em>guid</em></td>
<td>globally unique revision id</td>
</tr>
<tr class="row-odd"><td><strong>before</strong>:<em>rev</em></td>
<td>leftmost parent of ‘’rev’‘</td>
</tr>
<tr class="row-even"><td><em>date-value</em></td>
<td>first entry after a given date</td>
</tr>
<tr class="row-odd"><td><strong>date</strong>:<em>date-value</em></td>
<td>first entry after a given date</td>
</tr>
<tr class="row-even"><td><em>tag-name</em></td>
<td>revision matching a given tag</td>
</tr>
<tr class="row-odd"><td><strong>tag</strong>:<em>tag-name</em></td>
<td>revision matching a given tag</td>
</tr>
<tr class="row-even"><td><strong>ancestor</strong>:<em>path</em></td>
<td>last merged revision from a branch</td>
</tr>
<tr class="row-odd"><td><strong>branch</strong>:<em>path</em></td>
<td>latest revision on another branch</td>
</tr>
<tr class="row-even"><td><strong>submit</strong>:<em>path</em></td>
<td>common ancestor with submit branch</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>A brief introduction to some of these formats is given below.
For complete details, see <a class="reference external" href="../user-reference/index.html#revision-identifiers">Revision Identifiers</a> in the
Breezy User Reference.</p>
<div class="section" id="numbers">
<h5>Numbers<a class="headerlink" href="#numbers" title="Permalink to this headline">¶</a></h5>
<p>Positive numbers denote revision numbers in the current branch. Revision
numbers are labelled as “revno” in the output of <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">log</span></code>.  To display
the log for the first ten revisions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz log -r ..10
</pre></div>
</div>
<p>Negative numbers count from the latest revision, -1 is the last committed
revision.</p>
<p>To display the log for the last ten revisions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz log -r -10..
</pre></div>
</div>
</div>
<div class="section" id="revid">
<h5>revid<a class="headerlink" href="#revid" title="Permalink to this headline">¶</a></h5>
<p><strong>revid</strong> allows specifying an internal revision ID, as shown by <code class="docutils literal notranslate"><span class="pre">brz</span>
<span class="pre">log</span> <span class="pre">--show-ids</span></code> and some other commands.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz log -r revid:Matthieu.Moy@imag.fr-20051026185030-93c7cad63ee570df
</pre></div>
</div>
</div>
<div class="section" id="before">
<h5>before<a class="headerlink" href="#before" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt><strong>before</strong></dt>
<dd>‘’rev’’ specifies the leftmost parent of ‘’rev’‘, that is the revision
that appears before ‘’rev’’ in the revision history, or the revision that
was current when ‘’rev’’ was committed.</dd>
</dl>
<p>‘’rev’’ can be any revision specifier and may be chained.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz log -r before:before:4
...
revno: 2
...
</pre></div>
</div>
</div>
<div class="section" id="date">
<h5>date<a class="headerlink" href="#date" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt><strong>date</strong></dt>
<dd>‘’value’’ matches the first history entry after a given date, either at
midnight or at a specified time.</dd>
</dl>
<p>Legal values are:</p>
<blockquote>
<div><ul class="simple">
<li><strong>yesterday</strong></li>
<li><strong>today</strong></li>
<li><strong>tomorrow</strong></li>
<li>A <strong>YYYY-MM-DD</strong> format date.</li>
<li>A <strong>YYYY-MM-DD,HH:MM:SS</strong> format date/time, seconds are optional (note the
comma)</li>
</ul>
</div></blockquote>
<p>The proper way of saying “give me all the log entries for today” is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz log -r date:yesterday..date:today
</pre></div>
</div>
</div>
<div class="section" id="ancestor">
<h5>Ancestor<a class="headerlink" href="#ancestor" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt><strong>ancestor</strong>:<em>path</em></dt>
<dd>specifies the common ancestor between the current branch and a
different branch. This is the same ancestor that would be used for
merging purposes.</dd>
</dl>
<p><em>path</em> may be the URL of a remote branch, or the file path to a local branch.</p>
<p>For example, to see what changes were made on a branch since it was forked
off <code class="docutils literal notranslate"><span class="pre">../parent</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz diff -r ancestor:../parent
</pre></div>
</div>
</div>
<div class="section" id="id24">
<h5>Branch<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt>branch</dt>
<dd><code class="docutils literal notranslate"><span class="pre">path</span></code> specifies the latest revision in another branch.</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">path</span></code> may be the URL of a remote branch, or the file path to a local branch.</p>
<p>For example, to get the differences between this and another branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz diff -r branch:http://example.com/brz/foo.dev
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id25">
<h3><a class="toc-backref" href="#id100">Organizing your workspace</a><a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<div class="section" id="common-workspace-layouts">
<h4>Common workspace layouts<a class="headerlink" href="#common-workspace-layouts" title="Permalink to this headline">¶</a></h4>
<p>The best way for a Breezy user to organize their workspace for a project
depends on numerous factors including:</p>
<ul class="simple">
<li>user role: project owner vs core developer vs casual contributor</li>
<li>workflows: particularly the workflow the project encourages/mandates
for making contributions</li>
<li>size: large projects have different resource requirements to small ones.</li>
</ul>
<p>There are at least 4 common ways of organizing one’s workspace:</p>
<ul class="simple">
<li>lightweight checkout</li>
<li>standalone tree</li>
<li>feature branches</li>
<li>switchable sandbox.</li>
</ul>
<p>A brief description of each layout follows.</p>
</div>
<div class="section" id="lightweight-checkout">
<h4>Lightweight checkout<a class="headerlink" href="#lightweight-checkout" title="Permalink to this headline">¶</a></h4>
<p>In this layout, the working tree is local and the branch is remote.
This is the standard layout used by CVS and Subversion: it’s simple
and well understood.</p>
<p>To set up:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">checkout</span> <span class="o">--</span><span class="n">lightweight</span> <span class="n">URL</span> <span class="n">project</span>
<span class="n">cd</span> <span class="n">project</span>
</pre></div>
</div>
<p>To work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">make</span> <span class="n">changes</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span>
<span class="p">(</span><span class="n">make</span> <span class="n">changes</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span>
</pre></div>
</div>
<p>Note that each commit implicitly publishes the change to everyone else
working from that branch. However, you need to be up to date with changes
in the remote branch for the commit to succeed. To grab the latest code
and merge it with your changes, if any:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">update</span>
</pre></div>
</div>
</div>
<div class="section" id="standalone-tree">
<h4>Standalone tree<a class="headerlink" href="#standalone-tree" title="Permalink to this headline">¶</a></h4>
<p>In this layout, the working tree &amp; branch are in the one place. Unless
a shared repository exists in a higher level directory, the repository
is located in that same place as well. This is the default layout in
Breezy and it’s great for small to moderately sized projects.</p>
<p>To set up:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">URL</span> <span class="n">project</span>
<span class="n">cd</span> <span class="n">project</span>
</pre></div>
</div>
<p>To work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">make</span> <span class="n">changes</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span>
<span class="p">(</span><span class="n">make</span> <span class="n">changes</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span>
</pre></div>
</div>
<p>To publish changes to a central location:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">push</span> <span class="p">[</span><span class="n">URL</span><span class="p">]</span>
</pre></div>
</div>
<p>The URL for push is only required the first time.</p>
<p>If the central location has, in the meantime, received changes from
other users, then you’ll need to merge those changes into your local
branch before you try to push again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">merge</span>
<span class="p">(</span><span class="n">resolve</span> <span class="n">conflicts</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span>
</pre></div>
</div>
<p>As an alternative, a checkout can be used. Like a branch, a checkout
has a full copy of the history stored locally but the local branch
is bound to the remote location so that commits are published to
both locations at once.</p>
<p>Note: A checkout is actually smarter than a local commit followed by
a push. In particular, a checkout wil commit to the remote location
first and only commit locally if the remote commit succeeds.</p>
</div>
<div class="section" id="id26">
<h4>Feature branches<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>In this layout, there are multiple branches/trees, typically sharing
a repository. One branch is kept as a mirror of “trunk” and each
unit-of-work (i.e. bug-fix or enhancement) gets its own “feature branch”.
This layout is ideal for most projects, particularly moderately sized ones.</p>
<p>To set up:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="n">project</span>
<span class="n">cd</span> <span class="n">project</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">URL</span> <span class="n">trunk</span>
</pre></div>
</div>
<p>To start a feature branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">trunk</span> <span class="n">featureX</span>
<span class="n">cd</span> <span class="n">featureX</span>
</pre></div>
</div>
<p>To work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">make</span> <span class="n">changes</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span>
<span class="p">(</span><span class="n">make</span> <span class="n">changes</span><span class="p">)</span>
<span class="n">brz</span> <span class="n">commit</span>
</pre></div>
</div>
<p>To publish changes to a mailing list for review &amp; approval:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">send</span>
</pre></div>
</div>
<p>To publish changes to a public branch (that can then be registered as
a Launchpad merge request, say):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">push</span> <span class="p">[</span><span class="n">URL</span><span class="p">]</span>
</pre></div>
</div>
<p>As a variation, the trunk can be created as a checkout. If you have
commit privileges on trunk, that lets you merge into trunk and the
commit of the merge will implicitly publish your change. Alternatively,
if the trunk URL is read-only (e.g. an HTTP address), that prevents
accidental submission this way - ideal if the project workflow uses
an automated gatekeeper like PQM, say.</p>
</div>
<div class="section" id="local-sandbox">
<h4>Local sandbox<a class="headerlink" href="#local-sandbox" title="Permalink to this headline">¶</a></h4>
<p>This layout is very similar to the feature branches layout except that
the feature branches share a single working tree rather than having one
each. This is similar to git’s default layout and it’s useful for projects
with really large trees (&gt; 10000 files say) or for projects with lots of
build artifacts (like .o or .class files).</p>
<p>To set up:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">init</span><span class="o">-</span><span class="n">repo</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">trees</span> <span class="n">project</span>
<span class="n">cd</span> <span class="n">project</span>
<span class="n">brz</span> <span class="n">branch</span> <span class="n">URL</span> <span class="n">trunk</span>
<span class="n">brz</span> <span class="n">checkout</span> <span class="o">--</span><span class="n">lightweight</span> <span class="n">trunk</span> <span class="n">sandbox</span>
<span class="n">cd</span> <span class="n">sandbox</span>
</pre></div>
</div>
<p>While you <em>could</em> start making changes in sandbox now, committing while
the sandbox is pointing to the trunk would mean that trunk is no longer
a mirror of the upstream URL (well unless the trunk is a checkout).
Therefore, you usually want to immediately create a feature branch and
switch your sandbox to it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="o">../</span><span class="n">trunk</span> <span class="o">../</span><span class="n">featureX</span>
<span class="n">brz</span> <span class="n">switch</span> <span class="o">../</span><span class="n">featureX</span>
</pre></div>
</div>
<p>The processes for making changes and submitting them are otherwise
pretty much the same as those used for feature branches.</p>
</div>
<div class="section" id="advanced-layouts">
<h4>Advanced layouts<a class="headerlink" href="#advanced-layouts" title="Permalink to this headline">¶</a></h4>
<p>If you wish, you can put together your own layout based on how <strong>you</strong> like
things organized. See <a class="reference external" href="shared_repository_layouts.html">Advanced shared repository layouts</a> for examples and inspiration.</p>
</div>
</div>
<div class="section" id="id28">
<h3><a class="toc-backref" href="#id101">Advanced shared repository layouts</a><a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<p>Breezy is designed to give you flexibility in how you layout branches inside a shared repository.
This flexibility allows users to tailor Breezy to their workflow,
but it also leads to questions about what is a “good” layout.
We present some alternatives and give some discussion about the benefits of each.</p>
<p>One key point which should be mentioned is that any good layout should somehow highlight
what branch a “general” user should grab. In SVN this is deemed the “<code class="docutils literal notranslate"><span class="pre">trunk/</span></code>” branch,
and in most of the layouts this naming convention is preserved. Some would call this
“<code class="docutils literal notranslate"><span class="pre">mainline</span></code>” or “<code class="docutils literal notranslate"><span class="pre">dev</span></code>”, and people from CVS often refer to this as “<code class="docutils literal notranslate"><span class="pre">HEAD</span></code>”.</p>
<div class="section" id="svn-style-trunk-branches">
<h4>“SVN-Style” (<code class="docutils literal notranslate"><span class="pre">trunk/</span></code>, <code class="docutils literal notranslate"><span class="pre">branches/</span></code>)<a class="headerlink" href="#svn-style-trunk-branches" title="Permalink to this headline">¶</a></h4>
<p>Most people coming from SVN will be familiar with their “standard” project layout.
Which is to layout the repository as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repository</span><span class="o">/</span>       <span class="c1"># Overall repository</span>
 <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>        <span class="c1"># The mainline of development</span>
 <span class="o">+-</span> <span class="n">branches</span><span class="o">/</span>     <span class="c1"># A container directory</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">foo</span><span class="o">/</span>      <span class="c1"># Branch for developing feature foo</span>
 <span class="o">|</span>     <span class="o">...</span>
 <span class="o">+-</span> <span class="n">tags</span><span class="o">/</span>         <span class="c1"># Container directory</span>
     <span class="o">+-</span> <span class="n">release</span><span class="o">-</span><span class="n">X</span> <span class="c1"># A branch specific to mark a given release version</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>With Breezy, that is a perfectly reasonable layout.
It has the benefit of being familiar to people coming from SVN,
and making it clear where the development focus is.</p>
<p>When you have multiple projects in the same repository,
the SVN layout is a little unclear what to do.</p>
<div class="section" id="project-trunk">
<h5><code class="docutils literal notranslate"><span class="pre">project/trunk</span></code><a class="headerlink" href="#project-trunk" title="Permalink to this headline">¶</a></h5>
<p>The preferred method for SVN seems to be to give each project a top level directory for a layout like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repository</span><span class="o">/</span>            <span class="c1"># Overall repository</span>
 <span class="o">+-</span> <span class="n">project1</span><span class="o">/</span>          <span class="c1"># A container directory</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>         <span class="c1"># The mainline of development of project1</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">branches</span><span class="o">/</span>      <span class="c1"># A container directory</span>
 <span class="o">|</span>       <span class="o">+-</span> <span class="n">foo</span><span class="o">/</span>       <span class="c1"># Branch for developing feature foo of project1</span>
 <span class="o">|</span>         <span class="o">...</span>
 <span class="o">|</span>
 <span class="o">+-</span> <span class="n">project2</span><span class="o">/</span>          <span class="c1"># Container for project2</span>
     <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>         <span class="c1"># Mainline for project2</span>
     <span class="o">+-</span> <span class="n">branches</span><span class="o">/</span>      <span class="c1"># Container for project2 branches</span>
</pre></div>
</div>
<p>This also works with Breezy.
However, with Breezy repositories are cheap to create
(a simple <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">init-repo</span></code> away), and their primary benefit is when the
branches share a common ancestry.</p>
<p>So the preferred way for Breezy would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project1</span><span class="o">/</span>          <span class="c1"># A repository for project1</span>
 <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>         <span class="c1"># The mainline of development of project1</span>
 <span class="o">+-</span> <span class="n">branches</span><span class="o">/</span>      <span class="c1"># A container directory</span>
     <span class="o">+-</span> <span class="n">foo</span><span class="o">/</span>       <span class="c1"># Branch for developing feature foo of project1</span>
       <span class="o">...</span>

<span class="n">project2</span><span class="o">/</span>          <span class="c1"># A repository for project2</span>
 <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>         <span class="c1"># Mainline for project2</span>
 <span class="o">+-</span> <span class="n">branches</span><span class="o">/</span>      <span class="c1"># Container for project2 branches</span>
</pre></div>
</div>
</div>
<div class="section" id="trunk-project">
<h5><code class="docutils literal notranslate"><span class="pre">trunk/project</span></code><a class="headerlink" href="#trunk-project" title="Permalink to this headline">¶</a></h5>
<p>There are also a few projects who use this layout in SVN:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repository</span><span class="o">/</span>             <span class="c1"># Overall repository</span>
  <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>             <span class="c1"># A container directory</span>
  <span class="o">|</span>   <span class="o">+-</span> <span class="n">project1</span>       <span class="c1"># Mainline for project 1</span>
  <span class="o">|</span>   <span class="o">+-</span> <span class="n">project2</span>       <span class="c1"># Mainline for project 2</span>
  <span class="o">|</span>         <span class="o">...</span>
  <span class="o">|</span>
  <span class="o">+-</span> <span class="n">branches</span><span class="o">/</span>          <span class="c1"># Container</span>
      <span class="o">+-</span> <span class="n">project1</span><span class="o">/</span>      <span class="c1"># Container (?)</span>
      <span class="o">|</span>   <span class="o">+-</span> <span class="n">foo</span>        <span class="c1"># Branch &#39;foo&#39; of project1</span>
      <span class="o">+-</span> <span class="n">project2</span><span class="o">/</span>
          <span class="o">+-</span> <span class="n">bar</span>        <span class="c1"># Branch &#39;bar&#39; of project2</span>
</pre></div>
</div>
<p>A slight variant is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repository</span><span class="o">/</span>             <span class="c1"># Overall repository</span>
  <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>             <span class="c1"># A container directory</span>
  <span class="o">|</span>   <span class="o">+-</span> <span class="n">project1</span>       <span class="c1"># Mainline for project 1</span>
  <span class="o">|</span>   <span class="o">+-</span> <span class="n">project2</span>       <span class="c1"># Mainline for project 2</span>
  <span class="o">|</span>         <span class="o">...</span>
  <span class="o">|</span>
  <span class="o">+-</span> <span class="n">branches</span><span class="o">/</span>          <span class="c1"># Container</span>
      <span class="o">+-</span> <span class="n">project1</span><span class="o">-</span><span class="n">foo</span><span class="o">/</span>  <span class="c1"># Branch &#39;foo&#39; of project1</span>
      <span class="o">+-</span> <span class="n">project2</span><span class="o">-</span><span class="n">bar</span><span class="o">/</span>  <span class="c1"># Branch &#39;bar&#39; of project2</span>
</pre></div>
</div>
<p>I believe the reason for this in SVN, is so that someone
can checkout all of “<code class="docutils literal notranslate"><span class="pre">trunk/</span></code>” and get the all the mainlines for all projects.</p>
<p>This layout can be used for Breezy, but it is not generally recommended.</p>
<blockquote>
<div><ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">branch/checkout/get</span></code> is a single branch at a time.
So you don’t get the benefit of getting all mainlines with a single command. <a class="footnote-reference" href="#id30" id="id29">[1]</a></li>
<li>It is less obvious of whether <code class="docutils literal notranslate"><span class="pre">repository/trunk/foo</span></code> is the <code class="docutils literal notranslate"><span class="pre">trunk</span></code> of project
<code class="docutils literal notranslate"><span class="pre">foo</span></code> or it is just the <code class="docutils literal notranslate"><span class="pre">foo</span></code> directory in the <code class="docutils literal notranslate"><span class="pre">trunk</span></code> branch.
Some of this confusion is due to SVN, because it uses the same “namespace”
for files in a project that it uses for branches of a project.
In Breezy, there is a clear distinction of what files make up a project, versus
the location of the Branch. (After all, there is only one <code class="docutils literal notranslate"><span class="pre">.brz/</span></code> directory per branch,
versus many <code class="docutils literal notranslate"><span class="pre">.svn/</span></code> directories in the checkout).</li>
</ol>
</div></blockquote>
<table class="docutils footnote" frame="void" id="id30" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id29">[1]</a></td><td>Note: <a class="reference external" href="http://wiki.bazaar.canonical.com/NestedTrees">NestedTreeSupport</a> can provide a way to create “meta-projects” which
aggregate multiple projects regardless of the repository layout.
Letting you <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">checkout</span></code> one project, and have it grab all the necessary
sub-projects.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="nested-style-project-branch-sub-branch">
<h4>Nested Style (<code class="docutils literal notranslate"><span class="pre">project/branch/sub-branch/</span></code>)<a class="headerlink" href="#nested-style-project-branch-sub-branch" title="Permalink to this headline">¶</a></h4>
<p>Another style with Breezy, which is not generally possible in SVN
is to have branches nested within each-other.
This is possible because Breezy supports (and recommends) creating repositories
with no working trees (<code class="docutils literal notranslate"><span class="pre">--no-trees</span></code>).
With a <code class="docutils literal notranslate"><span class="pre">--no-trees</span></code> repository, because the working files are not intermixed with
your branch locations, you are free to put a branch in whatever namespace you want.</p>
<p>One possibility is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="o">/</span>             <span class="c1"># The overall repository, *and* the project&#39;s mainline branch</span>
 <span class="o">+</span> <span class="n">joe</span><span class="o">/</span>              <span class="c1"># Developer Joe&#39;s primary branch of development</span>
 <span class="o">|</span>  <span class="o">+-</span> <span class="n">feature1</span><span class="o">/</span>     <span class="c1"># Developer Joe&#39;s feature1 development branch</span>
 <span class="o">|</span>  <span class="o">|</span>   <span class="o">+-</span> <span class="n">broken</span><span class="o">/</span>   <span class="c1"># A staging branch for Joe to develop feature1</span>
 <span class="o">|</span>  <span class="o">+-</span> <span class="n">feature2</span><span class="o">/</span>     <span class="c1"># Joe&#39;s feature2 development branch</span>
 <span class="o">|</span>    <span class="o">...</span>
 <span class="o">+</span> <span class="n">barry</span><span class="o">/</span>            <span class="c1"># Barry&#39;s development branch</span>
 <span class="o">|</span>  <span class="o">...</span>
 <span class="o">+</span> <span class="n">releases</span><span class="o">/</span>
    <span class="o">+-</span> <span class="mf">1.0</span><span class="o">/</span>
        <span class="o">+-</span> <span class="mf">1.1</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span>
</pre></div>
</div>
<p>The idea with this layout is that you are creating a hierarchical layout for branches.
Where changes generally flow upwards in the namespace. It also gives people a little
corner of the namespace to work on their stuff.
One nice feature of this layout, is it makes branching “cheaper” because it gives you
a place to put all the mini branches without cluttering up the global <code class="docutils literal notranslate"><span class="pre">branches/</span></code> namespace.</p>
<p>The other power of this is that you don’t have to repeat yourself when specifying more detail in the
branch name.</p>
<p>For example compare:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">repository</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">branches</span><span class="o">/</span><span class="n">joe</span><span class="o">-</span><span class="n">feature</span><span class="o">-</span><span class="n">foo</span><span class="o">-</span><span class="n">bugfix</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span>
</pre></div>
</div>
<p>Versus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">joe</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">bugfix</span><span class="o">-</span><span class="mi">10</span>
</pre></div>
</div>
<p>Also, if you list the <code class="docutils literal notranslate"><span class="pre">repository/project/branches/</span></code> directory you might see something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">barry</span><span class="o">-</span><span class="n">feature</span><span class="o">-</span><span class="n">bar</span><span class="o">/</span>
<span class="n">barry</span><span class="o">-</span><span class="n">bugfix</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span>
<span class="n">barry</span><span class="o">-</span><span class="n">bugfix</span><span class="o">-</span><span class="mi">12</span><span class="o">/</span>
<span class="n">joe</span><span class="o">-</span><span class="n">bugfix</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span>
<span class="n">joe</span><span class="o">-</span><span class="n">bugfix</span><span class="o">-</span><span class="mi">13</span><span class="o">/</span>
<span class="n">joe</span><span class="o">-</span><span class="n">frizban</span><span class="o">/</span>
</pre></div>
</div>
<p>Versus having these broken out by developer.
If the number of branches are small, <code class="docutils literal notranslate"><span class="pre">branches/</span></code> has the nice advantage
of being able to see all branches in a single view.
If the number of branches is large, <code class="docutils literal notranslate"><span class="pre">branches/</span></code> has the distinct disadvantage
of seeing all the branches in a single view (it becomes difficult to find the
branch you are interested in, when there are 100 branches to look through).</p>
<p>Nested branching seems to scale better to larger number of branches.
However, each individual branch is less discoverable.
(eg. “Is Joe working on bugfix 10 in his feature foo branch, or his feature bar branch?”)</p>
<p>One other small advantage is that you can do something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">brz</span> <span class="n">branch</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">release</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="ow">or</span>
 <span class="n">brz</span> <span class="n">branch</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">release</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p>To indicate release 1.1.1 and 1.1.2. This again depends on how many releases you have
and whether the gain of splitting things up outweighs the ability to see more at a glance.</p>
</div>
<div class="section" id="sorted-by-status-dev-merged-experimental">
<h4>Sorted by Status (<code class="docutils literal notranslate"><span class="pre">dev/</span></code>, <code class="docutils literal notranslate"><span class="pre">merged/</span></code>, <code class="docutils literal notranslate"><span class="pre">experimental/</span></code>)<a class="headerlink" href="#sorted-by-status-dev-merged-experimental" title="Permalink to this headline">¶</a></h4>
<p>One other way to break up branches is to sort them by their current status.
So you would end up with a layout something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="o">/</span>               <span class="c1"># Overall layout</span>
 <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>             <span class="c1"># The development focus branch</span>
 <span class="o">+-</span> <span class="n">dev</span><span class="o">/</span>               <span class="c1"># Container directory for in-progress work</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">joe</span><span class="o">-</span><span class="n">feature1</span>   <span class="c1"># Joe&#39;s current feature-1 branch</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">barry</span><span class="o">-</span><span class="n">bugfix10</span> <span class="c1"># Barry&#39;s work for bugfix 10</span>
 <span class="o">|</span>    <span class="o">...</span>
 <span class="o">+-</span> <span class="n">merged</span><span class="o">/</span>            <span class="c1"># Container indicating these branches have been merged</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">bugfix</span><span class="o">-</span><span class="mi">12</span>      <span class="c1"># Bugfix which has already been merged.</span>
 <span class="o">+-</span> <span class="n">abandonded</span><span class="o">/</span>        <span class="c1"># Branches which are considered &#39;dead-end&#39;</span>
</pre></div>
</div>
<p>This has a couple benefits and drawbacks.
It lets you see what branches are actively being developed on, which is usually
only a small number, versus the total number of branches ever created.
Old branches are not lost (versus deleting them), but they are “filed away”,
such that the more likely you are to want a branch the easier it is to find.
(Conversely, older branches are likely to be harder to find).</p>
<p>The biggest disadvantage with this layout, is that branches move around.
Which means that if someone is following the <code class="docutils literal notranslate"><span class="pre">project/dev/new-feature</span></code> branch,
when it gets merged into <code class="docutils literal notranslate"><span class="pre">trunk/</span></code> suddenly <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">pull</span></code> doesn’t mirror the branch
for them anymore because the branch is now at <code class="docutils literal notranslate"><span class="pre">project/merged/new-feature</span></code>.
There are a couple ways around this. One is to use HTTP redirects to point people
requesting the old branch to the new branch. <code class="docutils literal notranslate"><span class="pre">brz</span></code> &gt;= 0.15 will let users know
that <code class="docutils literal notranslate"><span class="pre">http://old/path</span> <span class="pre">redirects</span> <span class="pre">to</span> <span class="pre">http://new/path</span></code>. However, this doesn’t help
if people are accessing a branch through methods other than HTTP (SFTP, local filesystem, etc).</p>
<p>It would also be possible to use a symlink for temporary redirecting (as long as the symlink
is within the repository it should cause little trouble). However eventually you want to
remove the symlink, or you don’t get the clutter reduction benefit.
Another possibility instead of a symlink is to use a <code class="docutils literal notranslate"><span class="pre">BranchReference</span></code>. It is currently
difficult to create these through the <code class="docutils literal notranslate"><span class="pre">brz</span></code> command line, but if people find them useful
that could be changed.
This is actually how <a class="reference external" href="https://launchpad.net">Launchpad</a> allows you to <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">checkout</span> <span class="pre">https://launchpad.net/bzr</span></code>.
Effectively a <code class="docutils literal notranslate"><span class="pre">BranchReference</span></code> is a symlink, but it allows you to reference any other URL.
If it is extended to support relative references, it would even work over HTTP, SFTP,
and local paths.</p>
</div>
<div class="section" id="sorted-by-date-release-etc-2006-06-2006-07-0-8-0-9">
<h4>Sorted by date/release/etc (<code class="docutils literal notranslate"><span class="pre">2006-06/</span></code>, <code class="docutils literal notranslate"><span class="pre">2006-07/</span></code>, <code class="docutils literal notranslate"><span class="pre">0.8/</span></code>, <code class="docutils literal notranslate"><span class="pre">0.9</span></code>)<a class="headerlink" href="#sorted-by-date-release-etc-2006-06-2006-07-0-8-0-9" title="Permalink to this headline">¶</a></h4>
<p>Another method of allowing some scalability while also allowing the
browsing of “current” branches. Basically, this works on the assumption
that actively developed branches will be “new” branches, and older branches
are either merged or abandoned.</p>
<p>Basically the date layout looks something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="o">/</span>                <span class="c1"># Overall project repository</span>
 <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>              <span class="c1"># General mainline</span>
 <span class="o">+-</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">06</span><span class="o">/</span>            <span class="c1"># containing directory for branches created in this month</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">feature1</span><span class="o">/</span>       <span class="c1"># Branch of &quot;project&quot; for &quot;feature1&quot;</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">feature2</span><span class="o">/</span>       <span class="c1"># Branch of &quot;project&quot; for &quot;feature2&quot;</span>
 <span class="o">+-</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">05</span><span class="o">/</span>            <span class="c1"># Containing directory for branches create in a different month</span>
     <span class="o">+-</span> <span class="n">feature3</span><span class="o">/</span>
     <span class="o">...</span>
</pre></div>
</div>
<p>This answers the question “Where should I put my new branch?” very quickly.
If a feature is developed for a long time, it is even reasonable to copy a
branch into the newest date, and continue working on it there.
Finding an active branch generally means going to the newest date, and
going backwards from there. (A small disadvantage is that most directory
listings sort oldest to the top, which may mean more scrolling).
If you don’t copy old branches to newer locations, it also has the disadvantage
that searching for a branch may take a while.</p>
<p>Another variant is by release target:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="o">/</span>          <span class="c1"># Overall repository</span>
 <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>        <span class="c1"># Mainline development branch</span>
 <span class="o">+-</span> <span class="n">releases</span><span class="o">/</span>     <span class="c1"># Container for release branches</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="mf">0.8</span><span class="o">/</span>      <span class="c1"># The branch for release 0.8</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="mf">0.9</span><span class="o">/</span>      <span class="c1"># The branch for release 0.9</span>
 <span class="o">+-</span> <span class="mf">0.8</span><span class="o">/</span>          <span class="c1"># Container for branches targeting release 0.8</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">feature1</span><span class="o">/</span> <span class="c1"># Branch for &quot;feature1&quot; which is intended to be merged into 0.8</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">feature2</span><span class="o">/</span> <span class="c1"># Branch for &quot;feature2&quot; which is targeted for 0.8</span>
 <span class="o">+-</span> <span class="mf">0.9</span><span class="o">/</span>
     <span class="o">+-</span> <span class="n">feature3</span><span class="o">/</span> <span class="c1"># Branch for &quot;feature3&quot;, targeted for release 0.9</span>
</pre></div>
</div>
<p>Some possible variants include having the <code class="docutils literal notranslate"><span class="pre">0.9</span></code> directory imply
that it is branched <em>from</em> 0.9 rather than <em>for</em> 0.9, or having the <code class="docutils literal notranslate"><span class="pre">0.8/release</span></code>
as the official release 0.8 branch.</p>
<p>The general idea is that by targeting a release, you can look at what branches are
waiting to be merged. It doesn’t necessarily give you a good idea of what the
state of the branch (is it in development or finished awaiting review).
It also has a history-hiding effect, and otherwise has the same benefits
and deficits as a date-based sorting.</p>
</div>
<div class="section" id="simple-developer-naming-project-joe-foo-project-barry-bar">
<h4>Simple developer naming (<code class="docutils literal notranslate"><span class="pre">project/joe/foo</span></code>, <code class="docutils literal notranslate"><span class="pre">project/barry/bar</span></code>)<a class="headerlink" href="#simple-developer-naming-project-joe-foo-project-barry-bar" title="Permalink to this headline">¶</a></h4>
<p>Another possibly layout is to give each developer a directory, and then
have a single sub-directory for branches. Something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="o">/</span>      <span class="c1"># Overall repository</span>
 <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>    <span class="c1"># Mainline branch</span>
 <span class="o">+-</span> <span class="n">joe</span><span class="o">/</span>      <span class="c1"># A container for Joe&#39;s branches</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">foo</span><span class="o">/</span>  <span class="c1"># Joe&#39;s &quot;foo&quot; branch of &quot;project&quot;</span>
 <span class="o">+-</span> <span class="n">barry</span><span class="o">/</span>
     <span class="o">+-</span> <span class="n">bar</span><span class="o">/</span>  <span class="c1"># Barry&#39;s &quot;bar&quot; branch of &quot;project&quot;</span>
</pre></div>
</div>
<p>The idea is that no branch is “nested” underneath another one, just that each developer
has his/her branches grouped together.</p>
<p>A variant which is used by <a class="reference external" href="https://launchpad.net">Launchpad</a> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repository</span><span class="o">/</span>
 <span class="o">+-</span> <span class="n">joe</span><span class="o">/</span>             <span class="c1"># Joe&#39;s branches</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">project1</span><span class="o">/</span>    <span class="c1"># Container for Joe&#39;s branches of &quot;project1&quot;</span>
 <span class="o">|</span>   <span class="o">|</span>   <span class="o">+-</span> <span class="n">foo</span><span class="o">/</span>     <span class="c1"># Joe&#39;s &quot;foo&quot; branch of &quot;project1&quot;</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">project2</span><span class="o">/</span>    <span class="c1"># Container for Joe&#39;s &quot;project2&quot; branches</span>
 <span class="o">|</span>       <span class="o">+-</span> <span class="n">bar</span><span class="o">/</span>     <span class="c1"># Joe&#39;s &quot;bar&quot; branch of &quot;project2&quot;</span>
 <span class="o">|</span>        <span class="o">...</span>
 <span class="o">|</span>
 <span class="o">+-</span> <span class="n">barry</span><span class="o">/</span>
 <span class="o">|</span>   <span class="o">+-</span> <span class="n">project1</span><span class="o">/</span>    <span class="c1"># Container for Barry&#39;s branches of &quot;project1&quot;</span>
 <span class="o">|</span>       <span class="o">+-</span> <span class="n">bug</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span>  <span class="c1"># Barry&#39;s &quot;bug-10&quot; branch of &quot;project1&quot;</span>
 <span class="o">|</span>   <span class="o">...</span>
 <span class="o">+-</span> <span class="n">group</span><span class="o">/</span>
     <span class="o">+-</span> <span class="n">project1</span><span class="o">/</span>
         <span class="o">+-</span> <span class="n">trunk</span><span class="o">/</span>   <span class="c1"># The main development focus for &quot;project1&quot;</span>
</pre></div>
</div>
<p>This lets you easily browse what each developer is working on. Focus branches
are kept in a “group” directory, which lets you see what branches the “group”
is working on.</p>
<p>This keeps different people’s work separated from each-other, but also makes it
hard to find “all branches for project X”. <a class="reference external" href="https://launchpad.net">Launchpad</a> compensates for this
by providing a nice web interface with a database back end, which allows a
“view” to be put on top of this layout.
This is closer to the model of people’s home pages, where each person has a
“<code class="docutils literal notranslate"><span class="pre">~/public_html</span></code>” directory where they can publish their own web-pages.
In general, though, when you are creating a shared repository for centralization
of a project, you don’t want to split it up by person and then project.
Usually you would want to split it up by project and then by person.</p>
</div>
<div class="section" id="id31">
<h4>Summary<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h4>
<p>In the end, no single naming scheme will work for everyone. It depends a lot on
the number of developers, how often you create a new branch, what sort of
lifecycles your branches go through. Some questions to ask yourself:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Do you create a few long-lived branches, or do you create lots of “mini” feature branches
(Along with this is: Would you <em>like</em> to create lots of mini feature branches, but can’t
because they are a pain in your current VCS?)</li>
<li>Are you a single developer, or a large team?</li>
<li>If a team, do you plan on generally having everyone working on the same branch at the same
time? Or will you have a “stable” branch that people are expected to track.</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="configuring-email">
<h3><a class="toc-backref" href="#id102">Configuring email</a><a class="headerlink" href="#configuring-email" title="Permalink to this headline">¶</a></h3>
<div class="section" id="why-set-up-an-email-address-with-breezy">
<h4>Why set up an email address with Breezy?<a class="headerlink" href="#why-set-up-an-email-address-with-breezy" title="Permalink to this headline">¶</a></h4>
<p>Breezy stores the specified email address in revisions when they’re
created so that people can tell who committed which revisions.  The
email addresses are not verified, therefore they could be bogus, so
you have to trust the people involved in your project.  Additionally,
the email address in a revision gives others a way to contact the
author of a revision for credit and/or blame.  :)</p>
</div>
<div class="section" id="how-to-set-up-your-email-address">
<h4>How to set up your email address<a class="headerlink" href="#how-to-set-up-your-email-address" title="Permalink to this headline">¶</a></h4>
<p>Breezy will try to guess an email address based on your username and the
hostname if none is set.  This will probably not be what you want, so three
ways exist to tell Breezy what email to use:</p>
<p>You can set your email in one of several configuration files.  Like
other configuration values, you can set it in <code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> as a
general setting.  If you want to override the value for a particular
branch, or set of branches, you can use <code class="docutils literal notranslate"><span class="pre">locations.conf</span></code>.
<code class="docutils literal notranslate"><span class="pre">.brz/branch/branch.conf</span></code> will also work, but will cause all commits
to that branch to use the same email address, even if someone else
does them.</p>
<p>The order of precedence is</p>
<blockquote>
<div><ol class="arabic simple">
<li>If the <code class="docutils literal notranslate"><span class="pre">BZR_EMAIL</span></code> environment variable is set.</li>
<li>If an email is set for your current branch in the <code class="docutils literal notranslate"><span class="pre">locations.conf</span></code>
file.</li>
<li>If an email is set four your current branch in the
<code class="docutils literal notranslate"><span class="pre">.brz/branch/branch.conf</span></code> file.</li>
<li>If an email is set in the <code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> default configuration file.</li>
<li>If the <cite>EMAIL</cite> environment variable is set.</li>
<li>Breezy will try to guess based on your username and the hostname.</li>
</ol>
</div></blockquote>
<p>To check on what Breezy thinks your current email is, use the <code class="docutils literal notranslate"><span class="pre">whoami</span></code>
(“who am i?”) command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">whoami</span>
<span class="n">Joe</span> <span class="n">Cool</span> <span class="o">&lt;</span><span class="n">joe</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-email-via-the-whoami-command">
<h4>Setting email via the ‘whoami’ command<a class="headerlink" href="#setting-email-via-the-whoami-command" title="Permalink to this headline">¶</a></h4>
<p>You can use the whoami command to set your email globally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">whoami</span> <span class="s2">&quot;Joe Cool &lt;joe@example.com&gt;&quot;</span>
</pre></div>
</div>
<p>or only for the current branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">brz</span> <span class="n">whoami</span> <span class="o">--</span><span class="n">branch</span> <span class="s2">&quot;Joe Cool &lt;joe@example.com&gt;&quot;</span>
</pre></div>
</div>
<p>These modify your global <code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> or branch <code class="docutils literal notranslate"><span class="pre">branch.conf</span></code> file, respectively.</p>
</div>
<div class="section" id="setting-email-via-default-configuration-file">
<h4>Setting email via default configuration file<a class="headerlink" href="#setting-email-via-default-configuration-file" title="Permalink to this headline">¶</a></h4>
<p>To use the default ini file, create or edit the <code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> file (in
<code class="docutils literal notranslate"><span class="pre">~/.config/breezy/</span></code> on Unix and in <code class="docutils literal notranslate"><span class="pre">%APPDATA%\breezy\2.0\</span></code> in Windows)
and set an email address as shown below.  Please note that the word DEFAULT
is case sensitive, and must be in upper-case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="n">email</span><span class="o">=</span><span class="n">Your</span> <span class="n">Name</span> <span class="o">&lt;</span><span class="n">name</span><span class="nd">@isp</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For more information on the ini file format, see <a class="reference external" href="../user-reference/index.html#configuration-settings">Configuration Settings</a> in
the Breezy User Reference.</p>
</div>
<div class="section" id="setting-email-on-a-per-branch-basis">
<h4>Setting email on a per-branch basis<a class="headerlink" href="#setting-email-on-a-per-branch-basis" title="Permalink to this headline">¶</a></h4>
<p>The second approach is to set email on a branch by branch basis by
using the <code class="docutils literal notranslate"><span class="pre">locations.conf</span></code> configuration file like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">branch</span><span class="o">/</span><span class="n">location</span><span class="p">]</span>
<span class="n">email</span><span class="o">=</span><span class="n">Your</span> <span class="n">Name</span> <span class="o">&lt;</span><span class="n">name</span><span class="nd">@other</span><span class="o">-</span><span class="n">isp</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This will set your email address in the branch at <code class="docutils literal notranslate"><span class="pre">/some/branch/location</span></code>,
overriding the default specified in the <code class="docutils literal notranslate"><span class="pre">breezy.conf</span></code> above.</p>
</div>
<div class="section" id="setting-email-via-environment-variable">
<h4>Setting email via environment variable<a class="headerlink" href="#setting-email-via-environment-variable" title="Permalink to this headline">¶</a></h4>
<p>The final method Breezy will use is checking for the <code class="docutils literal notranslate"><span class="pre">BZR_EMAIL</span></code>
and <code class="docutils literal notranslate"><span class="pre">EMAIL</span></code> environment variables.  Generally, you would use this
method to override the email in a script context.  If you would like
to set a general default, then please see the ini methods above.</p>
</div>
<div class="section" id="concerns-about-spam">
<h4>Concerns about spam<a class="headerlink" href="#concerns-about-spam" title="Permalink to this headline">¶</a></h4>
<p>Some people want to avoid sharing their email address so as not to get
spam.  Breezy will never disclose your email address, unless you publish
a branch or changeset in a public location.  It’s recommended that you
<em>do</em> use a real address, so that people can contact you about your work,
but it’s not required.  You can use an address which is obfuscated, which
bounces, or which goes through an anti-spam service such as
<cite>spamgourmet.com</cite>.</p>
</div>
</div>
<div class="section" id="serving-breezy-with-apache">
<h3><a class="toc-backref" href="#id103">Serving Breezy with Apache</a><a class="headerlink" href="#serving-breezy-with-apache" title="Permalink to this headline">¶</a></h3>
<p>This document describes one way to set up a Breezy HTTP smart server,
using Apache 2.0 and FastCGI or mod_python or mod_wsgi.</p>
<p>For more information on the smart server, and other ways to configure it
see the main <a class="reference external" href="server.html">smart server documentation</a>.</p>
<div class="section" id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>You have a webserver already publishing <cite>/srv/example.com/www/code</cite> as
<cite>http://example.com/code/…</cite> with plain HTTP.  It contains branches and
directories like <cite>/srv/example.com/www/code/branch-one</cite> and
<cite>/srv/example.com/www/code/my-repo/branch-two</cite>.  You want to provide read-only
smart server access to these directories in addition to the existing HTTP
access.</p>
</div>
<div class="section" id="configuring-apache-2-0">
<h4>Configuring Apache 2.0<a class="headerlink" href="#configuring-apache-2-0" title="Permalink to this headline">¶</a></h4>
<div class="section" id="fastcgi">
<h5>FastCGI<a class="headerlink" href="#fastcgi" title="Permalink to this headline">¶</a></h5>
<p>First, configure mod_fastcgi, e.g. by adding lines like these to your
httpd.conf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LoadModule</span> <span class="n">fastcgi_module</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mod_fastcgi</span><span class="o">.</span><span class="n">so</span>
<span class="n">FastCgiIpcDir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">fastcgi</span>
</pre></div>
</div>
<p>In our example, we’re already serving <cite>/srv/example.com/www/code</cite> at
<cite>http://example.com/code</cite>, so our existing Apache configuration would look
like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Alias</span> <span class="o">/</span><span class="n">code</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">code</span>
<span class="o">&lt;</span><span class="n">Directory</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">code</span><span class="o">&gt;</span>
    <span class="n">Options</span> <span class="n">Indexes</span>
    <span class="c1"># ...</span>
<span class="o">&lt;/</span><span class="n">Directory</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>We need to change it to handle all requests for URLs ending in <cite>.brz/smart</cite>.  It
will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Alias /code /srv/example.com/www/code
&lt;Directory /srv/example.com/www/code&gt;
    Options Indexes FollowSymLinks
    RewriteEngine On
    RewriteBase /code
    RewriteRule ^(.*/)?\.bzr/smart$ /srv/example.com/scripts/brz-smart.fcgi
&lt;/Directory&gt;

# brz-smart.fcgi isn&#39;t under the DocumentRoot, so Alias it into the URL
# namespace so it can be executed.
Alias /srv/example.com/scripts/brz-smart.fcgi /srv/example.com/scripts/brz-smart.fcgi
&lt;Directory /srv/example.com/scripts&gt;
    Options ExecCGI
    &lt;Files brz-smart.fcgi&gt;
        SetHandler fastcgi-script
    &lt;/Files&gt;
&lt;/Directory&gt;
</pre></div>
</div>
<p>This instructs Apache to hand requests for any URL ending with <cite>/.brz/smart</cite>
inside <cite>/code</cite> to a Breezy smart server via FastCGI.</p>
<p>Refer to the <a class="reference external" href="http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html">mod_rewrite</a> and <a class="reference external" href="http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html">mod_fastcgi</a> documentation for further
information.</p>
</div>
<div class="section" id="mod-python">
<h5>mod_python<a class="headerlink" href="#mod-python" title="Permalink to this headline">¶</a></h5>
<p>First, configure mod_python, e.g. by adding lines like these to your
httpd.conf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LoadModule</span> <span class="n">python_module</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mod_python</span><span class="o">.</span><span class="n">so</span>
</pre></div>
</div>
<p>Define the rewrite rules with mod_rewrite the same way as for FastCGI, except
change:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>RewriteRule ^(.*/)?\.bzr/smart$ /srv/example.com/scripts/brz-smart.fcgi
</pre></div>
</div>
<p>to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>RewriteRule ^(.*/)?\.bzr/smart$ /srv/example.com/scripts/brz-smart.py
</pre></div>
</div>
<p>Like with mod_fastcgi, we also define how our script is to be handled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Alias</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">brz</span><span class="o">-</span><span class="n">smart</span><span class="o">.</span><span class="n">py</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">brz</span><span class="o">-</span><span class="n">smart</span><span class="o">.</span><span class="n">py</span>
<span class="o">&lt;</span><span class="n">Directory</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">scripts</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Files</span> <span class="n">brz</span><span class="o">-</span><span class="n">smart</span><span class="o">.</span><span class="n">py</span><span class="o">&gt;</span>
        <span class="n">PythonPath</span> <span class="s2">&quot;sys.path+[&#39;/srv/example.com/scripts&#39;]&quot;</span>
        <span class="n">AddHandler</span> <span class="n">python</span><span class="o">-</span><span class="n">program</span> <span class="o">.</span><span class="n">py</span>
        <span class="n">PythonHandler</span> <span class="n">brz</span><span class="o">-</span><span class="n">smart</span><span class="p">::</span><span class="n">handler</span>
    <span class="o">&lt;/</span><span class="n">Files</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Directory</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This instructs Apache to hand requests for any URL ending with <cite>/.brz/smart</cite>
inside <cite>/code</cite> to a Breezy smart server via mod_python.</p>
<p>NOTE: If you don’t have breezy in your PATH, you will be need to change the
following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PythonPath</span> <span class="s2">&quot;sys.path+[&#39;/srv/example.com/scripts&#39;]&quot;</span>
</pre></div>
</div>
<p>To:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PythonPath</span> <span class="s2">&quot;[&#39;/path/to/brz&#39;]+sys.path+[&#39;/srv/example.com/scripts&#39;]&quot;</span>
</pre></div>
</div>
<p>Refer to the <a class="reference external" href="http://www.modpython.org/">mod_python</a> documentation for further information.</p>
</div>
<div class="section" id="mod-wsgi">
<h5>mod_wsgi<a class="headerlink" href="#mod-wsgi" title="Permalink to this headline">¶</a></h5>
<p>First, configure mod_wsgi, e.g. enabling the mod with a2enmod wsgi.
We need to change it to handle all requests for URLs ending in <cite>.brz/smart</cite>.  It
will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>WSGIScriptAliasMatch ^/code/.*/\.bzr/smart$ /srv/example.com/scripts/brz.wsgi

#The three next lines allow regular GETs to work too
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/code/.*/\.bzr/smart$
RewriteRule ^/code/(.*/\.bzr/.*)$ /srv/example.com/www/code/$1 [L]

&lt;Directory /srv/example.com/www/code&gt;
    WSGIApplicationGroup %{GLOBAL}
&lt;/Directory&gt;
</pre></div>
</div>
<p>This instructs Apache to hand requests for any URL ending with <cite>/.brz/smart</cite>
inside <cite>/code</cite> to a Breezy smart server via WSGI, and any other URL inside
<cite>/code</cite> to be served directly by Apache.</p>
<p>Refer to the <a class="reference external" href="http://code.google.com/p/modwsgi/">mod_wsgi</a> documentation for further information.</p>
</div>
</div>
<div class="section" id="id35">
<h4>Configuring Breezy<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id36">
<h5>FastCGI<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h5>
<p>We’ve configured Apache to run the smart server at
<cite>/srv/example.com/scripts/brz-smart.fcgi</cite>.  This is just a simple script we need
to write to configure a smart server, and glue it to the FastCGI gateway.
Here’s what it looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fcgi</span>
<span class="kn">from</span> <span class="nn">breezy.transport.http</span> <span class="k">import</span> <span class="n">wsgi</span>

<span class="n">smart_server_app</span> <span class="o">=</span> <span class="n">wsgi</span><span class="o">.</span><span class="n">make_app</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s1">&#39;/srv/example.com/www/code&#39;</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/code/&#39;</span><span class="p">,</span>
    <span class="n">path_var</span><span class="o">=</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">,</span>
    <span class="n">readonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">load_plugins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">enable_logging</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fcgi</span><span class="o">.</span><span class="n">WSGIServer</span><span class="p">(</span><span class="n">smart_server_app</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>fcgi</cite> module can be found at <a class="reference external" href="http://svn.saddi.com/py-lib/trunk/fcgi.py">http://svn.saddi.com/py-lib/trunk/fcgi.py</a>.  It
is part of <a class="reference external" href="http://www.saddi.com/software/flup/">flup</a>.</p>
</div>
<div class="section" id="id37">
<h5>mod_python<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h5>
<p>We’ve configured Apache to run the smart server at
<cite>/srv/example.com/scripts/brz-smart.py</cite>.  This is just a simple script we need
to write to configure a smart server, and glue it to the mod_python gateway.
Here’s what it looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">modpywsgi</span>
<span class="kn">from</span> <span class="nn">breezy.transport.http</span> <span class="k">import</span> <span class="n">wsgi</span>

<span class="n">smart_server_app</span> <span class="o">=</span> <span class="n">wsgi</span><span class="o">.</span><span class="n">make_app</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s1">&#39;/srv/example.com/www/code&#39;</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/code/&#39;</span><span class="p">,</span>
    <span class="n">path_var</span><span class="o">=</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">,</span>
    <span class="n">readonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">load_plugins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">enable_logging</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handle a single request.&quot;&quot;&quot;</span>
    <span class="n">wsgi_server</span> <span class="o">=</span> <span class="n">modpywsgi</span><span class="o">.</span><span class="n">WSGIServer</span><span class="p">(</span><span class="n">smart_server_app</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wsgi_server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>modpywsgi</cite> module can be found at
<a class="reference external" href="http://ice.usq.edu.au/svn/ice/trunk/apps/ice-server/modpywsgi.py">http://ice.usq.edu.au/svn/ice/trunk/apps/ice-server/modpywsgi.py</a>. It was
part of <a class="reference external" href="http://dev.pocoo.org/projects/pocoo/">pocoo</a>. You sould make sure you place modpywsgi.py in the same
directory as brz-smart.py (ie. /srv/example.com/scripts/).</p>
</div>
<div class="section" id="id38">
<h5>mod_wsgi<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h5>
<p>We’ve configured Apache to run the smart server at
<cite>/srv/example.com/scripts/brz.wsgi</cite>.  This is just a simple script we need
to write to configure a smart server, and glue it to the WSGI gateway.
Here’s what it looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">breezy.transport.http</span> <span class="k">import</span> <span class="n">wsgi</span>

<span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">wsgi</span><span class="o">.</span><span class="n">make_app</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/example.com/www/code/&quot;</span><span class="p">,</span>
        <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;/code&quot;</span><span class="p">,</span>
        <span class="n">readonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">enable_logging</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="clients">
<h4>Clients<a class="headerlink" href="#clients" title="Permalink to this headline">¶</a></h4>
<p>Now you can use <cite>brz+http://</cite> URLs or just <cite>http://</cite> URLs, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">brz</span><span class="o">+</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">code</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">branch</span>
</pre></div>
</div>
<p>Plain HTTP access should continue to work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">log</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">code</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">branch</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-configuration">
<h4>Advanced configuration<a class="headerlink" href="#advanced-configuration" title="Permalink to this headline">¶</a></h4>
<p>Because the Breezy HTTP smart server is a WSGI application, it can be used with
any 3rd-party WSGI middleware or server that conforms the WSGI standard.  The
only requirements are:</p>
<blockquote>
<div><ul class="simple">
<li>to construct a <cite>SmartWSGIApp</cite>, you need to specify a <strong>root transport</strong> that it
will serve.</li>
<li>each request’s <cite>environ</cite> dict must have a <strong>‘breezy.relpath’</strong> variable set.</li>
</ul>
</div></blockquote>
<p>The <cite>make_app</cite> helper used in the example constructs a <cite>SmartWSGIApp</cite> with a
transport based on the <cite>root</cite> path given to it, and calculates the
‘breezy.relpath` for each request based on the <cite>prefix</cite> and <cite>path_var</cite>
arguments.  In the example above, it will take the ‘REQUEST_URI’ (which is set
by Apache), strip the ‘/code/’ prefix and the ‘/.brz/smart’ suffix, and set that
as the ‘breezy.relpath’, so that a request for ‘/code/foo/bar/.brz/smart’ will
result in a ‘breezy.relpath’ of ‘foo/brz’.</p>
<p>It’s possible to configure a smart server for a non-local transport, or that
does arbitrary path translations, etc, by constructing a <cite>SmartWSGIApp</cite>
directly.  Refer to the docstrings of <cite>breezy.transport.http.wsgi</cite> and the <a class="reference external" href="http://www.python.org/dev/peps/pep-0333/">WSGI
standard</a> for further information.</p>
<div class="section" id="id39">
<h5>Pushing over the HTTP smart server<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h5>
<p>It is possible to allow pushing data over the HTTP smart server. The
easiest way to do this, is to just supply <code class="docutils literal notranslate"><span class="pre">readonly=False</span></code> to the
<code class="docutils literal notranslate"><span class="pre">wsgi.make_app()</span></code> call. But be careful, because the smart protocol does
not contain any Authentication. So if you enable write support, you will
want to restrict access to <code class="docutils literal notranslate"><span class="pre">.brz/smart</span></code> URLs to restrict who can
actually write data on your system, e.g. in apache it looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Location</span> <span class="o">/</span><span class="n">code</span><span class="o">&gt;</span>
    <span class="n">AuthType</span> <span class="n">Basic</span>
    <span class="n">AuthName</span> <span class="s2">&quot;example&quot;</span>
    <span class="n">AuthUserFile</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">passwd</span>
    <span class="o">&lt;</span><span class="n">LimitExcept</span> <span class="n">GET</span><span class="o">&gt;</span>
        <span class="n">Require</span> <span class="n">valid</span><span class="o">-</span><span class="n">user</span>
    <span class="o">&lt;/</span><span class="n">LimitExcept</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Location</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>At this time, it is not possible to allow some people to have read-only
access and others to have read-write access to the same URLs. Because at
the HTTP layer (which is doing the Authenticating), everything is just a
POST request.  However, it would certainly be possible to have HTTPS
require authentication and use a writable server, and plain HTTP allow
read-only access.</p>
<p>If brz gives an error like this when accessing your HTTPS site:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span><span class="p">:</span> <span class="n">ERROR</span><span class="p">:</span> <span class="n">Connection</span> <span class="n">error</span><span class="p">:</span> <span class="n">curl</span> <span class="n">connection</span> <span class="n">error</span> <span class="p">(</span><span class="n">server</span> <span class="n">certificate</span> <span class="n">verification</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">CAfile</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span><span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="o">.</span><span class="n">crt</span> <span class="n">CRLfile</span><span class="p">:</span> <span class="n">none</span><span class="p">)</span>
</pre></div>
</div>
<p>You can workaround it by using <code class="docutils literal notranslate"><span class="pre">https+urllib</span></code> rather than <code class="docutils literal notranslate"><span class="pre">http</span></code> in your
URL, or by uninstalling pycurl.  See <a class="reference external" href="https://bugs.launchpad.net/bzr/+bug/82086">bug 82086</a> for more details.</p>
</div>
</div>
</div>
<div class="section" id="id40">
<h3><a class="toc-backref" href="#id104">Writing a plugin</a><a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id41">
<h4>Introduction<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h4>
<p>Plugins are very similar to brz core functionality.  They can import
anything in breezy.  A plugin may simply override standard functionality,
but most plugins supply new commands.</p>
</div>
<div class="section" id="creating-a-new-command">
<h4>Creating a new command<a class="headerlink" href="#creating-a-new-command" title="Permalink to this headline">¶</a></h4>
<p>To create a command, make a new object that derives from
<code class="docutils literal notranslate"><span class="pre">breezy.commands.Command</span></code>, and name it <code class="docutils literal notranslate"><span class="pre">cmd_foo</span></code>, where foo is the name of
your command.  If you create a command whose name contains an underscore,
it will appear in the UI with the underscore turned into a hyphen.  For
example, <cite>cmd_baz_import</cite> will appear as <cite>baz-import</cite>.  For examples of how
to write commands, please see <code class="docutils literal notranslate"><span class="pre">builtins.py</span></code>.</p>
<p>Once you’ve created a command you must register the command with
<code class="docutils literal notranslate"><span class="pre">breezy.commands.register_command(cmd_foo)</span></code>.  You must register the
command when your file is imported, otherwise brz will not see it.</p>
</div>
<div class="section" id="installing-a-hook">
<h4>Installing a hook<a class="headerlink" href="#installing-a-hook" title="Permalink to this headline">¶</a></h4>
<p>See <a class="reference external" href="hooks.txt">Using hooks</a>.</p>
<blockquote>
<div></div></blockquote>
</div>
<div class="section" id="specifying-a-plugin-version-number">
<h4>Specifying a plugin version number<a class="headerlink" href="#specifying-a-plugin-version-number" title="Permalink to this headline">¶</a></h4>
<p>Simply define <code class="docutils literal notranslate"><span class="pre">version_info</span></code> to be a tuple defining the current version
number of your plugin. eg.
<code class="docutils literal notranslate"><span class="pre">version_info</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">9,</span> <span class="pre">0)</span></code>
<code class="docutils literal notranslate"><span class="pre">version_info</span> <span class="pre">=</span> <span class="pre">(0,</span> <span class="pre">9,</span> <span class="pre">0,</span> <span class="pre">'dev',</span> <span class="pre">0)</span></code></p>
</div>
<div class="section" id="plugin-searching-rules">
<h4>Plugin searching rules<a class="headerlink" href="#plugin-searching-rules" title="Permalink to this headline">¶</a></h4>
<p>Breezy will scan <code class="docutils literal notranslate"><span class="pre">~/.config/breezy/plugins</span></code>  and <code class="docutils literal notranslate"><span class="pre">breezy/plugins</span></code> for
plugins by default.  You can override this with  <code class="docutils literal notranslate"><span class="pre">BRZ_PLUGIN_PATH</span></code>
(see <a class="reference external" href="../user-reference/configuration-help.html#brz-plugin-path">User Reference</a> for details).</p>
<p>Plugins may be either modules or packages.  If your plugin is a single
file, you can structure it as a module.  If it has multiple files, or if
you want to distribute it as a brz branch, you should structure it as a
package, i.e. a directory with an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.</p>
</div>
<div class="section" id="more-information">
<h4>More information<a class="headerlink" href="#more-information" title="Permalink to this headline">¶</a></h4>
<p>Please feel free to contribute your plugin to Breezy, if you think it
would be useful to other people.</p>
<p>See the <a class="reference external" href="../developer-guide/HACKING.html">Breezy Developer Guide</a> for details on Breezy’s development
guidelines and policies.</p>
</div>
</div>
<div class="section" id="git-limitations">
<h3><a class="toc-backref" href="#id105">Git Limitations</a><a class="headerlink" href="#git-limitations" title="Permalink to this headline">¶</a></h3>
<p>Breezy’s support for Git repositories currently has the following limitations:</p>
<ul class="simple">
<li>No support for creating annotated tags. pad.lv/1758185</li>
<li>No support for gitattributes and the features that depend on it (lfs, eol, etc). pad.lv/1802797</li>
<li>Limited support for submodules. pad.lv/402814</li>
<li>No rename/copy inference. pad.lv/1760740</li>
<li>No support for creating shallow branches (pad.lv/1760151)</li>
<li>No good way to refer to git remotes from the command-line (pad.lv/1702283)</li>
<li>No mailmap support (pad.lv/544031)</li>
</ul>
<p>Functionality similar to git that’s missing:</p>
<ul class="simple">
<li>No rebase command. pad.lv/1708046</li>
<li>No –amend option for commit. pad.lv/507529</li>
<li>No clone/fetch commands. pad.lv/831939</li>
</ul>
</div>
<div class="section" id="licence">
<h3><a class="toc-backref" href="#id106">Licence</a><a class="headerlink" href="#licence" title="Permalink to this headline">¶</a></h3>
<p>Copyright 2009-2011 Canonical Ltd.
Copyright 2018 Breezy Developers</p>
<p>Breezy is free software, and you
may use, modify and redistribute both Breezy and this document under
the terms of the GNU General Public License version 2 or later.  See
&lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../whats-new/whats-new-in-3.0.html">What’s New in Breezy 3.0?</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Breezy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference/index.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes/index.html">Breezy Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade-guide/index.html">Breezy Upgrade Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-reference/index.html">Breezy User Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">Breezy System Administrator’s Guide</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/user-guide/index-plain.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011 Canonical Ltd, 2017-2018 Breezy Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>